\subsection{The fundamental domain and the tessellation of the halfplane}

We have seen in Remark~\ref{rem_NatureMoebius} that considering Möbius transformations as meromorphic functions $\EC \to \EC$ very naturally induces a group action of $\PGL{\C}$ on $\EC$. Clearly this group action is also given for any subgroup of $\PGL{\C}$ and in particular for the modular group. 

For the following it will be convenient to write modular transformations in matrix form and the elements $z \in \EC$ as quotients $z = u/v$ for suitable $u,v \in \C$, not both zero. A formal quotient $u/0$ will be identified with $\infty$. In this notation, for a modular transformation $A = \smallmat{a}{b}{c}{d} \in \PSL{\Z}$ and $u/v \in \EC$ the mentioned group action is given by
\begin{equation}
\label{eqn_ModGrpAction}
A \ \frac{u}{v} := \frac{a u + b v}{c u + d v}
\end{equation}
We call two points $z, w \in \EC$ \emph{equivalent}, if and only if there is a modular transformation $A \in \PSL{\Z}$ with $A z = w$ and we write  $z \sim w$. The equivalence class (\emph{orbit}) of a point $u/v \in \EC$ is given by 
\begin{equation*}
\left[\frac{u}{v}\right]_\sim = 
\setdefsz{\bigg}{\frac{a u + b v}{c u + d v} \in \EC}{\mat{a}{b}{c}{d} \in \PSL{\Z}} \in \EC / \sim.
\end{equation*}

We now wish to find a system of representatives for $\EC/\sim$, in other words, we want to define exactly one representative $u_0/v_0$ for each orbit $[u/v]_\sim$. One approach for this could be to fix $u,v \in \C$, not both zero, then to choose from the set
\begin{equation}
\label{eqn_FunDomOuv}
O_{u,v} := \SL{\Z} \cvec{u}{v} = \setdefsz{\bigg}{\cvec{a u + b v}{c u + d v} \in \C^2}{\mat{a}{b}{c}{d} \in \SL{\Z}}
\end{equation}
one vector $(u_0, v_0)$ with minimal $\eucnorm{\cdot}$-norm and to declare $u_0/v_0$ as the representative for $[u/v]_\sim$. The problem with this is that such a choice may not always be possible, because $O_{u,v}$ may in general contain vectors of arbitrary small $\eucnorm{\cdot}$-norm. 

However, if $u \conj{v} \notin \R$, then $u$ and $v$ span a non-degenerate parallelogram $P_{u,v} := \setdef{t u + s v}{t,s \in [0,1)} \subseteq \C$. Translation of $P_{u,v}$ by integer multiples of $u$ and $v$ covers every point in $\C$ exactly once. The set
\begin{equation*}
L_{u,v} := \setdef{a u + b v \in \C}{a,b \in \Z}
\end{equation*}
consists precisely of the vertices of all of these translated parallelograms.\footnote{$L_{u,v}$ forms a lattice in $\C$.} If we denote by $D_r := \setdef{z \in \C}{\abs{z} \le r}$ a disk of radius $r$ centered at the origin, then for every $r > 0$ the set $D_r \cap L_{u,v}$ is obviously finite. 

Now, still for the case $u \conj{v} \notin \R$, we show that the set $O_{u,v} \subseteq (L_{u,v})^2$ must contain an element of minimal $\eucnorm{.}$-norm: Define $K_r := \setdef{x \in \C^2}{\eucnorm{x} \le r}$ and let $r > 0$ be sufficiently large such that $K_r \cap O_{u,v}$ is nonempty. Because 
\begin{equation}
\label{eqn_FunDomOuvFinite}
K_r \cap O_{u,v} \subseteq (D_r \cap L_{u,v})^2,
\end{equation}
we see that $K_r \cap O_{u,v}$ is finite and $\min \eucnorm{K_r \cap O_{u,v}} = \min \eucnorm{O_{u,v}}$ exists. Since $(0,0) \notin O_{u,v}$, this minimum is not zero.

This encourages us to go on (we will come back to the case $u \conj{v} \in \R$ later) and turn to the question, how we can effectively determine an element of $O_{u,v}$ with minimal $\eucnorm{\cdot}$-norm. The task is the following: Given two complex numbers $u,v \in \C$ with $u \conj{v} \notin \R$, find a matrix $B \in \SL{\Z}$ such that $\eucnorm{B ({}^u_v)}$ is minimal. 

In Theorem~\ref{thm_ModGrpTUGen} we have seen that $\PSL{\Z}$ is generated by ${}_\pm T$ and ${}_\pm U$.\footnote{Here, for clarity, we again use the notation ${}_\pm M := M_\sim = \{\pm M\} \in \PSL{\Z}$ to distinguish from the matrix $M \in \SL{\Z}$.} As a consequence,  $\SL{\Z}$ is generated by the matrices $T = \smallmat{0}{-1}{1}{\phantom{-}0}$, $U = \smallmat{1}{1}{0}{1}$ and $N = -\smallmat{1}{0}{0}{1}$. The idea is now to successively multiply $({}^u_v)$ with appropriate powers of $T$ and $U$ to obtain vectors of smaller and smaller $\eucnorm{\cdot}$-norm (multiplying with $N$ would not help us in this regard). We do this by first finding an integer $q_0 \in \Z$, such that $\eucnorm{U^{-q_0} ({}^u_v)}$ is minimal. Then we multiply with $T$ and repeat the process for finding $q_1 \in \Z$ minimizing $\eucnorm{U^{q_1} T U^{q_0} ({}^u_v)}$ and so on. The process ends when $q_n = 0$ for some $n>0$. Note that the integers $q_j$ can be determined easily:
\begin{lemma}
\label{lem_FunDomUVMin}
Let $u,v \in \C$ with $v \ne 0$. The statements
\begin{enumerate}[\qquad(i)]
\item \label{itm_uvMini}
$q \in \Z$ minimizes $\eucnorm{U^{-q}\cvec{u}{v}} = \eucnorm{\cvec{u - q v}{v}}$,
\item \label{itm_uvMinii} $q \in \Z$ minimizes $\abs{u - q v}$,
\item \label{itm_uvMiniii} $q \in \Z$ minimizes $\abs{\frac{u}{v} - q}$,
\item \label{itm_uvMiniv} $q = \nint{\Re{\frac{u}{v}}}$,
\end{enumerate}
satisfy the relations $(\ref{itm_uvMini}) \Leftrightarrow (\ref{itm_uvMinii}) \Leftrightarrow (\ref{itm_uvMiniii})$ and $(\ref{itm_uvMiniv}) \Rightarrow (\ref{itm_uvMiniii})$.
\end{lemma}

In the following theorem we summarize the described algorithm and prove its correctness:

\begin{theorem}
\label{thm_FunDomUVAlg}
Let $u,v \in \C$ with $u \conj{v} \notin \R$. A matrix $B \in \SL{\Z}$ minimizing $\eucnorm{B ({}^u_v)}$ can be found by performing the following steps:
\begin{enumerate}
\item Set $(r_{-1},r_0) := (u,v)$ and $j := 0$.
\item \label{itm_FunDomUVAlgLoop}
Determine $q_j := \nint{\Re{\frac{r_{j-1}}{r_j}}}$.
\item If $j > 0$ and $q_j = 0$ go to step \ref{itm_FunDomUVAlgDone}. Otherwise, set $r_{j+1} := r_{j-1} - q_j r_j$, increment $j$ by one and continue with step \ref{itm_FunDomUVAlgLoop}.
\item \label{itm_FunDomUVAlgDone} Set $n := j-1$. For $i \in \{0,1,\dots,n\}$, set $e_i := (-1)^i q_i$. The desired matrix is
\begin{equation}
\label{eqn_FunDomUVMinMat}
B = U^{-e_n} TU^{-e_{n-1}} \cdots TU^{-e_0}.
\end{equation}
\end{enumerate}
\end{theorem}
\begin{proof}
The algorithm gives rise to a sequence of equations
\begin{IEEEeqnarray*}{rCcCl}
u &=& r_{-1} &=& q_0 \cdot r_0 + r_1 \\
v &=&    r_0 &=& q_1 \cdot r_1 + r_2 \\
&&       r_1 &=& q_2 \cdot r_2 + r_3 \\
&&       r_2 &=& q_3 \cdot r_3 + r_4 \\
&& &\vdots& 
\end{IEEEeqnarray*}
with $r_j \ne 0$ for all $j \ge -1$, because they are all nontrivial linear combinations of $u$ and $v$ with integer coefficients and $u\conj{v} \notin \R$ implies linear independence of $u$, $v$ over $\R$.  Moreover this sequence of equations corresponds to the sequence of vectors
\begin{equation*}
\cvec{u}{v}                           \overset{TU^{-q_0}}{\longmapsto}
\cvec{\phantom{+}v\phantom{_1}}{-r_1} \overset{TU^{q_1}}{\longmapsto}
\cvec{-r_1}{-r_2}                     \overset{TU^{-q_2}}{\longmapsto}
\cvec{-r_2}{\phantom{+}r_3}           \overset{TU^{q_3}}{\longmapsto}
\cvec{r_3}{r_4}                       \mapsto \dots
\end{equation*}
With $s_j := (-1)^{\ceil{\half{j}}} r_j$, we can write these vectors as $x_j := \cvec{s_{j-1}}{s_j}$ for $j \ge 0$. Now, as in the theorem, let $e_j := (-1)^j q_j$ for $j \ge 0$. In this notation, we can write in general $TU^{-e_j} x_j = x_{j+1}$ for all $j \ge 0$. From the choice of $q_j$ -- see Lemma~\ref{lem_FunDomUVMin} -- it follows that for each pair of subsequent vectors $x_j$, $x_{j+1}$ we have $\eucnorm{x_j} \ge \eucnorm{x_{j+1}}$. Using $r_{j+1} = r_{j-1} - q_j r_j$ we see that $\eucnorm{x_j} = \eucnorm{x_{j+1}}$ is equivalent to
\begin{equation*}
\eucnorm{\cvec{\pm r_{j-1}}{\pm r_{j\phantom{-1}}}} = 
\eucnorm{\cvec{\pm r_{j\phantom{+1}}}{\pm r_{j+1}}} =
\eucnorm{\cvec{\pm r_j}{\pm (r_{j-1} - q_j r_j)}}.
\end{equation*}
Obviously this is the case if and only if $\abs{r_{j-1}} = \abs{r_{j-1}-q_j r_j}$. If we divide by $r_j$ and define $z_j := \frac{r_{j-1}}{r_j}$, we obtain
\begin{eqnarray*}
\abs{z_j} = \abs{z_j - q_j} 
&\Leftrightarrow& z_j \conj{z_j} = (z_j - q_j)(\conj{z_j} -q_j)\\
&\Leftrightarrow& q_j \left(q_j - 2\Re{z_j}\right) = 0.
\end{eqnarray*}
One obvious solution to this is $q_j = 0$. For the other factor, we substitute $\alpha := \Re{z_j}$ and use $q_j = \nint{\alpha}$ to see that the equation $\nint{\alpha} = 2 \alpha$ has the unique solution $\alpha = 0$ which again leads to $q_j = 0$.\footnote{Here we greatly benefit from our definition of $\operatorname{nint}$, in particular from $\nint{\pm \reci{2}} = 0$.} Summing up, we therefore have for all $j \ge 0$
\begin{equation}
\label{eqn_FunDomUVAlgNormDec}
\eucnorm{x_j} \ge \eucnorm{x_{j+1}} 
\quad \text{and} \quad
\eucnorm{x_j} = \eucnorm{x_{j+1}} \Leftrightarrow q_j = 0.
\end{equation}

To see that the algorithm terminates, let $O_{u,v}$ and $K_r$ be defined as in (\ref{eqn_FunDomOuv}) and (\ref{eqn_FunDomOuvFinite}). Since all the vectors $x_j$ are contained in the finite set $O_{u,v} \cap K_{\eucnorm{({}^u_v)}}$, we cannot have $\eucnorm{x_j} > \eucnorm{x_{j+1}}$ for infinitely many indices $j$. In other words, $q_n$ must be zero for some $n \in \N$ and we have
\begin{equation*}
TU^{-e_n} \cdots TU^{-e_1} TU^{-e_0} x_0 = x_n.
\end{equation*}
The vector $x_n$ has minimal $\eucnorm{\cdot}$-norm in $O_{u,v}$. Obviously also the vector $\inv{T}x_n$ has this property and we may therefore define $B$ as in ($\ref{eqn_FunDomUVMinMat}$).

\todo{32}{Argument for minimality of $x_n$ missing.}
\end{proof}

\begin{figure}
\centering
\includegraphics[width=\textwidth]{figures/modular-tiling-1}
\caption{The tessellation of the upper halfplane.}
\label{fig_ModularTiling}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=0.8\textwidth]{figures/modular-tiling-exp-fan}
\caption{The tessellation under the transformation $z \mapsto \exp(2 \pi \ii z)$.}
\label{fig_ModularTilingExpFan}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=0.8\textwidth]{figures/modular-tiling-exp-zoom}
\caption{The image of the modular tiling under the map $z \mapsto \exp(2 \pi \ii z)$ in the neighborhood of $\infty$.}
\label{fig_ModularTilingExpZoom}
\end{figure}
