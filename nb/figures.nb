(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    146795,       3619]
NotebookOptionsPosition[    144776,       3551]
NotebookOutlinePosition[    145141,       3567]
CellTagsIndexPosition[    145098,       3564]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"On", "[", "Assert", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.585798030128827*^9, 3.5857980373340206`*^9}, {
  3.5918805991056356`*^9, 3.591880604893237*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"display", "[", 
    RowBox[{"figure_", ",", "size_", ",", "filename_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", 
       RowBox[{"path", "=", "\"\<diplomathesis/trunk/tex/figures/\>\""}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "=", 
       RowBox[{"Show", "[", 
        RowBox[{"figure", ",", 
         RowBox[{"ImageSize", "\[Rule]", "size"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"f", ",", "\[IndentingNewLine]", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Export\>\"", ",", 
           RowBox[{
            RowBox[{"Export", "[", 
             RowBox[{
              RowBox[{"path", " ", "<>", "filename"}], ",", "figure", ",", 
              RowBox[{"ImageSize", "\[Rule]", "size"}]}], "]"}], ";", 
            RowBox[{"MessageDialog", "[", 
             RowBox[{"\"\<Written \>\"", " ", "<>", " ", "filename"}], 
             "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.585799946368181*^9, 3.585800008306841*^9}, {
  3.5858001543047533`*^9, 3.5858001557217913`*^9}, {3.5858018072280507`*^9, 
  3.585801812648196*^9}, {3.585802007998431*^9, 3.585802026043915*^9}, {
  3.5858046191544085`*^9, 3.5858046570374236`*^9}, {3.5858047395916357`*^9, 
  3.5858047780636673`*^9}, {3.5888657138217106`*^9, 3.588865737261332*^9}, {
  3.5888660439644594`*^9, 3.5888660726452193`*^9}, {3.5930195747098837`*^9, 
  3.5930195779799747`*^9}}],

Cell[CellGroupData[{

Cell["\<\

Circle inversion\
\>", "Subtitle",
 CellChangeTimes->{{3.595510388254083*^9, 3.595510391349166*^9}}],

Cell[BoxData[
 RowBox[{"display", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"t", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", "1"}], "]"}]}], ",", 
       RowBox[{"phi", "=", "0.3"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c", "=", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"p", "=", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0"}], "}"}]}], ",", 
         RowBox[{"q", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "t"}], ",", "0"}], "}"}]}], ",", "n1", ",", 
         "n2", ",", "m"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n1", "=", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"t", " "}], "2"]}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n2", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "}"}], ".", "n1"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"RotationMatrix", "[", "phi", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c", ",", "p", ",", "q", ",", "n1", ",", "n2"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", "p", ",", "q", ",", "n1", ",", "n2"}], "}"}], 
          ".", 
          RowBox[{"Transpose", "@", "m"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "@", "Green"}], ",", 
              RowBox[{"Circle", "[", 
               RowBox[{"c", ",", "1"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Darker", "@", "Green"}], ",", 
              RowBox[{"Arrow", "@", 
               RowBox[{"{", 
                RowBox[{"c", ",", 
                 RowBox[{"c", "+", 
                  RowBox[{"m", ".", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.6"}], ",", "0.8"}], "}"}]}]}]}], "}"}]}], 
              ",", 
              RowBox[{"Text", "[", 
               RowBox[{"\"\<r\>\"", ",", 
                RowBox[{"c", "+", 
                 RowBox[{
                  RowBox[{"m", ".", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.6"}], ",", "0.8"}], "}"}]}], "/", "2"}]}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Red", ",", 
              RowBox[{"Line", "@", 
               RowBox[{"{", 
                RowBox[{"c", ",", 
                 RowBox[{"Scaled", "[", 
                  RowBox[{
                   RowBox[{"m", ".", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], ",", "q"}], "]"}]}], 
                "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Dashed", ",", 
              RowBox[{"Line", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Scaled", "[", 
                  RowBox[{
                   RowBox[{"m", ".", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], ",", "p"}], "]"}], ",", 
                 RowBox[{"Scaled", "[", 
                  RowBox[{
                   RowBox[{"m", ".", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], ",", "p"}], "]"}]}], 
                "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Dashed", ",", 
              RowBox[{"Circle", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"c", "+", "q"}], ")"}], "/", "2"}], ",", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"q", "-", "c"}], "]"}], "/", "2"}]}], "]"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "@", "Medium"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"pt", ",", "label"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Point", "[", "pt", "]"}], ",", 
                   RowBox[{"Text", "[", 
                    RowBox[{"label", ",", "pt", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1.5"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
               "@@@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"c", ",", "\"\<C\>\""}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"p", ",", "\"\<P\>\""}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"q", ",", "\"\<Q\>\""}], "}"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Point", "/@", 
               RowBox[{"{", 
                RowBox[{"n1", ",", "n2"}], "}"}]}]}], "\[IndentingNewLine]", 
             "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "3"}], "}"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2"}], ",", "2"}], "}"}], "+", "0.25"}]}], 
            "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
   "200", ",", "\"\<circ-inv.eps\>\""}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzVsogwEABeBZS6woycO0bJPYi0u5bEkxS1hrmpk1NUo2srLmFsNkaUQt
uSwx/pIXl9CKEKXwYB48LWstWxmyjIzYMrHzP5y+OnU6nFZdvZpKoVCYsUDH
X0Gd/yogcOztkuZ9TTfCslqzEkY/45vhyYbQA0uT5e/QX70Tgmxu4BtKcifD
8Hyi7RcWJaXGPcRcv9unw6xORRoMZDIYMHywlE72mqMMOKg2seDW9SEX3uzY
8qH7NsqHBtWlEG6qvCJyX/4hh0rCKX2KKZo5a4LMt2A77HL2d8Axu8UI+6iv
Frg2+jgPK2Q1C5C27VqBxcIIAb1WXfYz/tzdpJUSNQ/StDY+FAeHBfC4yk5K
RH0S+DKXIoWu2R4FPDUtk4pb0lSQfb+thos/ei0Ma0KkZkKmhwkRQy8s9DUM
wfHeHCO0XgysljgDAlYinYBTbI6BF7Pbwx+B/8UYDf0=
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Modified Cayley Transform, Stereographic Projection\
\>", "Subtitle",
 CellChangeTimes->{{3.5898633737382154`*^9, 3.589863403581113*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "phi", ",", "disk", ",", "cone", ",", "rays", ",", "halfSphere", ",", 
     "regionPlot", ",", "plots", ",", "figure", ",", "plots2", ",", 
     "figure2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"halfSphere", "=", 
     RowBox[{
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "phi", "]"}], 
           RowBox[{"Cos", "[", "theta", "]"}]}], ",", 
          RowBox[{"Sin", "[", "theta", "]"}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", "phi", "]"}]}], 
           RowBox[{"Cos", "[", "theta", "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phi", ",", 
          RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"theta", ",", "0", ",", 
          RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "6"}], ",", 
        RowBox[{"Mesh", "\[Rule]", "False"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Darker", "@", "Green"}], "}"}]}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rays", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1_", ",", "p2_"}], "}"}], ",", "r_"}], "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Line", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"p1", "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"r", " ", 
              RowBox[{"Cos", "[", "alpha", "]"}]}], ",", 
             RowBox[{"r", " ", 
              RowBox[{"Sin", "[", "alpha", "]"}]}], ",", "0"}], "}"}]}], ",", 
          "p2"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"alpha", ",", "0", ",", 
         RowBox[{"11", 
          RowBox[{"Pi", "/", "6"}]}], ",", 
         RowBox[{"Pi", "/", "6"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cone", "[", "disk_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c", ",", "r", ",", "color"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"InstanceQ", "[", "Halfplane", "]"}], "[", "disk", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"InstanceQ", "[", "CompactDisk", "]"}], "[", "disk", 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"c", "=", 
              RowBox[{"GDiskCenter", "[", "disk", "]"}]}], ";", 
             RowBox[{"r", "=", 
              RowBox[{"GDiskRadius", "[", "disk", "]"}]}], ";", 
             RowBox[{"color", "=", "Gray"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"c", "=", 
              RowBox[{"GDiskCocenter", "[", "disk", "]"}]}], ";", 
             RowBox[{"r", "=", 
              RowBox[{"GDiskCoradius", "[", "disk", "]"}]}], ";", 
             RowBox[{"color", "=", "Black"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"color", ",", 
            RowBox[{"rays", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"2", 
                   RowBox[{"Re", "[", "c", "]"}]}], ",", 
                  RowBox[{"2", 
                   RowBox[{"Im", "[", "c", "]"}]}], ",", 
                  RowBox[{"-", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
              RowBox[{"2", "r"}]}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]",
         "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"plots", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "=", 
         RowBox[{"New", "[", 
          RowBox[{"MoebiusTransformation", ",", 
           RowBox[{"MatrixPower", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"I", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", 
             RowBox[{"Mod", "[", 
              RowBox[{"t", ",", "4", ",", 
               RowBox[{"-", "2"}]}], "]"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"disk", "=", 
         RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"regionPlot", "=", 
         RowBox[{"RegionPlot", "[", 
          RowBox[{
           RowBox[{"InteriorQ", "[", 
            RowBox[{"disk", ",", 
             RowBox[{"x", "+", 
              RowBox[{"I", " ", "y"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
           RowBox[{"PlotPoints", "\[Rule]", "6"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
              RowBox[{"Lighter", "@", "Blue"}]}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<Re\>\"", ",", "\"\<Im\>\""}], "}"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", "False"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
                RowBox[{"Rotate", "[", 
                 RowBox[{"halfSphere", ",", 
                  RowBox[{"Pi", " ", 
                   RowBox[{"t", "/", "2"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], 
                 "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"regionPlot", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "/.", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x_Real", ",", "y_Real"}], "}"}], "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "0"}], "}"}]}]}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PointSize", "\[Rule]", "Large"}], ",", "Red", ",", 
                  RowBox[{"Point", "[", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}]}], "}"}], 
                ","}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Dashed", ",", 
                RowBox[{"cone", "[", "disk", "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "2"}], ",", 
            RowBox[{"Axes", "\[Rule]", "True"}], ",", 
            RowBox[{"AxesLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<Re\>\"", ",", "\"\<Im\>\"", ",", "\"\<\>\""}], 
              "}"}]}], ",", 
            RowBox[{"Ticks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "]"}]}], "}"}]}], ",", 
            RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
            RowBox[{"ViewPoint", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"5", ",", 
               RowBox[{"-", "1.8"}], ",", "2"}], "}"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", "regionPlot"}], "\[IndentingNewLine]", 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "3", ",", 
         RowBox[{"1", "/", "2"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"plots2", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "=", 
         RowBox[{"New", "[", 
          RowBox[{"MoebiusTransformation", ",", 
           RowBox[{"MatrixPower", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"I", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", 
             RowBox[{"Mod", "[", 
              RowBox[{"t", ",", "4", ",", 
               RowBox[{"-", "2"}]}], "]"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"disk", "=", 
         RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"regionPlot", "=", 
         RowBox[{"RegionPlot", "[", 
          RowBox[{
           RowBox[{"InteriorQ", "[", 
            RowBox[{"disk", ",", 
             RowBox[{"x", "+", 
              RowBox[{"I", " ", "y"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
           RowBox[{"PlotPoints", "\[Rule]", "6"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
              RowBox[{"Lighter", "@", "Blue"}]}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<Re\>\"", ",", "\"\<Im\>\""}], "}"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", "False"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
                RowBox[{"Rotate", "[", 
                 RowBox[{"halfSphere", ",", 
                  RowBox[{"Pi", " ", 
                   RowBox[{"t", "/", "2"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], 
                 "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"regionPlot", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "/.", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x_Real", ",", "y_Real"}], "}"}], "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "0"}], "}"}]}]}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PointSize", "\[Rule]", "Large"}], ",", "Red", ",", 
                  RowBox[{"Point", "[", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}]}], "}"}], 
                ","}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Dashed", ",", 
                RowBox[{"cone", "[", "disk", "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "2"}], ",", 
            RowBox[{"Axes", "\[Rule]", "True"}], ",", 
            RowBox[{"AxesLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<Re\>\"", ",", "\"\<Im\>\"", ",", "\"\<\>\""}], 
              "}"}]}], ",", 
            RowBox[{"Ticks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "]"}]}], "}"}]}], ",", 
            RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
            RowBox[{"ViewPoint", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"5", ",", 
               RowBox[{"-", "1.8"}], ",", "2"}], "}"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", "regionPlot"}], "\[IndentingNewLine]", 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "1", ",", 
         RowBox[{"1", "/", "3."}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"figure", "=", 
     RowBox[{"GraphicsGrid", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plots", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"plots", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"plots", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "+", "2"}], ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"plots", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "+", "2"}], ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Scaled", "[", ".25", "]"}], ",", 
          RowBox[{"Scaled", "[", ".5", "]"}]}], "}"}]}], ",", 
       RowBox[{"Dividers", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", "\[Rule]", "Black"}], "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"figure2", "=", 
     RowBox[{"GraphicsGrid", "[", 
      RowBox[{"plots2", ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Scaled", "[", ".5", "]"}], ",", 
          RowBox[{"Scaled", "[", ".25", "]"}]}], "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Column", "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"display", "[", 
        RowBox[{"figure", ",", "500", ",", "\"\<stereo-proj-1.eps\>\""}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"display", "[", 
        RowBox[{"figure2", ",", "400", ",", "\"\<stereo-proj-2.eps\>\""}], 
        "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.5857972063137493`*^9, 3.5857973418033805`*^9}, {
   3.5857974026090097`*^9, 3.5857974228625526`*^9}, {3.5857974860702467`*^9, 
   3.585797517080078*^9}, {3.585797553378051*^9, 3.585797612723641*^9}, {
   3.585797672085232*^9, 3.585797672788251*^9}, {3.5857977086012106`*^9, 
   3.5857977137113476`*^9}, {3.585797756150485*^9, 3.5857977568735037`*^9}, {
   3.58579790523348*^9, 3.5857979234929695`*^9}, {3.58579837390504*^9, 
   3.585798393864575*^9}, {3.585798460414358*^9, 3.585798490369161*^9}, {
   3.585798525457102*^9, 3.5857985411955233`*^9}, {3.5857985753744392`*^9, 
   3.5857986158305235`*^9}, {3.585798672897053*^9, 3.585798713943153*^9}, {
   3.5857988602480736`*^9, 3.58579893286802*^9}, {3.5857989985397797`*^9, 
   3.5857990881571817`*^9}, {3.585799208185398*^9, 3.585799222244775*^9}, {
   3.585799274223168*^9, 3.5857992981568093`*^9}, {3.5857993601094694`*^9, 
   3.5857994806347*^9}, {3.585799698779546*^9, 3.585799788271944*^9}, {
   3.585799851656643*^9, 3.585799889799665*^9}, {3.5857999221565323`*^9, 
   3.585799933442835*^9}, {3.585800019504141*^9, 3.585800030514436*^9}, {
   3.5858001194448195`*^9, 3.5858001230329156`*^9}, {3.585800158946878*^9, 
   3.5858001598199015`*^9}, {3.585801799588846*^9, 3.5858018309086857`*^9}, {
   3.5858022792337*^9, 3.5858022810757494`*^9}, {3.5858023287590275`*^9, 
   3.585802368928104*^9}, {3.5858024183454285`*^9, 3.5858025292454004`*^9}, {
   3.5858025911160583`*^9, 3.585802614870695*^9}, {3.58580271544039*^9, 
   3.5858027720049057`*^9}, {3.585802804679782*^9, 3.585802810058926*^9}, {
   3.585802844097838*^9, 3.5858028495579844`*^9}, {3.5858028807918215`*^9, 
   3.5858028821468577`*^9}, {3.5858029519947295`*^9, 3.585802979173458*^9}, {
   3.5858030610296516`*^9, 3.585803078760127*^9}, {3.5858031250603676`*^9, 
   3.5858031277104387`*^9}, {3.585803326224759*^9, 3.5858033282348127`*^9}, {
   3.5858034868170624`*^9, 3.5858035039395213`*^9}, {3.5858036035081897`*^9, 
   3.5858036906945267`*^9}, {3.5858045504445667`*^9, 3.585804551974608*^9}, {
   3.5858046701747756`*^9, 3.585804737284574*^9}, {3.585804791126017*^9, 
   3.585804791898038*^9}, {3.585805026570327*^9, 3.585805115058698*^9}, {
   3.585805287028307*^9, 3.5858052873943167`*^9}, {3.5858053989773073`*^9, 
   3.5858055756190405`*^9}, {3.5858056224642963`*^9, 
   3.5858057129947224`*^9}, {3.585806186522413*^9, 3.585806190116509*^9}, {
   3.585806247401044*^9, 3.5858062647895103`*^9}, {3.5858063441736374`*^9, 
   3.5858065827460313`*^9}, {3.5858067596227713`*^9, 
   3.5858068033179426`*^9}, {3.585806846802108*^9, 3.5858068662416286`*^9}, {
   3.5858069615061817`*^9, 3.585806969063384*^9}, {3.587225160143324*^9, 
   3.5872252613409386`*^9}, {3.5872253288892155`*^9, 3.587225414767567*^9}, 
   3.587225476965022*^9, 3.587225522408008*^9, {3.587225554029338*^9, 
   3.587225567663793*^9}, {3.5872256079899583`*^9, 3.5872256097371655`*^9}, {
   3.587226013993427*^9, 3.587226028002284*^9}, {3.5930147648750105`*^9, 
   3.593014856761026*^9}, {3.59301500091088*^9, 3.59301500208088*^9}, {
   3.5930153555713396`*^9, 3.5930153556337395`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Minimal region\
\>", "Subtitle",
 CellChangeTimes->{{3.595508267242242*^9, 3.595508270618332*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"display", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighter", "@", 
           RowBox[{"Lighter", "@", "Blue"}]}], ",", 
          RowBox[{"EdgeForm", "@", "Black"}], ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"Scaled", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], ",", "0"}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"Scaled", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", "0"}], "}"}]}], "]"}]}], 
           "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"White", ",", 
          RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#", ",", "0"}], "}"}], ",", "1"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Transparent", ",", 
          RowBox[{"EdgeForm", "[", 
           RowBox[{"Directive", "[", 
            RowBox[{"Dashed", ",", "Black"}], "]"}], "]"}], ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"Scaled", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], ",", "0"}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"Scaled", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", "0"}], "}"}]}], "]"}]}], 
           "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "@", "Medium"}], ",", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"phi", ",", "label"}], "}"}], ",", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"coords", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cos", "@", "phi"}], ",", 
                   RowBox[{"Sin", "@", "phi"}]}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Point", "[", "coords", "]"}], ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{"label", ",", "coords", ",", 
                   RowBox[{
                    RowBox[{"-", "2"}], "coords"}]}], "]"}]}], "}"}]}], 
              "]"}]}], "]"}], "@@@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Pi", "/", "3"}], ",", "\"\<T\[Rho]\>\""}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", 
                RowBox[{"Pi", "/", "3"}]}], ",", "\"\<\[Rho]\>\""}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"4", 
                RowBox[{"Pi", "/", "3"}]}], ",", "\"\<-T\[Rho]\>\""}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"5", 
                RowBox[{"Pi", "/", "3"}]}], ",", "\"\<-\[Rho]\>\""}], "}"}]}],
             "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Dashed", ",", 
          RowBox[{"Circle", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "}"}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2.2"}], ",", "2.2"}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "#"}], ",", "#"}], "}"}], "&"}], "@", 
          "GoldenRatio"}]}], "}"}]}]}], "]"}], ",", "300", ",", 
    "\"\<minimal-region.eps\>\""}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5955063663262987`*^9, 3.59550650632305*^9}, {
  3.595506538193904*^9, 3.595506573401848*^9}, {3.5955066477378397`*^9, 
  3.5955066734605293`*^9}, {3.595506720993803*^9, 3.5955069284323626`*^9}, {
  3.595506989644003*^9, 3.595506993098095*^9}, {3.595507039407336*^9, 
  3.595507419054511*^9}, {3.595507750454392*^9, 3.5955077505703955`*^9}, {
  3.5955082852687244`*^9, 3.5955083882814856`*^9}, {3.595509317332383*^9, 
  3.595509340845013*^9}, {3.595509400703617*^9, 3.595509432781477*^9}, {
  3.5955094951841497`*^9, 3.595509498880248*^9}, {3.597836458711372*^9, 
  3.597836489491298*^9}, {3.597836656889984*^9, 3.597836658590391*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Fundamental region\
\>", "Subtitle",
 CellChangeTimes->{{3.5994652254733667`*^9, 3.5994652334605927`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"display", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"gdA", ",", " ", "gdB"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gdA", "=", 
        RowBox[{"New", "[", 
         RowBox[{"Halfplane", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gdB", " ", "=", 
        RowBox[{"New", "[", 
         RowBox[{"Halfplane", ",", " ", 
          RowBox[{"1", "/", "2"}], ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"GDisk", "[", "gdA", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Green", ",", " ", 
               RowBox[{"GDisk", "[", "gdB", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", 
               RowBox[{"GDisk", "[", "gdUnitDisk", "]"}]}], "}"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"GCircle", "[", "gdA", "]"}], ",", 
             RowBox[{"GCircle", "[", "gdB", "]"}], ",", 
             RowBox[{"GCircle", "[", "gdUnitDisk", "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Dashed", ",", "Black", ",", " ", 
             RowBox[{"GCircle", "[", "gdIncircle0", "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"White", ",", 
             RowBox[{"GDisk", "[", "gdLowerHalfplane", "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"phi", ",", "psi", ",", "label"}], "}"}], ",", 
                RowBox[{"Module", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"coords", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "@", "phi"}], ",", 
                    RowBox[{"Sin", "@", "phi"}]}], "}"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Point", "[", "coords", "]"}], ",", 
                    RowBox[{"Text", "[", 
                    RowBox[{"label", ",", "coords", ",", 
                    RowBox[{
                    RowBox[{"-", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "@", "psi"}], ",", 
                    RowBox[{"Sin", "@", "psi"}]}], "}"}]}]}], "]"}]}], 
                   "}"}]}], "]"}]}], "]"}], "@@@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Pi", "/", "3"}], ",", 
                  RowBox[{"Pi", "/", "4"}], ",", "T\[Rho]"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Pi", "/", "2"}], ",", "0", ",", "\"\<\>\""}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"2", 
                   RowBox[{"Pi", "/", "3"}]}], ",", 
                  RowBox[{"3", 
                   RowBox[{"Pi", "/", "4"}]}], ",", "\[Rho]"}], "}"}]}], 
               "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Magnify", "[", "a", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.5"}], ",", "1.75"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "0"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Magnify", "[", "b", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "1.75"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Magnify", "[", "c", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.25"}], ",", "0.85"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Magnify", "[", "d", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.25", ",", "0.85"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"-", 
              RowBox[{"{", 
               RowBox[{"4", ",", "1"}], "}"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Magnify", "[", 
              RowBox[{"\[DoubleStruckCapitalA]", ",", "2"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1.25"}], ",", "1.5"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Magnify", "[", 
              RowBox[{"\[DoubleStruckCapitalB]", ",", "2"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.25", ",", "1.5"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Magnify", "[", 
              RowBox[{"\[DoubleStruckCapitalD]", ",", "2"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.25"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Magnify", "[", 
              RowBox[{"\[ScriptCapitalF]", ",", "2"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "2.25"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Magnify", "[", 
              RowBox[{"\[ScriptCapitalI]", ",", "2"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1.5"}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "#"}], ",", "#"}], "}"}], "&"}], "@", "1.25"}], 
             "GoldenRatio"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "2.5"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "300", ",", "\"\<fundom.eps\>\""}], 
   "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5994652381718082`*^9, 3.5994657361852303`*^9}, {
   3.5994657672469316`*^9, 3.599465770632142*^9}, {3.599465844453583*^9, 
   3.599465847807594*^9}, {3.5994658805219*^9, 3.5994659657011776`*^9}, {
   3.5994660745155325`*^9, 3.5994661574474025`*^9}, {3.599466189210106*^9, 
   3.5994661928761177`*^9}, 3.5994662923928423`*^9, {3.599466327727957*^9, 
   3.5994666434351854`*^9}, {3.599466678082898*^9, 3.5994667138080144`*^9}, {
   3.599466747753725*^9, 3.5994667645403795`*^9}, {3.599466794757678*^9, 
   3.5994668959572077`*^9}, {3.5994669435539627`*^9, 3.599466987811307*^9}, {
   3.599467018294806*^9, 3.5994670523653173`*^9}, 3.5994670859220266`*^9, {
   3.5994671353907876`*^9, 3.59946713612399*^9}, {3.5994671719729066`*^9, 
   3.5994672195696616`*^9}, {3.5994672588827896`*^9, 3.599467414917498*^9}, {
   3.599467459286042*^9, 3.599467699425625*^9}, {3.599468073388443*^9, 
   3.5994680742464457`*^9}, {3.599468147273283*^9, 3.599468148755288*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Modified Cayley Transform and Modular Tiling\
\>", "Subtitle",
 CellChangeTimes->{{3.5898634289779954`*^9, 3.589863453641676*^9}, {
  3.595506837003912*^9, 3.595506838227945*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"figure1", ",", "criteria", ",", "gds", ",", 
     RowBox[{"minSize", "=", 
      SuperscriptBox["2", 
       RowBox[{"-", "9"}]]}], ",", 
     RowBox[{"maxDistance", "=", "3"}], ",", "mtList", ",", "phi", ",", 
     "viewCenter", ",", "plotRange"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"criteria", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "mt", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gds", "=", 
         RowBox[{"GDiskMatMap", "[", 
          RowBox[{
           RowBox[{"Mat", "@", "gdIncircle0"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Mat", "@", "mt"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"I", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ".", 
              RowBox[{"Mat", "@", "mt"}]}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"GDiskMatRadius", "@", 
             RowBox[{"gds", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "\[GreaterEqual]", 
            "minSize"}], "&&", 
           RowBox[{
            RowBox[{"Abs", "@", 
             RowBox[{"GDiskMatCenter", "@", 
              RowBox[{"gds", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "<", "maxDistance"}]}], 
          ")"}], "||", 
         RowBox[{
          RowBox[{"GDiskMatRadius", "@", 
           RowBox[{"gds", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "\[GreaterEqual]", 
          "minSize"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mtList", "=", 
     RowBox[{"ModularGroupList", "[", "criteria", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"SetOptions", "[", 
     RowBox[{"TUExponents", ",", 
      RowBox[{"QuotientFunction", "\[Rule]", "CQuotient"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"plots1", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "=", 
         RowBox[{"MatrixPower", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"I", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", "t"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"viewCenter", "=", 
         RowBox[{"Inhom", "[", 
          RowBox[{"phi", ".", 
           RowBox[{"{", 
            RowBox[{"I", ",", "1"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"plotRange", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "GoldenRatio"}], ",", "GoldenRatio"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "2"}], "}"}]}], "}"}], ",", "1"}], "}"}], 
          "[", 
          RowBox[{"[", 
           RowBox[{"t", "+", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"ModularTiling", "[", 
           RowBox[{"mtList", ",", "phi", ",", "\[IndentingNewLine]", 
            RowBox[{"IncircleMode", "\[Rule]", "GDisk"}], ",", " ", 
            RowBox[{"IncircleStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"EdgeForm", "[", "Gray", "]"}], ",", "LightGray"}], 
              "]"}]}], ",", 
            RowBox[{"IncircleThreshold", "\[Rule]", 
             SuperscriptBox["2", 
              RowBox[{"-", "6"}]]}], ",", "\[IndentingNewLine]", 
            RowBox[{"TilingThreshold", "\[Rule]", 
             SuperscriptBox["2", 
              RowBox[{"-", "6"}]]}], ",", "\[IndentingNewLine]", 
            RowBox[{"LabelMode", "\[Rule]", "TUWord"}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"LabelThreshold", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "/", "12"}], ",", 
                 RowBox[{"1", "/", "16"}]}], "}"}], "[", 
               RowBox[{"[", 
                RowBox[{"t", "+", "1"}], "]"}], "]"}], ")"}]}], ",", 
            RowBox[{"Magnification", "\[Rule]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"5", ",", "8"}], "}"}], "[", 
              RowBox[{"[", 
               RowBox[{"t", "+", "1"}], "]"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"AxesStyle", "\[Rule]", "Gray"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"400", ",", "Automatic"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"plots2", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "=", 
         RowBox[{"MatrixPower", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"I", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", "t"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"viewCenter", "=", 
         RowBox[{"Inhom", "[", 
          RowBox[{"phi", ".", 
           RowBox[{"{", 
            RowBox[{"I", ",", "1"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"plotRange", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Re", "@", "viewCenter"}], "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "GoldenRatio"}], ",", 
              RowBox[{"+", "GoldenRatio"}]}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"Im", "@", "viewCenter"}], "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"+", "1"}]}], "}"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"ModularTiling", "[", 
           RowBox[{"mtList", ",", "phi", ",", "\[IndentingNewLine]", 
            RowBox[{"IncircleMode", "\[Rule]", "GDisk"}], ",", " ", 
            RowBox[{"IncircleStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"EdgeForm", "[", "Gray", "]"}], ",", "LightGray"}], 
              "]"}]}], ",", 
            RowBox[{"IncircleThreshold", "\[Rule]", 
             SuperscriptBox["2", 
              RowBox[{"-", "4"}]]}], ",", "\[IndentingNewLine]", 
            RowBox[{"TilingThreshold", "\[Rule]", 
             SuperscriptBox["2", 
              RowBox[{"-", "4"}]]}], ",", "\[IndentingNewLine]", 
            RowBox[{"LabelMode", "\[Rule]", "TUWord"}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"LabelThreshold", "\[Rule]", 
             RowBox[{"1", "/", "7"}]}], ",", 
            RowBox[{"Magnification", "\[Rule]", "3"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"AxesStyle", "\[Rule]", "Gray"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"200", ",", "Automatic"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "1", ",", 
         RowBox[{"1", "/", "3."}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"figure1", "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"h", ",", " ", "w", ",", "w2", ",", "h2", ",", " ", 
         RowBox[{"m", "=", "0.2"}], ",", "u", ",", "l"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"h", "=", 
         RowBox[{"m", "+", "GoldenRatio"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"h2", "=", 
         RowBox[{"GoldenRatio", "/", "4"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"w2", "=", 
         RowBox[{"GoldenRatio", " ", "h2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"w", "=", 
         RowBox[{"1", "+", "m", "+", "w2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"u", "=", 
         RowBox[{
          RowBox[{"3", "h2"}], "+", "m"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"l", "=", 
         RowBox[{"h2", "/", "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Inset", "[", 
             RowBox[{
              RowBox[{"plots1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", 
                RowBox[{"1", "+", "m"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Inset", "[", 
             RowBox[{
              RowBox[{"plots1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", 
                RowBox[{"1", "/", "2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Inset", "[", 
               RowBox[{
                RowBox[{"plots2", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1", "+", "m", "+", 
                   RowBox[{"w2", "/", "2"}]}], ",", 
                  RowBox[{
                   RowBox[{"u", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"4", "-", "#"}], ")"}], "/", "3"}]}], "+", 
                   RowBox[{"l", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", "1"}], ")"}], "/", "3"}]}]}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"1", "/", "GoldenRatio"}]}], "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", "4", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Line", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "+", 
                  RowBox[{"m", "/", "2"}]}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "+", 
                  RowBox[{"m", "/", "2"}]}], ",", "h"}], "}"}]}], "}"}]}]}], 
           "\[IndentingNewLine]", "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "w"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "h"}], "}"}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"display", "[", 
     RowBox[{"figure1", ",", "500", ",", "\"\<modular-tiling-1.eps\>\""}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.587736980242491*^9, 3.5877370307710977`*^9}, {
   3.58773706796165*^9, 3.587737070098859*^9}, {3.58773712409068*^9, 
   3.587737147771577*^9}, {3.587737730309163*^9, 3.587737746845231*^9}, {
   3.5877397756805954`*^9, 3.5877397763357983`*^9}, {3.5879963561677327`*^9, 
   3.587996556284216*^9}, {3.5879971684019876`*^9, 3.587997256132391*^9}, {
   3.5879973196901326`*^9, 3.5879973412197227`*^9}, {3.587997371570554*^9, 
   3.587997417948825*^9}, {3.5879974556428576`*^9, 3.587997541586212*^9}, {
   3.5882587902330704`*^9, 3.588258857450912*^9}, {3.588258944315292*^9, 
   3.5882589445022974`*^9}, {3.5882595203120737`*^9, 3.588259654442749*^9}, {
   3.5882597547104964`*^9, 3.588259775135056*^9}, {3.588259808410968*^9, 
   3.5882598179542294`*^9}, {3.5882599330003815`*^9, 3.5882599345024223`*^9}, 
   3.5882600895426702`*^9, {3.588261191672868*^9, 3.58826119174387*^9}, {
   3.588261293243651*^9, 3.5882612936996636`*^9}, 3.588261333464753*^9, {
   3.588261525040002*^9, 3.5882615791504846`*^9}, {3.588261611504371*^9, 
   3.588261626292776*^9}, {3.588430380282135*^9, 3.588430420714243*^9}, {
   3.5884305124137554`*^9, 3.588430516903878*^9}, 3.5884308444718533`*^9, {
   3.588430885698983*^9, 3.5884310426902847`*^9}, {3.5884310855784597`*^9, 
   3.5884313369733477`*^9}, {3.588431369688244*^9, 3.5884314202506294`*^9}, {
   3.5884314618867702`*^9, 3.5884314924146066`*^9}, {3.588431573141818*^9, 
   3.5884316169700193`*^9}, {3.5884316890189934`*^9, 3.588431762693012*^9}, 
   3.5884318001430383`*^9, {3.588431833884963*^9, 3.588431833981965*^9}, {
   3.588431877835167*^9, 3.58843188378533*^9}, {3.588431970874716*^9, 
   3.5884321237359047`*^9}, {3.588432168681136*^9, 3.5884322473982925`*^9}, {
   3.5884322807462063`*^9, 3.588432311869059*^9}, {3.588432366462555*^9, 
   3.588432393738302*^9}, {3.58843244549172*^9, 3.588432473325483*^9}, {
   3.588432512443555*^9, 3.588432530759056*^9}, {3.5884326778020854`*^9, 
   3.5884327622854*^9}, {3.588432891808949*^9, 3.5884330273566628`*^9}, {
   3.5884330615766*^9, 3.5884330694968176`*^9}, {3.588433173104656*^9, 
   3.5884331966933026`*^9}, {3.588433237697426*^9, 3.588433304118246*^9}, {
   3.5884333620858345`*^9, 3.588433362593848*^9}, {3.588433415106287*^9, 
   3.5884335095078735`*^9}, {3.5884335454468584`*^9, 
   3.5884336682712235`*^9}, {3.5884337363770895`*^9, 
   3.5884337813083205`*^9}, {3.58843393658296*^9, 3.5884339731651096`*^9}, {
   3.5884340597766647`*^9, 3.588434073972723*^9}, {3.5884343102668905`*^9, 
   3.588434362402304*^9}, {3.588434401355664*^9, 3.5884344016520653`*^9}, {
   3.588434481999199*^9, 3.5884344964136577`*^9}, {3.588697842461097*^9, 
   3.5886978938965063`*^9}, {3.5886985928976583`*^9, 3.58869859333267*^9}, {
   3.58870048754957*^9, 3.588700560963582*^9}, 3.588700591872429*^9, 
   3.5887008011731634`*^9, 3.5887008426743*^9, {3.588700905533023*^9, 
   3.5887009626025867`*^9}, {3.588701004458733*^9, 3.5887010585592155`*^9}, {
   3.5887014671684113`*^9, 3.5887014895990257`*^9}, {3.5887015223649235`*^9, 
   3.588701548406637*^9}, {3.5887016297668667`*^9, 3.588701635333019*^9}, 
   3.5887016742210846`*^9, {3.588701775130849*^9, 3.588701789360239*^9}, {
   3.5887018469038153`*^9, 3.58870189450712*^9}, {3.5887019319831467`*^9, 
   3.5887019333951855`*^9}, {3.588702445885227*^9, 3.5887024624056797`*^9}, {
   3.5887026054625998`*^9, 3.5887026153088694`*^9}, {3.58870274234035*^9, 
   3.5887027640709457`*^9}, {3.588751789744584*^9, 3.588751790082593*^9}, {
   3.588751877115899*^9, 3.588751904618628*^9}, {3.588752034461069*^9, 
   3.5887520361411133`*^9}, {3.5887521970173764`*^9, 3.588752203835557*^9}, 
   3.588752240241522*^9, {3.588752312062425*^9, 3.588752339132142*^9}, {
   3.5887523845953474`*^9, 3.5887524168642025`*^9}, {3.5887524523971443`*^9, 
   3.5887524864690466`*^9}, {3.588778991112209*^9, 3.5887789925002456`*^9}, {
   3.5888621396109967`*^9, 3.588862140296015*^9}, {3.5888634186608906`*^9, 
   3.5888634597119784`*^9}, {3.588863502605115*^9, 3.588863512797385*^9}, {
   3.588863593881534*^9, 3.58886365070704*^9}, {3.588863939247686*^9, 
   3.5888639989622684`*^9}, {3.588864058626849*^9, 3.588864129893738*^9}, {
   3.588864160352545*^9, 3.5888641715378413`*^9}, {3.588864222125182*^9, 
   3.588864260844208*^9}, {3.5888643112435436`*^9, 3.5888643789753385`*^9}, {
   3.5888644988735156`*^9, 3.588864507692749*^9}, {3.5888646524885864`*^9, 
   3.5888646578137274`*^9}, {3.5888646888375497`*^9, 
   3.5888646985868077`*^9}, {3.5888647796729565`*^9, 
   3.5888649075553455`*^9}, {3.5888649420662603`*^9, 
   3.5888650447849817`*^9}, {3.588865079556903*^9, 3.5888650837480145`*^9}, {
   3.588865148835739*^9, 3.5888652040062013`*^9}, {3.5888652888804502`*^9, 
   3.5888653438329067`*^9}, {3.5888653753157406`*^9, 
   3.5888654156348095`*^9}, {3.5888654488116884`*^9, 3.588865483894618*^9}, {
   3.5888655555815177`*^9, 3.588865573849002*^9}, {3.588865613140043*^9, 
   3.5888656892740602`*^9}, {3.5888658847562404`*^9, 
   3.5888658849232445`*^9}, {3.58886597455062*^9, 3.5888659781857166`*^9}, {
   3.588866728178591*^9, 3.5888667671436234`*^9}, {3.588866801691539*^9, 
   3.5888669390861797`*^9}, {3.588866975552146*^9, 3.588867006312961*^9}, {
   3.588867126126136*^9, 3.588867137003424*^9}, {3.5888672464573245`*^9, 
   3.588867249575407*^9}, {3.5888673580952826`*^9, 3.588867451122748*^9}, {
   3.5888674916438217`*^9, 3.5888675341599483`*^9}, {3.588867564213745*^9, 
   3.5888675779241085`*^9}, {3.5888676298304834`*^9, 3.588867633692586*^9}, {
   3.5888676664254537`*^9, 3.588867691237111*^9}, {3.588867736044298*^9, 
   3.5888677376993423`*^9}, {3.588867776195362*^9, 3.588867832459853*^9}, {
   3.5888678964115477`*^9, 3.5888679391896815`*^9}, {3.588867973515591*^9, 
   3.588867996220193*^9}, {3.588868166336701*^9, 3.5888683031933274`*^9}, 
   3.5888683435633974`*^9, {3.5888684439120564`*^9, 3.588868445291093*^9}, 
   3.588868522376136*^9, {3.5888714573229094`*^9, 3.5888714686142087`*^9}, {
   3.588952360756848*^9, 3.588952403793988*^9}, 3.5889524356018314`*^9, {
   3.5889549074516373`*^9, 3.588954907844648*^9}, {3.588955789795019*^9, 
   3.5889558206848373`*^9}, {3.5889561018632884`*^9, 
   3.5889561146206264`*^9}, {3.588956223590514*^9, 3.588956235278824*^9}, {
   3.589034735329452*^9, 3.5890347581080556`*^9}, {3.589034806915349*^9, 
   3.5890348208477182`*^9}, {3.5890350136398273`*^9, 
   3.5890350360994225`*^9}, {3.5930156913425517`*^9, 
   3.5930156942909517`*^9}, {3.593015829234975*^9, 3.5930158292817745`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

The action of Modular Transformations\
\>", "Subtitle",
 CellChangeTimes->{{3.601373455999736*^9, 3.601373469259779*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "mtList", ",", "mtSublist", ",", "zs", ",", "modCayley", ",", "gx", ",", 
     "labelpt", ",", "mytiling", ",", "myttiling", ",", "mytfigure"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mtList", "=", 
     RowBox[{"ModularGroupList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PSL2ZGrading", "@", 
         RowBox[{"Mat", "@", "#"}]}], "<", "200"}], "&"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"modCayley", "=", 
     RowBox[{"New", "[", 
      RowBox[{"MoebiusTransformation", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"I", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mtSublist", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"mtList", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"GDiskMatRadius", "[", 
            RowBox[{"GDiskMatMap", "[", 
             RowBox[{
              RowBox[{"Mat", "@", "gdFord0"}], ",", 
              RowBox[{
               RowBox[{"Mat", "@", "modCayley"}], " ", ".", " ", 
               RowBox[{"Mat", "@", "#"}]}]}], "]"}], "]"}], ">", 
           RowBox[{"1", "/", "10"}]}], "&&", 
          RowBox[{"ModularGroup`Private`fordCriteria", "@", 
           RowBox[{"Mat", "@", "#"}]}]}], ")"}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"zs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", "ComplexInfinity", "]"}], "&"}], "/@", 
      "mtSublist"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gx", "[", 
      RowBox[{"phi_", ",", "psi_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"ModularTiling", "[", 
      RowBox[{"mtList", ",", 
       RowBox[{"phi", ".", 
        RowBox[{"MatrixPower", "[", 
         RowBox[{"psi", ",", 
          RowBox[{"N", "@", "t"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"IncircleMode", "\[Rule]", "GDisk"}], ",", " ", 
       RowBox[{"IncircleStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "Gray", "]"}], ",", "LightGray"}], "]"}]}],
        ",", 
       RowBox[{"IncircleThreshold", "\[Rule]", 
        SuperscriptBox["2", 
         RowBox[{"-", "6"}]]}], ",", "\[IndentingNewLine]", 
       RowBox[{"TilingThreshold", "\[Rule]", 
        SuperscriptBox["2", 
         RowBox[{"-", "6"}]]}], ",", "\[IndentingNewLine]", 
       RowBox[{"LabelMode", "\[Rule]", "TUWord"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
       RowBox[{"LabelThreshold", "\[Rule]", 
        RowBox[{"1", "/", "12"}]}], ",", 
       RowBox[{"Magnification", "\[Rule]", "3"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"mytiling", "[", 
        RowBox[{"psi_", ",", "t_"}], "]"}], ":=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"gx", "[", 
          RowBox[{
           RowBox[{"IdentityMatrix", "@", "2"}], ",", 
           RowBox[{"Mat", "@", "psi"}], ",", "t"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Axes", "\[Rule]", "True"}], ",", 
         RowBox[{"AxesStyle", "\[Rule]", "Gray"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"2", "GoldenRatio"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Superscript", "[", 
             RowBox[{"psi", ",", "t"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"mtT", "\[Rule]", "T"}], ",", 
              RowBox[{"mtU", "\[Rule]", "U"}], ",", 
              RowBox[{"mtR", "\[Rule]", "R"}]}], "}"}]}], ")"}]}]}], "]"}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"labelpt", "[", 
      RowBox[{"m_", ",", "z_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "pt"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"z", "===", "ComplexInfinity"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pt", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Re", "@", "#"}], ",", 
             RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", 
          RowBox[{"Inhom", "[", 
           RowBox[{"m", ".", "v"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Point", "[", "pt", "]"}], ",", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"z", "/.", 
             RowBox[{"ComplexInfinity", "\[Rule]", "\[Infinity]"}]}], ",", 
            "pt", ",", 
            RowBox[{
             RowBox[{"-", "2"}], "*", "pt"}]}], "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mytiling", "[", 
      RowBox[{"psi_", ",", "t_", ",", "fix_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "m", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m", "=", 
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"Mat", "[", "modCayley", "]"}]}], ".", 
          RowBox[{"MatrixPower", "[", 
           RowBox[{
            RowBox[{"Mat", "@", "psi"}], ",", "t"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"gx", "[", 
             RowBox[{
              RowBox[{"Mat", "@", "modCayley"}], ",", 
              RowBox[{"Mat", "@", "psi"}], ",", "t"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"labelpt", "[", 
                 RowBox[{"m", ",", "#"}], "]"}], "&"}], "/@", "zs"}]}], "}"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Red", ",", 
              RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Re", "@", "#"}], ",", 
                   RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", 
                RowBox[{"Inhom", "[", 
                 RowBox[{"m", ".", "fix"}], "]"}]}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Axes", "\[Rule]", "True"}], ",", 
            RowBox[{"AxesStyle", "\[Rule]", "Gray"}], ","}], "*)"}], 
          RowBox[{"PlotRange", "\[Rule]", "1.25"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Superscript", "[", 
              RowBox[{"psi", ",", "t"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"mtT", "\[Rule]", "T"}], ",", 
               RowBox[{"mtU", "\[Rule]", "U"}], ",", 
               RowBox[{"mtR", "\[Rule]", "R"}]}], "}"}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mytfigure", "[", 
      RowBox[{"psi_", ",", "fix_"}], "]"}], ":=", 
     RowBox[{"GraphicsGrid", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"myttiling", "[", 
            RowBox[{"psi", ",", "0"}], "]"}], ",", 
           RowBox[{"myttiling", "[", 
            RowBox[{"psi", ",", 
             RowBox[{"1", "/", "6"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"myttiling", "[", 
            RowBox[{"psi", ",", 
             RowBox[{"1", "/", "3"}]}], "]"}], ",", 
           RowBox[{"myttiling", "[", 
            RowBox[{"psi", ",", 
             RowBox[{"2", "/", "3"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"myttiling", "[", 
            RowBox[{"psi", ",", 
             RowBox[{"5", "/", "6"}]}], "]"}], ",", 
           RowBox[{"myttiling", "[", 
            RowBox[{"psi", ",", "1"}], "]"}]}], "}"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mytiling", "[", 
           RowBox[{"psi", ",", "0", ",", "fix"}], "]"}], ",", 
          RowBox[{"mytiling", "[", 
           RowBox[{"psi", ",", "1", ",", "fix"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mytiling", "[", 
           RowBox[{"psi", ",", 
            RowBox[{"1", "/", "5"}], ",", "fix"}], "]"}], ",", 
          RowBox[{"mytiling", "[", 
           RowBox[{"psi", ",", 
            RowBox[{"4", "/", "5"}], ",", "fix"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mytiling", "[", 
           RowBox[{"psi", ",", 
            RowBox[{"2", "/", "5"}], ",", "fix"}], "]"}], ",", 
          RowBox[{"mytiling", "[", 
           RowBox[{"psi", ",", 
            RowBox[{"3", "/", "5"}], ",", "fix"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Column", "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"display", "[", 
        RowBox[{
         RowBox[{"mytfigure", "[", 
          RowBox[{"mtU", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", "400", ",", 
         "\"\<u-action.eps\>\""}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"display", "[", 
        RowBox[{
         RowBox[{"mytfigure", "[", 
          RowBox[{"mtT", ",", 
           RowBox[{"{", 
            RowBox[{"I", ",", "1"}], "}"}]}], "]"}], ",", "400", ",", 
         "\"\<t-action.eps\>\""}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"display", "[", 
        RowBox[{
         RowBox[{"mytfigure", "[", 
          RowBox[{"mtR", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"2", " ", "Pi", " ", 
               RowBox[{"I", "/", "3"}]}], "]"}], ",", "1"}], "}"}]}], "]"}], 
         ",", "400", ",", "\"\<r-action.eps\>\""}], "]"}]}], 
      "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6013734917394524`*^9, 3.6013734923010545`*^9}, {
   3.6013735374944015`*^9, 3.6013735994422035`*^9}, {3.601373709812563*^9, 
   3.6013742696359854`*^9}, {3.6013743118185225`*^9, 3.601374347137038*^9}, {
   3.6013743924395857`*^9, 3.6013743965267987`*^9}, {3.601374432796917*^9, 
   3.6013744347469234`*^9}, {3.6013744689890347`*^9, 3.601374532606042*^9}, {
   3.601374562948141*^9, 3.601374568392558*^9}, {3.601374599249459*^9, 
   3.6013746452852087`*^9}, {3.6013747071238103`*^9, 3.601374751287554*^9}, {
   3.60137488201598*^9, 3.6013748856039915`*^9}, {3.6013751464524407`*^9, 
   3.6013751740021305`*^9}, {3.601375273031253*^9, 3.6013752756520615`*^9}, {
   3.6013754137437115`*^9, 3.60137543784579*^9}, {3.6013780433350744`*^9, 
   3.6013781182621183`*^9}, {3.6014402269543*^9, 3.6014403683844004`*^9}, {
   3.6014404325474277`*^9, 3.6014404534671016`*^9}, 3.601440531264577*^9, {
   3.601440790412694*^9, 3.6014408539205184`*^9}, {3.601440888037839*^9, 
   3.601441098186183*^9}, {3.6014411702272377`*^9, 3.601441170617239*^9}, {
   3.6014412851060443`*^9, 3.6014413344646187`*^9}, {3.6014415262672977`*^9, 
   3.6014415408377495`*^9}, {3.6014416783054357`*^9, 3.601441703015923*^9}, {
   3.601441768255354*^9, 3.6014418046346827`*^9}, {3.601441930729929*^9, 
   3.6014420425979247`*^9}, {3.6014420815824623`*^9, 3.601442303945649*^9}, {
   3.601442462738611*^9, 3.6014425023939514`*^9}, {3.6014426953666344`*^9, 
   3.601442696146637*^9}, {3.6014427496236267`*^9, 3.6014428343631263`*^9}, {
   3.6014449097008696`*^9, 3.6014449184057007`*^9}, {3.601444997919182*^9, 
   3.601445005578809*^9}, {3.6014457761863394`*^9, 3.601445778963149*^9}, {
   3.601445914012827*^9, 3.6014459155572324`*^9}, {3.6014466444698114`*^9, 
   3.6014466471998215`*^9}, {3.6014470285387735`*^9, 3.601447029474777*^9}, {
   3.601447108286256*^9, 3.6014471231531086`*^9}, {3.601447528658347*^9, 
   3.6014476486227717`*^9}, {3.6014476900565186`*^9, 
   3.6014476903373194`*^9}, {3.6014478712979593`*^9, 3.601447871719161*^9}, {
   3.601447979624743*^9, 3.6014480100448503`*^9}, {3.6015616675480733`*^9, 
   3.6015616818694572`*^9}, {3.6015618013006573`*^9, 3.601561826205325*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Modular Tiling and Exponential Transformation\
\>", "Subtitle",
 CellChangeTimes->{{3.589863462986106*^9, 3.5898634771821527`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"circ", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "r", ",", "t"}], "}"}], ",", 
     RowBox[{"m", "+", 
      RowBox[{"r", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", " ", "I", " ", "Pi", " ", "t"}], "]"}]}]}], ",", 
     "Listable"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"halfCirc", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "r", ",", "t"}], "}"}], ",", 
     RowBox[{"m", "+", 
      RowBox[{"r", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "Pi", " ", "t"}], "]"}]}]}], ",", "Listable"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"arc", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "r", ",", "\[Alpha]", ",", "\[Beta]", ",", "t"}], 
       "}"}], ",", 
      RowBox[{"m", "+", 
       RowBox[{"r", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"I", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Beta]", "-", "\[Alpha]"}], ")"}], "t"}]}], ")"}]}], 
         "]"}]}]}], ",", "Listable"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expHomotopy", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "z"}], "}"}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"I", "/", 
         RowBox[{"(", 
          RowBox[{"z", "+", "I"}], ")"}]}], ")"}], 
       RowBox[{"1", "-", "p"}]], 
      RowBox[{"Exp", "[", 
       RowBox[{"2", " ", "Pi", " ", "I", " ", "p", " ", "z"}], "]"}]}], ",", 
     "Listable"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expCoords", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "_Complex"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Evaluate", "@", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Re", "@", "#"}], ",", 
            RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", 
         RowBox[{"expHomotopy", "[", 
          RowBox[{"p", ",", "z"}], "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", "Listable"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expTilingPlot", "[", 
    RowBox[{"mtList_", ",", "p_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ms", ",", "disks", ",", "arcs"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ms", "=", 
       RowBox[{"Mat", "/@", "mtList"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"disks", "=", 
       RowBox[{"GDiskMatMap", "[", 
        RowBox[{
         RowBox[{"Mat", "@", "gdUnitDisk"}], ",", "ms"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"arcs", "=", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", "2"}], "-", "I", "+", 
              RowBox[{"I", "/", "#"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], "-", "I", "+", 
              RowBox[{"I", "/", "#"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"arc", "[", 
              RowBox[{"0", ",", "1", ",", 
               RowBox[{"Pi", "/", "3"}], ",", 
               RowBox[{"2", 
                RowBox[{"Pi", "/", "3"}]}], ",", "#"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"arc", "[", 
              RowBox[{"1", ",", "1", ",", 
               RowBox[{"2", 
                RowBox[{"Pi", "/", "3"}]}], ",", "Pi", ",", "#"}], "]"}], ",", 
             RowBox[{"arc", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1", ",", "0", ",", 
               RowBox[{"Pi", "/", "3"}], ",", "#"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"arc", "[", 
              RowBox[{
               RowBox[{"1", "/", "3"}], ",", 
               RowBox[{"1", "/", "3"}], ",", 
               RowBox[{"Pi", "/", "3"}], ",", "Pi", ",", "#"}], "]"}], ",", 
             " ", 
             RowBox[{"arc", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "/", "3"}], ",", 
               RowBox[{"1", "/", "3"}], ",", "0", ",", 
               RowBox[{"2", 
                RowBox[{"Pi", "/", "3"}]}], ",", "#"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"arc", "[", 
              RowBox[{
               RowBox[{"2", "/", "3"}], ",", 
               RowBox[{"1", "/", "3"}], ",", 
               RowBox[{"2", 
                RowBox[{"Pi", "/", "3"}]}], ",", "Pi", ",", "#"}], "]"}], ",", 
             RowBox[{"arc", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], ",", 
               RowBox[{"1", "/", "3"}], ",", "0", ",", 
               RowBox[{"Pi", "/", "3"}], ",", "#"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"halfCirc", "[", 
            RowBox[{
             RowBox[{"GDiskMatCenter", "@", "disks"}], ",", 
             RowBox[{"GDiskMatRadius", "@", "disks"}], ",", "#"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], "]"}], "&"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"expCoords", "[", 
           RowBox[{"p", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"arcs", "[", "t", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "opts", "}"}], ",", " ", 
           RowBox[{"Options", "[", "ParametricPlot", "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expIncirclePlot", "[", 
    RowBox[{"mtList_", ",", "p_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ms", ",", "disks", ",", "circs"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ms", "=", 
       RowBox[{"Mat", "/@", "mtList"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"disks", "=", 
       RowBox[{"GDiskMatMap", "[", 
        RowBox[{
         RowBox[{"Mat", "@", "gdIncircle0"}], ",", "ms"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"circs", "=", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"circ", "[", 
          RowBox[{
           RowBox[{"GDiskMatCenter", "@", "disks"}], ",", 
           RowBox[{"GDiskMatRadius", "@", "disks"}], ",", "#"}], "]"}], "]"}],
         "&"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"expCoords", "[", 
           RowBox[{"p", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"circs", "[", "t", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "opts", "}"}], ",", 
           RowBox[{"Options", "[", "ParametricPlot", "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expIncircleLabels", "[", 
    RowBox[{"mtList_", ",", "p_", ",", "labelFu_", ",", "displayFu_"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ms", ",", "disks", ",", "centers", ",", "radii", ",", "north", ",", 
       "south", ",", "labelSizes", ",", "labels"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ms", "=", 
       RowBox[{"Mat", "/@", "mtList"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"disks", "=", 
       RowBox[{"GDiskMatMap", "[", 
        RowBox[{
         RowBox[{"Mat", "@", "gdIncircle0"}], ",", "ms"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"centers", "=", 
       RowBox[{"GDiskMatCenter", "@", "disks"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"radii", "=", 
       RowBox[{"GDiskMatRadius", "@", "disks"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"north", "=", 
       RowBox[{"centers", "+", 
        RowBox[{"I", " ", "radii"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"south", "=", 
       RowBox[{"centers", "-", 
        RowBox[{"I", " ", "radii"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"labelSizes", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"expHomotopy", "[", 
          RowBox[{"p", ",", "north"}], "]"}], "-", 
         RowBox[{"expHomotopy", "[", 
          RowBox[{"p", ",", "south"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"labels", "=", 
       RowBox[{"labelFu", "/@", "mtList"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"\"\<f\>\"", "[", 
         RowBox[{"labels", ",", 
          RowBox[{"expHomotopy", "[", 
           RowBox[{"p", ",", "centers"}], "]"}], ",", "labelSizes"}], "]"}], 
        "]"}], "/.", 
       RowBox[{"\"\<f\>\"", "\[Rule]", "displayFu"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nPlots", "=", "6"}], ",", "pStep", ",", "criteria", ",", 
     "mtList", ",", "\[IndentingNewLine]", "tilingList", ",", "tilingPlots", 
     ",", "\[IndentingNewLine]", "incircleList", ",", "incirclePlots", ",", 
     "\[IndentingNewLine]", "labelList", ",", "labelPlot", ",", 
     "zoomRectangles", ",", "\[IndentingNewLine]", "fanPlot", ",", "zoomPlot",
      ",", "zoomList", ",", "\[IndentingNewLine]", "figure1", ",", 
     "figure2"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pStep", "=", 
     RowBox[{"1.", "/", 
      RowBox[{"(", 
       RowBox[{"nPlots", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"criteria", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"GDiskMatRadius", "[", 
        RowBox[{"GDiskMatMap", "[", 
         RowBox[{
          RowBox[{"Mat", "@", "gdIncircle0"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"I", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ".", 
           RowBox[{"Mat", "@", "#"}]}]}], "]"}], "]"}], "\[GreaterEqual]", 
       SuperscriptBox["2", 
        RowBox[{"-", "7"}]]}], "&"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"mtList", "=", 
     RowBox[{"ModularGroupList", "[", "criteria", "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"tilingList", "=", 
     RowBox[{"Rest", "@", 
      RowBox[{"Select", "[", 
       RowBox[{"mtList", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"TRRight", "@", "#"}], "===", "mtT"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "@", 
            RowBox[{"Re", "@", 
             RowBox[{"#", "[", "I", "]"}]}]}], "\[LessEqual]", 
           RowBox[{"1", "/", "2"}]}], "&&", 
          RowBox[{
           RowBox[{"Im", "@", 
            RowBox[{"#", "[", "I", "]"}]}], "\[LessEqual]", 
           RowBox[{"1", "/", "6"}]}]}], "&"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tilingPlots", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"expTilingPlot", "[", 
        RowBox[{"tilingList", ",", "p", ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "0", ",", "1", ",", "pStep"}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"incircleList", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"mtList", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "@", 
          RowBox[{"Re", "@", 
           RowBox[{"#", "[", 
            RowBox[{"2", "I"}], "]"}]}]}], "\[LessEqual]", 
         RowBox[{"1", "/", "2"}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"incirclePlots", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"expIncirclePlot", "[", 
        RowBox[{"incircleList", ",", "p", ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "0", ",", "1", ",", "pStep"}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"labelList", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"incircleList", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"GDiskMatRadius", "[", 
          RowBox[{"GDiskMatMap", "[", 
           RowBox[{
            RowBox[{"Mat", "@", "gdIncircle0"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "I"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ".", 
             RowBox[{"Mat", "@", "#"}]}]}], "]"}], "]"}], "\[GreaterEqual]", 
         SuperscriptBox["2", 
          RowBox[{"-", "4"}]]}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SetOptions", "[", 
     RowBox[{"TUExponents", ",", 
      RowBox[{"QuotientFunction", "\[Rule]", "CQuotient"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"labelPlot", "[", 
      RowBox[{"size_", ",", "p_"}], "]"}], ":=", 
     RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
      RowBox[{"expIncircleLabels", "[", 
       RowBox[{"labelList", ",", "p", ",", "TUWord", ",", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Magnify", "[", 
            RowBox[{"#1", ",", 
             RowBox[{"Clip", "[", 
              RowBox[{
               RowBox[{"size", " ", "#3"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "2."}], "}"}]}], "]"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Re", "@", "#"}], ",", 
               RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", "#2"}]}], "]"}],
          "&"}]}], "]"}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"zoomRectangles", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"EdgeForm", "[", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", "Dashed"}], "]"}], "]"}], ",", 
            "Transparent", ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "#"}], ",", 
                RowBox[{"-", "#"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "#"}], "}"}]}], "]"}]}], "}"}], "]"}], "&"}],
         "@", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "Pi", " ", "p"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "0", ",", "1", ",", "pStep"}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fanPlot", "[", "i_", "]"}], ":=", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"incirclePlots", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"tilingPlots", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"labelPlot", "[", 
        RowBox[{"3", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"nPlots", "-", "1"}], ")"}]}]}], "]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "1"}], ",", 
       RowBox[{"AxesOrigin", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"AxesStyle", "\[Rule]", "Gray"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"zoomPlot", "[", 
      RowBox[{"z_", ",", "nextZ_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"incirclePlots", "[", 
        RowBox[{"[", "6", "]"}], "]"}], ",", 
       RowBox[{"tilingPlots", "[", 
        RowBox[{"[", "6", "]"}], "]"}], ",", 
       RowBox[{"labelPlot", "[", 
        RowBox[{
         RowBox[{"3", "/", "z"}], ",", "1"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", 
           RowBox[{"Directive", "[", 
            RowBox[{"Red", ",", "Dashed"}], "]"}], "]"}], ",", "Transparent", 
          ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "#"}], ",", 
                RowBox[{"-", "#"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "#"}], "}"}]}], "]"}], "&"}], "@", 
           "nextZ"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", "z"}], ",", 
       RowBox[{"AxesOrigin", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"AxesStyle", "\[Rule]", "Gray"}], ",", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", 
         RowBox[{"Options", "@", "Graphics"}]}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"figure1", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fanPlot", "[", "1", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "3.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fanPlot", "[", "2", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.4", ",", "2.4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fanPlot", "[", "3", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1.8"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fanPlot", "[", "4", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.4", ",", "1.2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fanPlot", "[", "5", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.6"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fanPlot", "[", "6", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.4", ",", "0.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", ".6"}], ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", ".6"}], ",", "3.6"}], "}"}]}], "}"}]}]}], "]"}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"figure1", "=", 
     RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"fanPlot", "[", "i", "]"}], ",", 
           RowBox[{"fanPlot", "[", 
            RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "5", ",", "2"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Scaled", "[", ".5", "]"}], ",", 
          RowBox[{"Scaled", "[", ".25", "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"zoomList", "=", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Pi"}], "/", "2"}], 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "5"}], "]"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"figure2", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"zoomPlot", "[", 
              RowBox[{
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "3.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"zoomPlot", "[", 
              RowBox[{
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.1", ",", "2.4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"zoomPlot", "[", 
              RowBox[{
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1.8"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"zoomPlot", "[", 
              RowBox[{
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", 
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.1", ",", "1.2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"zoomPlot", "[", 
              RowBox[{
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "5", "]"}], "]"}], ",", 
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "6", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", ".6"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"zoomPlot", "[", 
              RowBox[{
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "6", "]"}], "]"}], ",", "1"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", ".6"}], ",", "1.7"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", ".6"}], ",", "3.6"}], "}"}]}], "}"}]}]}], "]"}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"figure2", "=", 
     RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"zoomPlot", "[", 
            RowBox[{
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"zoomPlot", "[", 
            RowBox[{
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"zoomPlot", "[", 
            RowBox[{
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"zoomPlot", "[", 
            RowBox[{
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", 
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"zoomPlot", "[", 
            RowBox[{
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "6", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Ticks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "#"}], ",", "#"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "#"}], ",", "#"}], "}"}]}], "}"}]}], "&"}], 
              "@", "0.001"}]}], "]"}], ",", 
           RowBox[{"zoomPlot", "[", 
            RowBox[{
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "6", "]"}], "]"}], ",", 
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "7", "]"}], "]"}]}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Scaled", "[", ".5", "]"}], ",", 
          RowBox[{"Scaled", "[", ".25", "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Column", "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"display", "[", 
        RowBox[{
        "figure1", ",", "500", ",", "\"\<modular-tiling-exp-fan.eps\>\""}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"display", "[", 
        RowBox[{
        "figure2", ",", "500", ",", "\"\<modular-tiling-exp-zoom.eps\>\""}], 
        "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.589812295533785*^9, 3.589812328874668*^9}, {
   3.5898125128465433`*^9, 3.589812712836843*^9}, {3.589812767309286*^9, 
   3.589812770607374*^9}, {3.589812832466013*^9, 3.589812963519486*^9}, {
   3.5898130154278617`*^9, 3.58981315047744*^9}, {3.589813212985097*^9, 
   3.589813448188329*^9}, {3.589813478759139*^9, 3.589813758257546*^9}, {
   3.589813793434478*^9, 3.5898138847468977`*^9}, {3.589813943758462*^9, 
   3.589814002878028*^9}, {3.589814053609372*^9, 3.5898141024196663`*^9}, {
   3.5898142686770716`*^9, 3.5898143749668884`*^9}, {3.589814415058951*^9, 
   3.589814420483094*^9}, 3.5898144788396406`*^9, {3.589814765575239*^9, 
   3.5898148698320017`*^9}, {3.5898150423465734`*^9, 
   3.5898150565489497`*^9}, {3.589815183150305*^9, 3.58981522147132*^9}, {
   3.5898152528841524`*^9, 3.5898155046038227`*^9}, {3.589815669359189*^9, 
   3.5898157696198454`*^9}, {3.589815839520698*^9, 3.589815877783712*^9}, {
   3.589815957366821*^9, 3.589815959409875*^9}, {3.5898160167483945`*^9, 
   3.5898163423100214`*^9}, {3.589816444740736*^9, 3.589816479434655*^9}, {
   3.58981651470359*^9, 3.5898165506535425`*^9}, {3.589816606911033*^9, 
   3.5898166075780506`*^9}, {3.5898166406869287`*^9, 3.589816644647033*^9}, {
   3.5898166865361433`*^9, 3.589816716771944*^9}, {3.5898167679042997`*^9, 
   3.58981676906133*^9}, {3.5898169013038344`*^9, 3.5898169107800856`*^9}, {
   3.5898170834696617`*^9, 3.589817202356812*^9}, {3.5898181402836666`*^9, 
   3.589818267543039*^9}, {3.58981833174174*^9, 3.5898186015338893`*^9}, {
   3.589818777057541*^9, 3.589818812666484*^9}, {3.589819050316782*^9, 
   3.589819141019185*^9}, {3.589819307729603*^9, 3.589819415813467*^9}, {
   3.5898195818288665`*^9, 3.589819591919134*^9}, {3.5898197324448576`*^9, 
   3.589819737658996*^9}, {3.5898581696052933`*^9, 3.5898581699328947`*^9}, {
   3.5898585280944614`*^9, 3.5898585553321495`*^9}, {3.5898586685417185`*^9, 
   3.5898586769501457`*^9}, {3.5898587372755423`*^9, 
   3.5898587527663927`*^9}, {3.589858929719175*^9, 3.5898589312011795`*^9}, {
   3.5898590694351764`*^9, 3.589859083447548*^9}, 3.589859284541877*^9, {
   3.589859613606597*^9, 3.589859649136538*^9}, {3.5898600284565897`*^9, 
   3.5898600525342283`*^9}, {3.589860736999366*^9, 3.5898608161584635`*^9}, {
   3.5898617735418334`*^9, 3.5898617794449897`*^9}, {3.5898635478971825`*^9, 
   3.5898635494259872`*^9}, {3.589864631621716*^9, 3.5898646565519996`*^9}, {
   3.5898646950861254`*^9, 3.589864700827944*^9}, {3.5898655232838516`*^9, 
   3.589865527059064*^9}, {3.5898655913800735`*^9, 3.5898657589336195`*^9}, 
   3.5898658181856117`*^9, {3.5898661841538057`*^9, 3.58986618552661*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

The Modular Group and Continued Fractions\
\>", "Subtitle",
 CellChangeTimes->{{3.5918806407576427`*^9, 3.5918806557336454`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "modCayley", ",", "mtList", ",", "mtSublist", ",", "pt", ",", "zs"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"modCayley", "=", 
     RowBox[{"New", "[", 
      RowBox[{"MoebiusTransformation", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"I", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mtList", "=", 
     RowBox[{"ModularGroupList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PSL2ZGrading", "@", 
         RowBox[{"Mat", "@", "#"}]}], "<", "150"}], "&"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mtSublist", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"mtList", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"GDiskMatRadius", "[", 
            RowBox[{"GDiskMatMap", "[", 
             RowBox[{
              RowBox[{"Mat", "@", "gdFord0"}], ",", 
              RowBox[{
               RowBox[{"Mat", "@", "modCayley"}], " ", ".", " ", 
               RowBox[{"Mat", "@", "#"}]}]}], "]"}], "]"}], ">", 
           RowBox[{"1", "/", "30"}]}], "&&", 
          RowBox[{"ModularGroup`Private`fordCriteria", "@", 
           RowBox[{"Mat", "@", "#"}]}]}], ")"}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"zs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", "ComplexInfinity", "]"}], "&"}], "/@", 
      "mtSublist"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"figure", "=", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ModularTiling", "[", 
          RowBox[{"mtList", ",", "modCayley", ",", "\[IndentingNewLine]", 
           RowBox[{"InteriorMode", "\[Rule]", "GDisk"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TilingMode", "\[Rule]", "GCircle"}], ",", 
           RowBox[{"TilingStyle", "\[Rule]", "White"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FordDiskMode", "\[Rule]", "GDisk"}], ",", 
           RowBox[{"FordDiskStyle", "\[Rule]", "LightGray"}], ",", 
           RowBox[{"FordLabelMode", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Inhom", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Mat", "@", "#"}], ")"}], ".", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "/.", 
               RowBox[{"ComplexInfinity", "\[Rule]", "\[Infinity]"}]}], "&"}],
              ")"}]}], ",", 
           RowBox[{"FordLabelThreshold", "\[Rule]", 
            RowBox[{"1", "/", "20"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"IncircleMode", "\[Rule]", "GDisk"}], ",", 
           RowBox[{"IncircleStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"EdgeForm", "[", "Gray", "]"}], ",", "White"}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"LabelMode", "\[Rule]", "TUWord"}], ",", 
           RowBox[{"LabelThreshold", "\[Rule]", 
            RowBox[{"1", "/", "12"}]}], ",", 
           RowBox[{"Magnification", "\[Rule]", "8"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", "z", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"pt", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Re", "@", "#"}], ",", 
                    RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", 
                 RowBox[{"modCayley", "[", "z", "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Point", "[", "pt", "]"}], ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"z", "/.", 
                    RowBox[{"ComplexInfinity", "\[Rule]", "\[Infinity]"}]}], 
                   ",", "pt", ",", 
                   RowBox[{
                    RowBox[{"-", "2"}], "*", "pt"}]}], "]"}]}], "}"}]}]}], 
             "\[IndentingNewLine]", "]"}], "/@", "zs"}]}], 
          "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "1.15"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"display", "[", 
     RowBox[{"figure", ",", "400", ",", "\"\<ford-disks.eps\>\""}], "]"}]}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6006897155665793`*^9, 3.6006899802060633`*^9}, {
   3.600690010376587*^9, 3.6006901133994093`*^9}, {3.6006902039109793`*^9, 
   3.600690357524809*^9}, {3.6006903969149704`*^9, 3.6006904132326374`*^9}, {
   3.6006905992789993`*^9, 3.600690599778201*^9}, {3.6006906553924294`*^9, 
   3.6006906681220813`*^9}, {3.600690715655476*^9, 3.6006907304911366`*^9}, {
   3.6006907825953503`*^9, 3.60069087777134*^9}, {3.6006910109334855`*^9, 
   3.6006910112610865`*^9}, {3.6006910506980486`*^9, 
   3.6006910764381533`*^9}, {3.6006911203835335`*^9, 3.600691372761368*^9}, {
   3.6006914418072505`*^9, 3.6006914726173763`*^9}, {3.600691513770345*^9, 
   3.600691590505062*^9}, {3.600691687116258*^9, 3.6006916874438596`*^9}, {
   3.600691830808447*^9, 3.600691843366498*^9}, {3.600692001051944*^9, 
   3.600692396716365*^9}, {3.600692457868615*^9, 3.60069274462899*^9}, {
   3.600692853221035*^9, 3.600692919490106*^9}, {3.6006929773039427`*^9, 
   3.600693046084625*^9}, {3.6006931537406654`*^9, 3.6006932247521563`*^9}, {
   3.600693564027565*^9, 3.6006935744640083`*^9}, {3.60069364812751*^9, 
   3.6006938363578806`*^9}, 3.600693902751753*^9, {3.6006987900120344`*^9, 
   3.6006988186537523`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MyTicks", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"min_", ",", "max_"}], "}"}], ",", "special_List", ",", 
     "n_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ticks", ",", "spInRange"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"spInRange", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"special", ",", 
         RowBox[{
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{
            RowBox[{"Interval", "[", 
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}], "]"}], ",", "#"}], "]"}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"N", "@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"FindDivisions", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}], ",", "n"}], "]"}], ",", 
           RowBox[{
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"#", "-", "spInRange"}], "]"}], "\[GreaterEqual]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"max", "-", "min"}], ")"}], "/", "n"}]}], "]"}], 
              ")"}]}], "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        "spInRange"}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MyContinuedFraction", "[", 
    RowBox[{"x_", ",", "n_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "c", ",", 
       RowBox[{"t", "=", "x"}], ",", 
       RowBox[{"cs", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "=", "0"}], ";", 
         RowBox[{"c", "=", 
          RowBox[{"Quotient", "[", 
           RowBox[{"t", ",", "1", ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"i", "<", "n"}], "&&", 
         RowBox[{
          RowBox[{"t", "-", "c"}], "\[NotEqual]", "0"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t", "=", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"t", "-", "c"}], ")"}]}]}], ";", 
         RowBox[{"c", "=", 
          RowBox[{"Quotient", "[", 
           RowBox[{"t", ",", "1", ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]}], "]"}]}], ";", 
         RowBox[{"i", "++"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"cs", "=", 
         RowBox[{"{", 
          RowBox[{"cs", ",", "c"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "<", "n"}], ",", 
        RowBox[{"cs", "=", 
         RowBox[{"{", 
          RowBox[{"cs", ",", "c"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "@", "cs"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ModularConvergents", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"quotients", ",", "_Integer", ",", "1"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sgn", ",", "i", ",", "m"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sgn", "=", 
         RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sgn", "*=", 
            RowBox[{"-", "1"}]}], ";", 
           RowBox[{"m", "=", 
            RowBox[{"m", ".", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"sgn", " ", 
                  RowBox[{"quotients", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "}"}]}]}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "quotients", "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "mtList", ",", "number", ",", "quotients", ",", "convergents", ",", 
     "Frame", ",", "plotRange", ",", "figure"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"number", "=", "Pi"}], ";", "\[IndentingNewLine]", 
    RowBox[{"mtList", "=", 
     RowBox[{"ModularGroupList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PSL2ZGrading", "@", 
         RowBox[{"Mat", "@", "#"}]}], "<", "100"}], "&"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"quotients", " ", "=", 
     RowBox[{"MyContinuedFraction", "[", 
      RowBox[{"number", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"convergents", "=", 
     RowBox[{"ModularConvergents", "[", "quotients", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Frame", "[", 
      RowBox[{"m_", ",", "viewCenter_", ",", "zf_"}], "]"}], ":=", 
     RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"plotRange", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"viewCenter", "+", 
            RowBox[{
             SuperscriptBox["GoldenRatio", "2"], 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "zf"}], ",", "zf"}], "}"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"2", "zf"}]}], "}"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ModularTiling", "[", 
           RowBox[{"mtList", ",", "m", ",", "\[IndentingNewLine]", 
            RowBox[{"FordDiskMode", "\[Rule]", "GDisk"}], ",", 
            RowBox[{"FordDiskStyle", "\[Rule]", "LightGray"}], ",", 
            RowBox[{"FordDiskThreshold", "\[Rule]", 
             RowBox[{"zf", "/", "25"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"IncircleMode", "\[Rule]", "GDisk"}], ",", 
            RowBox[{"IncircleStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"White", ",", 
               RowBox[{"EdgeForm", "[", "Gray", "]"}]}], "]"}]}], ",", 
            RowBox[{"IncircleThreshold", "\[Rule]", 
             RowBox[{"zf", "/", "50"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"TilingStyle", "\[Rule]", "Gray"}], ",", " ", 
            RowBox[{"TilingThreshold", "\[Rule]", 
             RowBox[{"zf", "/", "50"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"ExteriorMode", "\[Rule]", "Off"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"LabelMode", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                   RowBox[{
                    RowBox[{"Length", "@", "#"}], "+", "1"}]], 
                  RowBox[{"Last", "@", "#"}]}], "&"}], "@", 
                RowBox[{"TUExponents", "[", 
                 RowBox[{
                  RowBox[{"m", ".", 
                   RowBox[{"Mat", "@", "#"}]}], ",", 
                  RowBox[{
                  "QuotientFunction", "\[Rule]", "CentralQuotient"}]}], 
                 "]"}]}], "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Magnification", "\[Rule]", 
             RowBox[{"2", "/", "zf"}]}], ",", 
            RowBox[{"LabelThreshold", "\[Rule]", 
             RowBox[{
              SuperscriptBox["2", 
               RowBox[{"-", "3"}]], "zf"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"FordLabelMode", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Inhom", "[", 
                RowBox[{"m", ".", 
                 RowBox[{"(", 
                  RowBox[{"Mat", "@", "#"}], ")"}], ".", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "&"}], ")"}]}], 
            ",", 
            RowBox[{"FordLabelThreshold", "\[Rule]", 
             RowBox[{
              SuperscriptBox["2", 
               RowBox[{"-", "3"}]], "zf"}]}]}], "\[IndentingNewLine]", "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Red", ",", "Thick", ",", 
            RowBox[{"GCircle", "[", 
             RowBox[{"gdIncircle0", ",", "convergents"}], "]"}]}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"White", ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"Scaled", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], ",", 
              RowBox[{"Scaled", "@", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}]}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", 
       RowBox[{"AxesOrigin", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"viewCenter", "-", 
           RowBox[{"zf", " ", "GoldenRatio"}]}], ",", "0"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Ticks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"MyTicks", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#1", ",", "#2"}], "}"}], ",", 
             RowBox[{"{", "number", "}"}], ",", "6"}], "]"}], "&"}], ",", 
          "Automatic"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"figure", "=", 
     RowBox[{"GraphicsColumn", "[", 
      RowBox[{"Frame", "@@@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"convergents", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "2", ",", "1"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"convergents", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "Pi", ",", 
           RowBox[{"1", "/", "50"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"convergents", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "Pi", ",", 
           RowBox[{"1", "/", "10000"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"convergents", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "Pi", ",", 
           RowBox[{"1", "/", "25000"}]}], "}"}]}], "\[IndentingNewLine]", 
        "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"display", "[", 
     RowBox[{"figure", ",", "400", ",", "\"\<cont-frac-pi.eps\>\""}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.5918810290729074`*^9, 3.5918811630925303`*^9}, {
  3.5918812150249386`*^9, 3.591881412786172*^9}, {3.5918814430969768`*^9, 
  3.5918814524413786`*^9}, {3.59188152339019*^9, 3.591881613433405*^9}, {
  3.591881660498613*^9, 3.5918818268726406`*^9}, {3.591882011597473*^9, 
  3.5918820116910725`*^9}, {3.5918820910680876`*^9, 3.5918821011144896`*^9}, {
  3.5918897082636147`*^9, 3.591889733551219*^9}, {3.591978222701461*^9, 
  3.5919782270850616`*^9}, {3.6006904942281685`*^9, 3.6006905492651944`*^9}, {
  3.600691851806133*^9, 3.600691864863386*^9}, {3.6006919026311407`*^9, 
  3.600691903161543*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Klein J Invariant Function under modified Cayley Transform\
\>", "Subtitle",
 CellChangeTimes->{{3.5919656126816535`*^9, 3.59196565243046*^9}, {
  3.592158430745759*^9, 3.592158431744159*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"MoebiusTransformation", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"I", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"y_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "=", 
       RowBox[{"Complex", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"z", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Inv", "@", "phi"}], ")"}], "@", "c"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "@", "c"}], "\[GreaterEqual]", "1."}], ",", "0.", ",", 
        RowBox[{"N", "@", 
         RowBox[{"KleinInvariantJ", "@", "z"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"color", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"c", ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lc", ",", "t", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"List", "@@", 
        RowBox[{"ColorConvert", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"c", "===", "ComplexInfinity"}], ",", "White", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"c", "\[Equal]", "0."}], ",", "Black", ",", 
            "\[IndentingNewLine]", "True", ",", 
            RowBox[{
             RowBox[{"lc", "=", 
              RowBox[{"Log", "@", 
               RowBox[{"N", "@", "c"}]}]}], ";", 
             RowBox[{"t", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Im", "@", "lc"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"2", " ", "Pi"}], ")"}]}], ",", "1"}], "]"}]}], ";", 
             RowBox[{"b", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"ArcTan", "@", 
                 RowBox[{"Re", "@", "lc"}]}], "/", "Pi"}], "+", ".5"}]}], ";", 
             RowBox[{"Hue", "[", 
              RowBox[{"t", ",", 
               RowBox[{"1", "-", 
                SuperscriptBox["b", "2"]}], ",", 
               RowBox[{"1", "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "-", "b"}], ")"}], "2"]}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\"\<RGB\>\""}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
     "Listable"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzF1IU2EAh/ExRyp4jnThRZOIzUqRbkSEbgpGa0wLYadjrg1KdEeoDcdK
NjedIBtaKJEkpiYSYUFtqJCoIYXUpH0EbZNdaM02RbDJ0hZ+tFB8/+/Fw+/u
kTWaOUEsEonOkeDu+J3Hss8pRf2/ADUzn/sUsokvQ9CfVb2EtvueN3BnfmgW
fppyR2FV8kQcqkslCShY9RuwNVa8Ccej4jS8eSUvAw2qlTI5Uav8Sb237tPD
C8txqpSzGeDbsINa07H8CJrsCSr3avEJ9G9p+uFJUeUOHFGX/4Vj7uzEeWL4
f+EkPBjjFKXE0cI2ajDWa+eIa64bDigJMCxPLOs5KoJ7q/3V8E8vXwcLDrU6
2D18TQ/11q4G6HzwkDoaCgiwpbXTCAezXUEo346F4MIuI9iIl+u1VF+17C70
TvPU50tyr52Y5q9Tp8KRHCexT8PnwwpBx8COOSkLk317pzvxY6+egSNLljoY
NJ+6BVcyTCN8lqtpghO6r0aY9L8zwYx4wAIN7z1Uh63JRX9crRtOu4Y/QOXZ
go9Ql9qIwJYf7TF4ez/8C7KvX/yGM8y3iyWLKcX3yuZL8BhYCUA8
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"jdata", "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", "=", "513"}], "}"}], ",", 
       RowBox[{"Array", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"Power", "::", "infy"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.59197751081791*^9, {3.591978681013937*^9, 3.5919786811231375`*^9}, {
   3.5919788694463687`*^9, 3.5919788695399685`*^9}, {3.5920668005151825`*^9, 
   3.5920668014043827`*^9}, {3.5920681363434052`*^9, 
   3.5920681494474072`*^9}, {3.5920683115002346`*^9, 
   3.5920683912630477`*^9}, {3.59206948257683*^9, 3.59206948694483*^9}, {
   3.5920698685676937`*^9, 3.592069870923294*^9}, {3.592070017750519*^9, 
   3.592070021322919*^9}, {3.5920709355610714`*^9, 3.5920709456386733`*^9}, {
   3.592141620713451*^9, 3.592141622335851*^9}, {3.5921416578726573`*^9, 
   3.5921416782774606`*^9}, {3.592144575964159*^9, 3.592144576416559*^9}, {
   3.592145560327445*^9, 3.592145560353446*^9}, {3.5921456146429605`*^9, 
   3.592145617166031*^9}, {3.5921456863889627`*^9, 3.592145687162984*^9}, {
   3.5921457795895624`*^9, 3.592145788173802*^9}, {3.592152283095416*^9, 
   3.592152296968803*^9}, {3.592154139694214*^9, 3.5921541412342567`*^9}, {
   3.5921544318943653`*^9, 3.5921544363274894`*^9}, {3.5921567290234537`*^9, 
   3.592156729104456*^9}, {3.5921569475015492`*^9, 3.592156948749584*^9}, {
   3.593016254999075*^9, 3.5930162556074753`*^9}, {3.593018262111311*^9, 
   3.593018263499711*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mtList", "=", 
   RowBox[{"ModularGroupList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PSL2ZGrading", "@", 
       RowBox[{"Mat", "@", "#"}]}], "<", "160"}], "&"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModularPlot", "[", 
    RowBox[{"data_", ",", "mts_"}], "]"}], ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Raster", "[", 
        RowBox[{
         RowBox[{"color", "@", "data"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ModularTiling", "[", 
        RowBox[{"mts", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"I", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", 
         RowBox[{"TilingStyle", "\[Rule]", "Gray"}], ",", 
         RowBox[{"BorderStyle", "\[Rule]", "Gray"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "1"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5919665470906096`*^9, 3.5919665634550123`*^9}, {
   3.5919667684702463`*^9, 3.5919667717306466`*^9}, {3.591967007275086*^9, 
   3.5919670354642906`*^9}, {3.591967248544726*^9, 3.591967248950326*^9}, {
   3.591967284487132*^9, 3.591967297372734*^9}, {3.591967366761546*^9, 
   3.5919673794443483`*^9}, {3.5919674189747543`*^9, 3.591967440362358*^9}, {
   3.5919674734967637`*^9, 3.5919674760551643`*^9}, {3.591967805932819*^9, 
   3.5919678089748197`*^9}, {3.5919685847317486`*^9, 3.591968596150951*^9}, {
   3.5919686502361593`*^9, 3.5919686581765614`*^9}, {3.59197554031496*^9, 
   3.5919755745413656`*^9}, {3.591976271705482*^9, 3.5919762768846827`*^9}, {
   3.5919767870901814`*^9, 3.5919768039381847`*^9}, 3.5919775131111107`*^9, {
   3.591978689266339*^9, 3.59197881759196*^9}, {3.5920660856330624`*^9, 
   3.592066574381144*^9}, {3.5920666391955557`*^9, 3.592066793604381*^9}, {
   3.5920668394059887`*^9, 3.59206684447599*^9}, {3.592066915861602*^9, 
   3.5920669278424034`*^9}, {3.59206696436201*^9, 3.5920669807108126`*^9}, {
   3.592067098381632*^9, 3.5920671078820333`*^9}, {3.592067331835671*^9, 
   3.592067403595683*^9}, {3.5920675058225*^9, 3.5920676050853167`*^9}, {
   3.592067829896954*^9, 3.592067876260162*^9}, {3.592067997752982*^9, 
   3.5920679999213824`*^9}, {3.5920680377669888`*^9, 3.592068081103796*^9}, {
   3.59206846539426*^9, 3.592068531335471*^9}, {3.592069324954403*^9, 
   3.5920693445168066`*^9}, {3.5920693837352133`*^9, 
   3.5920693872920136`*^9}, {3.592069472109228*^9, 3.592069472156028*^9}, 
   3.592070427094587*^9, {3.59214446138214*^9, 3.59214446250534*^9}, {
   3.5921450997495956`*^9, 3.5921451014676437`*^9}, {3.592145647376874*^9, 
   3.5921456516489935`*^9}, {3.5921468756181407`*^9, 3.592146884085377*^9}, {
   3.5921525823837657`*^9, 3.592152623290907*^9}, {3.5921527937006617`*^9, 
   3.5921528228364744`*^9}, {3.592152931863516*^9, 3.592152934407587*^9}, {
   3.5921532258177176`*^9, 3.592153264875807*^9}, {3.5921534119819107`*^9, 
   3.592153742378129*^9}, {3.5921540959369926`*^9, 3.592154117668599*^9}, {
   3.5921544606001663`*^9, 3.5921545570188565`*^9}, {3.5921545959399424`*^9, 
   3.592154596381955*^9}, {3.592155568367072*^9, 3.592155572106177*^9}, {
   3.5921556410601006`*^9, 3.5921557072499475`*^9}, 3.5921558668674*^9, {
   3.5921560841914635`*^9, 3.592156118421418*^9}, {3.592156212443042*^9, 
   3.592156212839053*^9}, {3.5921565065712476`*^9, 3.592156517333548*^9}, {
   3.592156871294423*^9, 3.5921569146386323`*^9}, {3.592157887127063*^9, 
   3.5921578914326634`*^9}, 3.5930165671299267`*^9, {3.593016724210353*^9, 
   3.593016725161954*^9}, {3.5930178979380407`*^9, 3.5930179019160414`*^9}}],

Cell[BoxData[
 RowBox[{"display", "[", 
  RowBox[{
   RowBox[{"ModularPlot", "[", 
    RowBox[{"jdata", ",", "mtList"}], "]"}], ",", "400", ",", 
   "\"\<klein-j.eps\>\""}], "]"}]], "Input",
 CellChangeTimes->{
  3.5921567364456606`*^9, {3.592156919120757*^9, 3.592156935843224*^9}, {
   3.5921571004848175`*^9, 3.5921571158722467`*^9}, {3.5921573110221643`*^9, 
   3.592157311583764*^9}, {3.5930178580322337`*^9, 3.5930179052544413`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mtList2", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"mtList", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"PSL2ZGrading", "@", 
        RowBox[{"Mat", "@", "#"}]}], "<", "100"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jdata2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"jdata", "[", 
      RowBox[{"[", 
       RowBox[{"x", ",", "y"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", 
       RowBox[{"Length", "@", "jdata"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "1", ",", 
       RowBox[{"Length", "@", "jdata"}], ",", "2"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.593017966282652*^9, 3.5930179763602533`*^9}}],

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{
   RowBox[{"display", "[", 
    RowBox[{
     RowBox[{"ModularPlot", "[", 
      RowBox[{
       RowBox[{"1", "/", "jdata2"}], ",", "mtList2"}], "]"}], ",", "200", 
     ",", "\"\<klein-jinv.eps\>\""}], "]"}], ",", 
   RowBox[{"Power", "::", "infy"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.593017929637246*^9, 3.593017961056651*^9}, {
   3.593018621516171*^9, 3.5930186299411726`*^9}, 3.5930186979591837`*^9}],

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{
   RowBox[{"display", "[", 
    RowBox[{
     RowBox[{"ModularPlot", "[", 
      RowBox[{
       RowBox[{"jdata2", "-", "1"}], ",", "mtList2"}], "]"}], ",", "200", 
     ",", "\"\<klein-jm1.eps\>\""}], "]"}], ",", 
   RowBox[{"Power", "::", "infy"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5930179471882486`*^9, 3.5930179526326494`*^9}, {
   3.5930179871398554`*^9, 3.5930180062508583`*^9}, {3.5930186339347734`*^9, 
   3.5930186447299747`*^9}, 3.5930186923899827`*^9}],

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{
   RowBox[{"display", "[", 
    RowBox[{
     RowBox[{"ModularPlot", "[", 
      RowBox[{
       SuperscriptBox["jdata2", "2"], ",", "mtList2"}], "]"}], ",", "200", 
     ",", "\"\<klein-jsqr.eps\>\""}], "]"}], ",", 
   RowBox[{"Power", "::", "infy"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.593018009433259*^9, 3.5930180362964635`*^9}, {
   3.5930186484739757`*^9, 3.5930186547295766`*^9}, 3.5930186890037823`*^9}],

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{
   RowBox[{"display", "[", 
    RowBox[{
     RowBox[{"ModularPlot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"z", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"z", "===", "ComplexInfinity"}], ",", "0.", ",", 
            RowBox[{"2", 
             RowBox[{"z", "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", "z", "-", 
                SuperscriptBox["z", "2"]}], ")"}]}]}]}], "]"}], ",", 
          "Listable"}], "]"}], "@", "jdata2"}], ",", "mtList2"}], "]"}], ",", 
     "200", ",", "\"\<klein-jfib.eps\>\""}], "]"}], ",", 
   RowBox[{"Power", "::", "infy"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.593018037419664*^9, 3.593018058699067*^9}, {
   3.593018656554777*^9, 3.593018664371378*^9}, 3.5930187031851845`*^9}],

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{
   RowBox[{"display", "[", 
    RowBox[{
     RowBox[{"ModularPlot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"z", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"z", "===", "ComplexInfinity"}], ",", "0.", ",", 
            RowBox[{"2", 
             RowBox[{"z", "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", "z", "-", 
                SuperscriptBox["z", "2"]}], ")"}]}]}]}], "]"}], ",", 
          "Listable"}], "]"}], "@", "jdata"}], ",", "mtList"}], "]"}], ",", 
     "400", ",", "\"\<klein-jfib-large.eps\>\""}], "]"}], ",", 
   RowBox[{"Power", "::", "infy"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5921593954051943`*^9, 3.592159399024395*^9}, {
   3.593018089134672*^9, 3.5930181280576787`*^9}, {3.5930186661965785`*^9, 
   3.5930186733101797`*^9}, 3.5930187049479847`*^9, {3.593019144753888*^9, 
   3.5930191461609273`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Nice Generalized Disks under the Modular Group\
\>", "Subtitle",
 CellChangeTimes->{{3.59196559247965*^9, 3.5919656035556517`*^9}, {
  3.5921461250922017`*^9, 3.5921461272512617`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mtList", ",", "gdT", ",", "gdR", ",", "phi", ",", "ts"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gdT", "=", 
     RowBox[{"New", "[", 
      RowBox[{"CompactDisk", ",", " ", 
       RowBox[{
        RowBox[{"Sqrt", "[", "5", "]"}], 
        RowBox[{"I", "/", "2"}]}], ",", 
       RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"gdR", "=", 
     RowBox[{"New", "[", 
      RowBox[{"CompactDisk", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], "+", "I"}], ",", 
       RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"phi", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"I", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"mtList", "=", 
     RowBox[{"ModularGroupList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"GDiskMatRadius", "[", 
         RowBox[{"GDiskMatMap", "[", 
          RowBox[{
           RowBox[{"Mat", "@", "gdT"}], ",", 
           RowBox[{"phi", ".", 
            RowBox[{"Mat", "@", "#"}]}]}], "]"}], "]"}], "\[GreaterEqual]", 
        SuperscriptBox["2", 
         RowBox[{"-", "8"}]]}], "&"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ts", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"phi", ".", 
        RowBox[{"Mat", "@", "#"}]}], "&"}], "/@", "mtList"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{"GCircle", "[", 
           RowBox[{"gdT", ",", "ts"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"GCircle", "[", 
           RowBox[{"gdR", ",", "ts"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ModularTiling", "[", 
         RowBox[{"mtList", ",", "phi", ",", 
          RowBox[{"TilingMode", "\[Rule]", "GCircle"}], ",", 
          RowBox[{"IncircleMode", "\[Rule]", "GCircle"}], ",", 
          RowBox[{"FordDiskMode", "\[Rule]", "GCircle"}], ",", 
          RowBox[{"FordDiskStyle", "\[Rule]", "Brown"}], ",", 
          RowBox[{"IncircleStyle", "\[Rule]", "Gray"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "1"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.58915818222956*^9, 3.589158549501556*^9}, {
   3.58915858450807*^9, 3.589158644755466*^9}, 3.5891587106188803`*^9, {
   3.5891587584642363`*^9, 3.58915876880707*^9}, {3.5891589201275625`*^9, 
   3.589158955196477*^9}, {3.5891590974845405`*^9, 3.5891591006981506`*^9}, {
   3.589205999672281*^9, 3.589206151226774*^9}, {3.589206197371725*^9, 
   3.589206236465452*^9}, {3.589206454429362*^9, 3.5892064558489666`*^9}, {
   3.5892064926650867`*^9, 3.589206530370409*^9}, {3.591880590822035*^9, 
   3.591880591789235*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.591880834291275*^9, 3.5918808347592754`*^9}}]
}, Open  ]]
},
WindowSize->{1028, 641},
WindowMargins->{{35, Automatic}, {Automatic, 4}},
ShowSelection->True,
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 323, 7, 52, "Input",
 InitializationCell->True],
Cell[883, 29, 1699, 38, 152, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[2607, 71, 111, 4, 77, "Subtitle"],
Cell[2721, 77, 7123, 183, 486, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9881, 265, 148, 4, 77, "Subtitle"],
Cell[10032, 271, 19057, 439, 1172, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29126, 715, 109, 4, 77, "Subtitle"],
Cell[29238, 721, 5492, 142, 292, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34767, 868, 117, 4, 77, "Subtitle"],
Cell[34887, 874, 8440, 199, 572, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43364, 1078, 190, 5, 77, "Subtitle"],
Cell[43557, 1085, 18819, 396, 1086, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62413, 1486, 132, 4, 77, "Subtitle"],
Cell[62548, 1492, 13593, 329, 943, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76178, 1826, 142, 4, 77, "Subtitle"],
Cell[76323, 1832, 31712, 802, 2343, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108072, 2639, 140, 4, 77, "Subtitle"],
Cell[108215, 2645, 6122, 138, 512, "Input"],
Cell[114340, 2785, 12644, 320, 1158, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127021, 3110, 203, 5, 77, "Subtitle"],
Cell[127227, 3117, 3550, 91, 327, "Input"],
Cell[130780, 3210, 1924, 41, 31, "Input"],
Cell[132707, 3253, 4040, 76, 112, "Input"],
Cell[136750, 3331, 439, 9, 31, "Input"],
Cell[137192, 3342, 784, 24, 52, "Input"],
Cell[137979, 3368, 461, 11, 31, "Input"],
Cell[138443, 3381, 520, 12, 31, "Input"],
Cell[138966, 3395, 466, 11, 33, "Input"],
Cell[139435, 3408, 868, 22, 55, "Input"],
Cell[140306, 3432, 982, 24, 55, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141325, 3461, 195, 5, 77, "Subtitle"],
Cell[141523, 3468, 3140, 77, 299, "Input"],
Cell[144666, 3547, 94, 1, 31, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
