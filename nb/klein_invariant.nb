(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     15153,        372]
NotebookOptionsPosition[     14558,        350]
NotebookOutlinePosition[     14938,        366]
CellTagsIndexPosition[     14895,        363]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "Moebius", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Moebius", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c_", ",", "d_"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", " ", "#"}], " ", "+", " ", "b"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "#"}], "+", "d"}], ")"}]}], "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5765052645639105`*^9, 3.576505313861231*^9}, 
   3.5765055681809807`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "MyColor", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MyColor", "[", "z_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w", ",", "l", ",", "phi"}], "}"}], ",", 
     RowBox[{
      RowBox[{"w", "=", 
       RowBox[{"Log", "@", "z"}]}], ";", 
      RowBox[{"phi", "=", 
       RowBox[{"Im", "@", "w"}]}], ";", 
      RowBox[{"l", "=", 
       RowBox[{"Re", "@", "w"}]}], ";", 
      RowBox[{"Hue", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"phi", "/", 
          RowBox[{"(", 
           RowBox[{"2", "Pi"}], ")"}]}], "+", 
         RowBox[{"1", "/", "2"}]}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"l", ">", "0"}], ",", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", "l"}], ")"}]}], ",", "1"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"l", "<", "0"}], ",", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "l"}], ")"}]}], ",", "1"}], "]"}]}], "]"}]}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5765484977397947`*^9, 3.576548523309271*^9}, {
   3.5765485569117713`*^9, 3.5765485806716423`*^9}, 3.5765486204049606`*^9, {
   3.5765488146519423`*^9, 3.576548836289207*^9}, {3.576548933166496*^9, 
   3.5765490014342995`*^9}, {3.576549104505807*^9, 3.576549118328448*^9}, {
   3.576549166470191*^9, 3.5765492497774396`*^9}, {3.5765492933649693`*^9, 
   3.57654929345857*^9}, {3.5765493654245844`*^9, 3.576549403207897*^9}, {
   3.576550871716876*^9, 3.5765509080815845`*^9}, {3.5765509834942093`*^9, 
   3.576551008002882*^9}, {3.576551054709421*^9, 3.576551193381235*^9}, {
   3.57655122882454*^9, 3.5765512551126184`*^9}, {3.576551310821385*^9, 
   3.576551319495011*^9}, {3.5765514428309784`*^9, 3.576551462487037*^9}, {
   3.5765514944213324`*^9, 3.5765514947177334`*^9}, {3.5765515819395933`*^9, 
   3.5765515987876434`*^9}, {3.576553138333435*^9, 3.5765531384582353`*^9}, {
   3.576553272286434*^9, 3.5765532980597115`*^9}, {3.576553351041469*^9, 
   3.576553423275685*^9}, {3.5765535730481315`*^9, 3.576553615499858*^9}, {
   3.576553664441204*^9, 3.576553698279705*^9}, {3.576553902953516*^9, 
   3.5765539083511324`*^9}, {3.5765543992389984`*^9, 3.576554404980816*^9}, {
   3.576554476184428*^9, 3.576554479835839*^9}}],

Cell[BoxData[
 RowBox[{"ParametricPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"u", ",", "v"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"u", ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"v", ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
   RowBox[{"Mesh", "\[Rule]", "100"}], ",", 
   RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "u", ",", "v"}], "}"}], ",", 
      RowBox[{"MyColor", "[", 
       RowBox[{"u", "+", 
        RowBox[{"I", " ", "v"}]}], "]"}]}], "]"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.576548756337969*^9, 3.5765488090193253`*^9}, {
  3.576548841078421*^9, 3.5765489001567974`*^9}, {3.5765490689689007`*^9, 
  3.5765490744913173`*^9}, {3.5765491426801205`*^9, 3.5765491522585487`*^9}, {
  3.576549270261301*^9, 3.5765492748633146`*^9}, {3.576549316173238*^9, 
  3.5765493439891205`*^9}, {3.5765513640643435`*^9, 3.5765513684791565`*^9}}],

Cell[BoxData[
 RowBox[{"ParametricPlot3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "phi", "]"}], " ", 
      RowBox[{"Cos", "[", "theta", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "phi", "]"}], " ", 
      RowBox[{"Cos", "[", "theta", "]"}]}], ",", 
     RowBox[{"Sin", "[", "theta", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"phi", ",", 
     RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"theta", ",", 
     RowBox[{
      RowBox[{"-", "Pi"}], "/", "2"}], ",", 
     RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
   RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
   RowBox[{"ColorFunction", "\[Rule]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z", ",", "phi", ",", "theta"}], "}"}], 
      ",", 
      RowBox[{"MyColor", "[", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "phi"}], "]"}], 
        RowBox[{
         RowBox[{"Cos", "[", "theta", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Sin", "[", "theta", "]"}]}], ")"}]}]}], "]"}]}], "]"}]}], 
   ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"Lighting", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5765521880446*^9, 3.576552190603008*^9}, {
   3.5765522333793354`*^9, 3.576552391659407*^9}, {3.576552668848034*^9, 
   3.5765526866164865`*^9}, {3.5765527171155777`*^9, 3.576552734431629*^9}, {
   3.576552868223628*^9, 3.576552892936102*^9}, 3.5765529383394384`*^9, {
   3.576553006907643*^9, 3.57655301935748*^9}, {3.576553067534424*^9, 
   3.5765530738368425`*^9}, {3.5765531128087587`*^9, 3.576553116850171*^9}, {
   3.5765531767281494`*^9, 3.5765531799573593`*^9}, {3.5765540679838085`*^9, 
   3.5765540780936384`*^9}, {3.5765542395827203`*^9, 3.576554251252555*^9}, {
   3.5765543104053335`*^9, 3.576554367506504*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"Ribbon", ",", "InvHypDist"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InvHypDist", "[", "n_", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cosh", "[", 
        RowBox[{"n", "/", "2"}], "]"}], "-", "1"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cosh", "[", 
        RowBox[{"n", "/", "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ribbon", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "w"}], "}"}], ",", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"InvHypDist", "[", "n", "]"}]}], ";", 
      RowBox[{"b", "=", 
       RowBox[{"InvHypDist", "[", 
        RowBox[{"(", 
         RowBox[{"n", "+", "1"}], ")"}], "]"}]}], ";", 
      RowBox[{"w", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "-", "a"}], ")"}], "/", "m"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", " ", 
           RowBox[{"Cos", "[", "phi", "]"}]}], ",", " ", 
          RowBox[{"r", " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "a", ",", "b"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phi", ",", "0", ",", 
          RowBox[{"2", "Pi"}]}], "}"}], ",", 
        RowBox[{"BoundaryStyle", "\[Rule]", "None"}], ",", 
        RowBox[{"MeshStyle", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Mesh", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"a", ",", "b", ",", "w"}], "]"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", 
             RowBox[{"2", "Pi"}], ",", "w"}], "]"}]}], "}"}]}], ",", 
        RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
        RowBox[{"ColorFunction", "\[Rule]", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "r", ",", "phi"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"MyColor", "@", 
            RowBox[{"KleinInvariantJ", "[", 
             RowBox[{
              RowBox[{"Moebius", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "I"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"I", ",", "1"}], "}"}]}], "}"}], "]"}], "[", 
              RowBox[{"r", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", "phi"}], "]"}]}], "]"}], "]"}]}]}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5765080414642572`*^9, 3.5765081607381*^9}, {
   3.576508268248973*^9, 3.5765083397824154`*^9}, {3.5765083761916485`*^9, 
   3.576508380669674*^9}, {3.576508461178486*^9, 3.5765084650745106`*^9}, {
   3.576508559751151*^9, 3.5765086968850336`*^9}, {3.5765088091418176`*^9, 
   3.576508810156844*^9}, {3.5765088572993827`*^9, 3.5765088574113846`*^9}, {
   3.5765089008290625`*^9, 3.576508929082409*^9}, {3.576508972776026*^9, 
   3.5765089731500287`*^9}, 3.576509061641898*^9, {3.57650914871008*^9, 
   3.576509157481311*^9}, {3.576509198808323*^9, 3.5765092315291185`*^9}, 
   3.576509335307318*^9, {3.5765093753121314`*^9, 3.5765093867283497`*^9}, 
   3.57650942305469*^9, {3.576509453089014*^9, 3.5765095745148144`*^9}, {
   3.5765096370582786`*^9, 3.576509655125596*^9}, {3.5765097401022987`*^9, 
   3.576509840768675*^9}, {3.5765101273676987`*^9, 3.5765101597659035`*^9}, {
   3.576510278829609*^9, 3.576510313542837*^9}, {3.5765103470820594`*^9, 
   3.576510372682214*^9}, {3.576510418411477*^9, 3.576510449324689*^9}, {
   3.5765105037923355`*^9, 3.576510525731505*^9}, {3.576510604830225*^9, 
   3.5765106081422625`*^9}, {3.576510734480986*^9, 3.576510764929185*^9}, {
   3.5765115636062183`*^9, 3.5765116401196938`*^9}, {3.5765116921379833`*^9, 
   3.5765117082031813`*^9}, {3.576511749110632*^9, 3.5765117745257893`*^9}, {
   3.576511877844598*^9, 3.5765118897416735`*^9}, {3.5765119797356253`*^9, 
   3.576511983209649*^9}, {3.5765478781105475`*^9, 3.576547884038565*^9}, {
   3.576547950152562*^9, 3.5765480522266665`*^9}, 3.576548129447897*^9, {
   3.5765486263017783`*^9, 3.576548676644128*^9}, {3.576551395468237*^9, 
   3.5765513956398377`*^9}, {3.5765549218549566`*^9, 
   3.5765549556914577`*^9}, {3.5765553174947367`*^9, 
   3.5765553315201783`*^9}, {3.576555570673891*^9, 3.5765556053371944`*^9}}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"n", "\[Rule]", 
    RowBox[{"N", "@", 
     RowBox[{"InvHypDist", "[", "n", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "15"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.576555474434204*^9, 3.5765555426240077`*^9}, {
  3.5765556187532344`*^9, 3.576555623324048*^9}}],

Cell[BoxData[
 RowBox[{"image", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Ribbon", "[", 
       RowBox[{"n", ",", "2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", "12", ",", ".99"}], "}"}]}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.576509837234582*^9, {3.5765104541217184`*^9, 3.5765104876041293`*^9}, {
   3.576510537656577*^9, 3.5765105595367165`*^9}, {3.576510655336756*^9, 
   3.5765106854613175`*^9}, {3.576510844110167*^9, 3.5765108465281816`*^9}, {
   3.5765109212529993`*^9, 3.5765109213250003`*^9}, 3.576510991119465*^9, {
   3.5765110231842365`*^9, 3.5765110239182415`*^9}, {3.5765110576191096`*^9, 
   3.576511064363287*^9}, {3.576511130373741*^9, 3.5765111384267864`*^9}, {
   3.576511936275146*^9, 3.5765119371171513`*^9}, {3.5765119887856855`*^9, 
   3.5765119890596876`*^9}, {3.5765121063690023`*^9, 3.576512106512004*^9}, {
   3.576512346246514*^9, 3.576512351679564*^9}, {3.5765481407423306`*^9, 
   3.576548151054961*^9}, 3.5765481883234725`*^9, {3.576548246777847*^9, 
   3.576548249851056*^9}, {3.576548288508971*^9, 3.5765482885869713`*^9}, {
   3.5765483751994295`*^9, 3.576548393811285*^9}, {3.5765487112460313`*^9, 
   3.5765487113396316`*^9}, {3.576551870062852*^9, 3.5765518728240604`*^9}, 
   3.576554603147607*^9, {3.576554701857101*^9, 3.576554702106702*^9}, {
   3.576554828330678*^9, 3.5765548312166867`*^9}, 3.5765548644301853`*^9, {
   3.5765549093281193`*^9, 3.5765549097181206`*^9}, {3.576555041649714*^9, 
   3.5765550552061543`*^9}, {3.576555149198435*^9, 3.576555149604036*^9}, {
   3.5765551995241847`*^9, 3.5765552357484927`*^9}, {3.576555269835594*^9, 
   3.576555270475196*^9}, 3.5765553118943195`*^9, {3.5765553496786327`*^9, 
   3.576555350957836*^9}, 3.5765555500028296`*^9, {3.576555641155901*^9, 
   3.5765556418423033`*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"image", ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"Axes", "\[Rule]", "True"}], ",", 
   RowBox[{"Frame", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.576555237792099*^9, 3.5765552781036186`*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"image", ",", 
   RowBox[{"Background", "\[Rule]", "Black"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.576555250677737*^9, 3.576555287853648*^9}, {
  3.5765554322818785`*^9, 3.5765554544661446`*^9}}]
},
WindowSize->{1023, 673},
WindowMargins->{{Automatic, -2}, {Automatic, -1}},
Magnification->0.8999999761581421,
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 668, 21, 50, "Input"],
Cell[1228, 43, 2416, 53, 70, "Input"],
Cell[3647, 98, 1132, 26, 50, "Input"],
Cell[4782, 126, 2049, 51, 70, "Input"],
Cell[6834, 179, 4805, 107, 170, "Input"],
Cell[11642, 288, 355, 9, 29, "Input"],
Cell[12000, 299, 1915, 32, 29, "Input"],
Cell[13918, 333, 288, 6, 29, "Input"],
Cell[14209, 341, 345, 7, 29, "Input"]
}
]
*)

(* End of internal cache information *)
