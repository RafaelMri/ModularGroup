(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     48989,       1382]
NotebookOptionsPosition[     45558,       1278]
NotebookOutlinePosition[     46078,       1300]
CellTagsIndexPosition[     45992,       1295]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Package ModularGroup", "Title",
 CellChangeTimes->{{3.5815815119592485`*^9, 3.58158151550146*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"On", "[", "Assert", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5804843126016445`*^9, 3.5804843304169226`*^9}, {
  3.5804862825843325`*^9, 3.5804862832395353`*^9}, {3.5804863643130903`*^9, 
  3.580486365592296*^9}, {3.5804864380234137`*^9, 3.5804864420326314`*^9}, {
  3.581581444727629*^9, 3.5815814795967426`*^9}}],

Cell[CellGroupData[{

Cell["\<\

Moebius Transformations\
\>", "Subtitle",
 CellChangeTimes->{{3.581581535267724*^9, 3.5815815390439367`*^9}, {
  3.581739965394067*^9, 3.5817399944101615`*^9}}],

Cell[BoxData[
 RowBox[{"?", "MoebiusTransformation"}]], "Input",
 CellChangeTimes->{{3.5815033554581327`*^9, 3.5815033676115723`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"MoebiusTransformation", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"I", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.581581544581955*^9, 3.5815815727732463`*^9}, {
  3.581583073447138*^9, 3.5815831217332945`*^9}}],

Cell["\<\
Evaluation for complex numbers:\
\>", "Text",
 CellChangeTimes->{{3.581583130719924*^9, 3.581583131983528*^9}, {
  3.581583369473303*^9, 3.5815833987575984`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"phi", "[", "#", "]"}], " ", "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"\"\<z\>\"", ",", " ", "I", ",", " ", 
    RowBox[{"-", "I"}], ",", " ", "ComplexInfinity"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.5815833078101015`*^9, 3.581583334214188*^9}, {
  3.581583406354823*^9, 3.581583431597705*^9}}],

Cell["\<\
Evaluation for homogeneos representation of complex numbers:\
\>", "Text",
 CellChangeTimes->{{3.581583682826324*^9, 3.581583707148803*^9}}],

Cell[BoxData[{
 RowBox[{"hom", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"phi", "[", "#", "]"}], " ", "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<z\>\"", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"I", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "I"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Inhom", "[", "#", "]"}], "&"}], "/@", "hom"}]}], "Input",
 CellChangeTimes->{{3.5815835936328335`*^9, 3.581583673262493*^9}}],

Cell["\<\
Composition of transformations:\
\>", "Text",
 CellChangeTimes->{{3.5815837390841074`*^9, 3.581583742430319*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"psi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"MoebiusTransformation", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"composition", "=", 
   RowBox[{"phi", "@", "psi"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"composition", "[", 
    RowBox[{"1", "+", "I"}], "]"}], ",", 
   RowBox[{"phi", "[", 
    RowBox[{"psi", "[", 
     RowBox[{"1", "+", "I"}], "]"}], "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.5815849350366063`*^9, 3.5815849497796545`*^9}, {
  3.581585043060358*^9, 3.5815851319874487`*^9}, {3.5815852550974493`*^9, 
  3.581585308188423*^9}, {3.581585443827265*^9, 3.581585489437214*^9}, {
  3.5815863862459354`*^9, 3.581586386573537*^9}, {3.5816070389539514`*^9, 
  3.5816070440707684`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"composition", "[", "\"\<z\>\"", "]"}], "\[Equal]", 
   RowBox[{"phi", "[", 
    RowBox[{"psi", "[", "\"\<z\>\"", "]"}], "]"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.5816070460529747`*^9, 3.5816070473009787`*^9}}],

Cell[BoxData[
 RowBox[{"?", "Mat"}]], "Input",
 CellChangeTimes->{{3.5815862089061575`*^9, 3.5815862109497643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Mat", "[", "phi", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.581586216675983*^9, 3.5815862184543886`*^9}, {
  3.581606730986747*^9, 3.5816067327339525`*^9}}],

Cell[BoxData[
 RowBox[{"?", "Inv"}]], "Input",
 CellChangeTimes->{{3.5815862222608013`*^9, 3.5815862274878182`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"phi", "[", "\"\<z\>\"", "]"}], ",", 
   RowBox[{
    RowBox[{"Inv", "[", "phi", "]"}], "[", "\"\<z\>\"", "]"}]}], 
  "}"}]], "Input",
 CellChangeTimes->{{3.581586234445441*^9, 3.5815862509678946`*^9}, {
  3.5815862836052012`*^9, 3.581586291031825*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Inv", "[", "phi", "]"}], "@", 
    RowBox[{"phi", "@", "\"\<z\>\""}]}], " ", "\[Equal]", 
   RowBox[{"phi", "@", 
    RowBox[{
     RowBox[{"Inv", "[", "phi", "]"}], "@", "\"\<z\>\""}]}], "\[Equal]", 
   "\"\<z\>\""}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.58158630794328*^9, 3.5815863650746665`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Modular Transformations\
\>", "Subtitle",
 CellChangeTimes->{{3.581581629687232*^9, 3.5815816337744455`*^9}, {
  3.5817399858925333`*^9, 3.581739988809743*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "ModularTransformation"}]], "Input",
 CellChangeTimes->{{3.58150337928141*^9, 3.581503384569827*^9}}],

Cell[BoxData[
 StyleBox[
  "\"\<New[ModularTransformation, {{a, b}, {c, d}}] creates the modular \
transformation z \[RightTeeArrow] \
\!\(\*FractionBox[\(\(a\[CenterDot]z\)\(\\\\\\\ \)\(+\)\(\\\\\\\ \
\)\(b\)\(\\\\\\\ \)\), \(c\[CenterDot]z\\\\\\\  + \\\\\\\ d\)]\).\\\\n\>\"", 
  "MSG"]], "Print", "PrintUsage",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.5816071475539055`*^9, 3.581607158867756*^9}},
 CellTags->"Info3581614347-3048158"]
}, Open  ]],

Cell["\<\
ModularTransformations are MoebiusTransformations:\
\>", "Text",
 CellChangeTimes->{{3.581607765054337*^9, 3.5816077730103626`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"ModularTransformation", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8"}], ",", 
         RowBox[{"-", "3"}]}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InstanceQ", "[", "MoebiusTransformation", "]"}], "[", "phi", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.5816071529057226`*^9, 3.581607261491295*^9}, {
  3.581608546053294*^9, 3.581608599659069*^9}}],

Cell["\<\
Some MoebiusTransformations are ModularTransformations:\
\>", "Text",
 CellChangeTimes->{{3.5816073368143406`*^9, 3.5816073610276194`*^9}, {
  3.5816073942577276`*^9, 3.5816074121207857`*^9}, {3.5816077821373925`*^9, 
  3.581607786879808*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"psi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"MoebiusTransformation", ",", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"Sqrt", "[", "2", "]"}]}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "I"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "I"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Mat", "[", "psi", "]"}], "//", "MatrixForm"}], ",", 
   RowBox[{
    RowBox[{"InstanceQ", "[", "ModularTransformation", "]"}], "[", "psi", 
    "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.581607363305227*^9, 3.581607377471073*^9}, {
   3.581607415054596*^9, 3.5816074457586966`*^9}, {3.5816075079766994`*^9, 
   3.581607560849272*^9}, {3.581607625001681*^9, 3.581607644752345*^9}, {
   3.581607675924247*^9, 3.5816076826166687`*^9}, 3.581608101744034*^9, {
   3.581608144959175*^9, 3.5816081538366036`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"psiSqr", "=", 
   RowBox[{"psi", "@", "psi"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Mat", "[", "psiSqr", "]"}], "//", "MatrixForm"}], ",", " ", 
   RowBox[{
    RowBox[{"InstanceQ", "[", "ModularTransformation", "]"}], "[", "psiSqr", 
    "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.5816075651080856`*^9, 3.5816076016776047`*^9}}],

Cell["\<\
There are some predifined ModularTransformations:\
\>", "Text",
 CellChangeTimes->{{3.581608688711159*^9, 3.581608696245185*^9}, {
  3.5816088518160925`*^9, 3.5816088535476985`*^9}}],

Cell[BoxData[{
 RowBox[{"?", "mtId"}], "\[IndentingNewLine]", 
 RowBox[{"?", "mtU"}], "\[IndentingNewLine]", 
 RowBox[{"?", "mtT"}], "\[IndentingNewLine]", 
 RowBox[{"?", "mtR"}]}], "Input",
 CellChangeTimes->{{3.5816086983667917`*^9, 3.5816086997395964`*^9}, {
  3.581741061968438*^9, 3.581741072233271*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"mtId", "[", "\"\<z\>\"", "]"}], ",", 
   RowBox[{"mtU", "[", "\"\<z\>\"", "]"}], ",", 
   RowBox[{"mtT", "[", "\"\<z\>\"", "]"}], ",", 
   RowBox[{"mtR", "[", "\"\<z\>\"", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.581608743422738*^9, 3.5816087670228167`*^9}, {
  3.581608809567155*^9, 3.581608824826005*^9}}],

Cell["\<\
Finding a group word representations of a ModularTransformation:\
\>", "Text",
 CellChangeTimes->{{3.581609088767665*^9, 3.5816091062407217`*^9}, {
  3.581738333131895*^9, 3.581738342460726*^9}}],

Cell[BoxData[
 RowBox[{"?", "TUWord"}]], "Input",
 CellChangeTimes->{{3.5816082939672604`*^9, 3.581608295480465*^9}}],

Cell[BoxData[
 RowBox[{"TUWord", "[", "phi", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"?", "QuotientFunction"}]], "Input",
 CellChangeTimes->{{3.5816093570773387`*^9, 3.5816093593559465`*^9}}],

Cell[BoxData[{
 RowBox[{"?", "CentralQuotient"}], "\[IndentingNewLine]", 
 RowBox[{"?", "CQuotient"}]}], "Input",
 CellChangeTimes->{{3.5816093711339846`*^9, 3.5816093750505977`*^9}, {
  3.581741100094962*^9, 3.5817411039013743`*^9}}],

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", 
       RowBox[{"TUWord", "[", 
        RowBox[{"phi", ",", 
         RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"f", ",", 
       RowBox[{"{", 
        RowBox[{"Quotient", ",", "CentralQuotient", ",", "CQuotient"}], 
        "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5816093862212343`*^9, 3.5816094401078095`*^9}, {
  3.5816099252761903`*^9, 3.5816099401308393`*^9}}],

Cell["\<\
Sometimes the list of exponents of the U\[CloseCurlyQuote]s is more useful:\
\>", "Text",
 CellChangeTimes->{{3.5816094988460007`*^9, 3.581609525617688*^9}}],

Cell[BoxData[
 RowBox[{"?", "TUExponents"}]], "Input",
 CellChangeTimes->{{3.581609111155738*^9, 3.5816091138701468`*^9}}],

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", 
       RowBox[{"TUExponents", "[", 
        RowBox[{"phi", ",", 
         RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"f", ",", 
       RowBox[{"{", 
        RowBox[{"Quotient", ",", "CentralQuotient", ",", "CQuotient"}], 
        "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.581609531358507*^9, 3.581609553668579*^9}, {
  3.5816097783741117`*^9, 3.581609854040358*^9}, {3.5816098946970906`*^9, 
  3.581609912014147*^9}}],

Cell["\<\
TUEval can be used for evaluating group words:\
\>", "Text",
 CellChangeTimes->{{3.581609659210923*^9, 3.58160966426634*^9}, {
  3.581610103413971*^9, 3.581610106892782*^9}, {3.5816101376736827`*^9, 
  3.5816101391556873`*^9}, {3.5817411392666893`*^9, 3.5817411475503163`*^9}}],

Cell[BoxData[
 RowBox[{"?", "TUEval"}]], "Input",
 CellChangeTimes->{{3.581609186774184*^9, 3.5816091957296133`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"factors", ",", "word", ",", "phi"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"ModularTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"13", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "8"}], ",", 
            RowBox[{"-", "3"}]}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"word", "=", 
         RowBox[{"TUWord", "[", 
          RowBox[{"phi", ",", 
           RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"factors", "=", 
         RowBox[{"TUEval", "[", 
          RowBox[{"phi", ",", 
           RowBox[{"Mat", "[", "mtT", "]"}], ",", 
           RowBox[{"Mat", "[", "mtU", "]"}], ",", "List", ",", "MatrixPower", 
           ",", 
           RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Row", "@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"word", ",", "\"\< = \>\"", ",", " ", "\[IndentingNewLine]", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MatrixForm", "[", "#", "]"}], "&"}], "/@", 
               "factors"}], ",", "\"\<\[CenterDot]\>\""}], "]"}]}], ",", " ", 
           "\"\< = \>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"Dot", "@@", "factors"}], "]"}]}], "\[IndentingNewLine]", 
          "}"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f", ",", "Quotient"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Quotient", ",", "CentralQuotient", ",", "CQuotient"}], 
          "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.581610325686096*^9, 3.5816105768035145`*^9}, 
   3.581610614964239*^9, {3.581610781331382*^9, 3.5816108756718893`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Generalized Circles\
\>", "Subtitle",
 CellChangeTimes->{{3.5817399431483946`*^9, 3.5817399477036095`*^9}}],

Cell[BoxData[
 RowBox[{"?", "GeneralizedDisk"}]], "Input",
 CellChangeTimes->{{3.5817400071242027`*^9, 3.581740009947812*^9}}],

Cell["\<\
There are some convenience functions for creating GeneralizedDisks:\
\>", "Text",
 CellChangeTimes->{{3.5817406748063774`*^9, 3.5817407104368935`*^9}, {
  3.581740880524247*^9, 3.5817409199143753`*^9}}],

Cell[BoxData[{
 RowBox[{"?", "CompactDisk"}], "\[IndentingNewLine]", 
 RowBox[{"?", "NoncompactDisk"}], "\[IndentingNewLine]", 
 RowBox[{"?", "Halfplane"}]}], "Input",
 CellChangeTimes->{{3.581740724289738*^9, 3.581740727706149*^9}, {
  3.5817410348711495`*^9, 3.581741042296774*^9}}],

Cell["\<\
CompactDisks are identified by their radius and center, Noncompact disks by \
their \[OpenCurlyDoubleQuote]coradius\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]cocenter\[CloseCurlyDoubleQuote]:\
\>", "Text",
 CellChangeTimes->{{3.581760835542945*^9, 3.5817609744769974`*^9}}],

Cell[BoxData[{
 RowBox[{"?", "GDiskRadius"}], "\[IndentingNewLine]", 
 RowBox[{"?", "GDiskCenter"}], "\[IndentingNewLine]", 
 RowBox[{"?", "GDiskCoradius"}], "\[IndentingNewLine]", 
 RowBox[{"?", "GDiskCocenter"}]}], "Input",
 CellChangeTimes->{{3.581760975818602*^9, 3.581761009218311*^9}}],

Cell["\<\
Predifined GeneralizedDisks are:\
\>", "Text",
 CellChangeTimes->{{3.5817409420664473`*^9, 3.5817409507868757`*^9}}],

Cell[BoxData[{
 RowBox[{"?", "gdUnitDisk"}], "\[IndentingNewLine]", 
 RowBox[{"?", "gdUpperHalfplane"}], "\[IndentingNewLine]", 
 RowBox[{"?", "gdLowerHalfplane"}], "\[IndentingNewLine]", 
 RowBox[{"?", "gdRightHalfplane"}], "\[IndentingNewLine]", 
 RowBox[{"?", "gdLeftHalfplane"}]}], "Input",
 CellChangeTimes->{{3.5817409525964813`*^9, 3.5817409583997006`*^9}, {
  3.5817410253395185`*^9, 3.5817410295671325`*^9}, {3.581741187002845*^9, 
  3.5817412013392916`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"GDiskCenter", "[", "gdUnitDisk", "]"}], ",", 
   RowBox[{"GDiskRadius", "[", "gdUnitDisk", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.5817611233482823`*^9, 3.5817611405707383`*^9}}],

Cell["\<\
Testing if a GeneralizedDisk contains a given point:\
\>", "Text",
 CellChangeTimes->{{3.581742171314456*^9, 3.581742195541335*^9}, {
   3.5817422334650583`*^9, 3.581742245227496*^9}, 3.5817611884316945`*^9}],

Cell[BoxData[
 RowBox[{"?", "InteriorQ"}]], "Input",
 CellChangeTimes->{{3.581742246959102*^9, 3.581742250375513*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InteriorQ", "[", 
    RowBox[{"gdUnitDisk", ",", "#"}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "2", ",", "ComplexInfinity"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.5817401192105675`*^9, 3.581740162329108*^9}, 
   3.581741018693897*^9, 3.581741173477601*^9, {3.5817423917275734`*^9, 
   3.5817424007132025`*^9}, {3.581743048957714*^9, 3.5817430783170094`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InteriorQ", "[", 
    RowBox[{"gdUnitDisk", ",", "#"}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.5817612017697372`*^9, 3.5817612215350018`*^9}}],

Cell["\<\
For drawing GeneralizedDisks, RegionPlot in conjunction with InteriorQ may be \
used:\
\>", "Text",
 CellChangeTimes->{{3.5817612678671527`*^9, 3.5817612910332284`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "disk", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"disk", "[", "\"\<Unit disk\>\"", "]"}], "=", "gdUnitDisk"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"disk", "[", "\"\<Upper half\>\"", "]"}], "=", 
     "gdUpperHalfplane"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"disk", "[", "\"\<Lower half\>\"", "]"}], "=", 
     "gdLowerHalfplane"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"disk", "[", "\"\<Right half\>\"", "]"}], "=", 
     "gdRightHalfplane"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"disk", "[", "\"\<Left half\>\"", "]"}], "=", 
     "gdLeftHalfplane"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{"InteriorQ", "[", 
         RowBox[{
          RowBox[{"disk", "[", "Selection", "]"}], ",", 
          RowBox[{"x", "+", 
           RowBox[{"I", " ", "y"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "False"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Selection", ",", " ", "\"\<Unit disk\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Unit disk\>\"", ",", "\"\<Upper half\>\"", ",", 
          "\"\<Lower half\>\"", ",", "\"\<Right half\>\"", ",", 
          "\"\<Left half\>\""}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.581742406812823*^9, 3.5817427759880247`*^9}, {
  3.581761315634508*^9, 3.581761318224117*^9}}],

Cell["\<\
Generalized circles can be transformed by MoebiusTransformations, e.g. the \
upper halfplane can be transformed to the unit disk:\
\>", "Text",
 CellChangeTimes->{{3.5817431526980515`*^9, 3.5817431668004975`*^9}, {
  3.5817613580042467`*^9, 3.5817613704374866`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"MoebiusTransformation", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"I", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"disk", "=", 
   RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InteriorQ", "[", 
   RowBox[{"disk", ",", "\"\<z\>\""}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.581743169998508*^9, 3.58174326572042*^9}, {
  3.581743877554412*^9, 3.5817439132473283`*^9}, {3.5817614035563946`*^9, 
  3.581761479435042*^9}}],

Cell["\<\
Continuous animation of the above transformation and its powers up to 4:\
\>", "Text",
 CellChangeTimes->{{3.581743445698206*^9, 3.58174348997115*^9}, {
  3.581744333637497*^9, 3.581744348582346*^9}, {3.581761486455065*^9, 
  3.5817615106507435`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"phi", ",", "disk"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"phi", "=", 
       RowBox[{"New", "[", 
        RowBox[{"MoebiusTransformation", ",", 
         RowBox[{"MatrixPower", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"I", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", "t"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"disk", "=", 
       RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Superscript", "[", 
          RowBox[{"\"\<\[Phi]\>\"", ",", "t"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RegionPlot", "[", 
          RowBox[{
           RowBox[{"InteriorQ", "[", 
            RowBox[{"disk", ",", 
             RowBox[{"x", "+", 
              RowBox[{"I", " ", "y"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
           RowBox[{"Frame", "\[Rule]", "False"}], ",", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.5817434914531546`*^9, 3.5817436525860796`*^9}, {
  3.581743960780683*^9, 3.5817439609054832`*^9}, {3.5817440476261663`*^9, 
  3.5817441638621445`*^9}, {3.581744194485044*^9, 3.581744208790291*^9}, {
  3.58174423931959*^9, 3.581744302125395*^9}}],

Cell["\<\
The above transformation can be thought of a simple rotation of the \
Riemannian sphere:\
\>", "Text",
 CellChangeTimes->{{3.5817590643599777`*^9, 3.581759093890874*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "phi", ",", "disk", ",", "cone", ",", "halfSphere", ",", "regionPlot"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"halfSphere", "=", 
     RowBox[{
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "phi", "]"}], 
           RowBox[{"Cos", "[", "theta", "]"}]}], ",", 
          RowBox[{"Sin", "[", "theta", "]"}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", "phi", "]"}]}], 
           RowBox[{"Cos", "[", "theta", "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phi", ",", 
          RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"theta", ",", "0", ",", 
          RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
        RowBox[{"Mesh", "\[Rule]", "False"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Lighter", "@", "Blue"}], "}"}]}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"phi", "=", 
        RowBox[{"New", "[", 
         RowBox[{"MoebiusTransformation", ",", 
          RowBox[{"MatrixPower", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"I", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", "t"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"disk", "=", 
        RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cone", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"showProjection", "&&", 
          RowBox[{
           RowBox[{"InstanceQ", "[", "CompactDisk", "]"}], "[", "disk", 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cone", "=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"c", "=", 
               RowBox[{"GDiskCenter", "[", "disk", "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"GeometricTransformation", "[", 
              RowBox[{
               RowBox[{"Cone", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "2"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
                 RowBox[{"2", " ", 
                  RowBox[{"GDiskRadius", "[", "disk", "]"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", 
                    RowBox[{"-", 
                    RowBox[{"Re", "[", "c", "]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", 
                    RowBox[{"-", 
                    RowBox[{"Im", "[", "c", "]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
              "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"regionPlot", "=", 
        RowBox[{"RegionPlot", "[", 
         RowBox[{
          RowBox[{"InteriorQ", "[", 
           RowBox[{"disk", ",", 
            RowBox[{"x", "+", 
             RowBox[{"I", " ", "y"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Re[z]\>\"", ",", "\"\<Im[z]\>\""}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "False"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Column", "@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Superscript", "[", 
           RowBox[{"\"\<\[Phi]\>\"", ",", "t"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GraphicsRow", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"regionPlot", ",", "\[IndentingNewLine]", 
              RowBox[{"Graphics3D", "[", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Rotate", "[", 
                   RowBox[{"halfSphere", ",", 
                    RowBox[{"Pi", " ", 
                    RowBox[{"t", "/", "2"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"regionPlot", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x_Real", ",", "y_Real"}], "}"}], "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "0"}], "}"}]}]}], ")"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"PointSize", "\[Rule]", "Large"}], ",", "Red", 
                    ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Opacity", "[", "0.25", "]"}], ",", "Yellow", ",", 
                    RowBox[{"EdgeForm", "[", "]"}], ",", "cone"}], "}"}]}], 
                 "\[IndentingNewLine]", "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "2"}], ",", 
                RowBox[{"Axes", "\[Rule]", "True"}], ",", 
                RowBox[{"AxesLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Re[z]\>\"", ",", "\"\<Im[z]\>\"", ",", "\"\<\>\""}], 
                  "}"}]}], ",", 
                RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
                RowBox[{"ViewPoint", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"5", ",", 
                   RowBox[{"-", "2"}], ",", "2"}], "}"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "showProjection", ",", "True", ",", "\"\<Show projection\>\""}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.581759118538954*^9, 3.581759124435773*^9}, {
   3.5817591552614737`*^9, 3.5817592511393857`*^9}, {3.581759570675226*^9, 
   3.581759574606439*^9}, {3.5817596371782427`*^9, 3.5817596375214443`*^9}, {
   3.581759739233775*^9, 3.581759760652645*^9}, {3.5817598600405684`*^9, 
   3.581759863831381*^9}, {3.5817599130339413`*^9, 3.581759928275191*^9}, {
   3.5817599676497188`*^9, 3.581760071748858*^9}, {3.5817601110453863`*^9, 
   3.581760111138986*^9}, {3.58176037641785*^9, 3.581760376823451*^9}, {
   3.581768125331362*^9, 3.5817684128402987`*^9}, {3.581768448720415*^9, 
   3.5817684619960585`*^9}, {3.5817686776043606`*^9, 3.5817688575041466`*^9}, 
   3.5817693477825427`*^9, {3.5817800798912587`*^9, 3.581780088611687*^9}}],

Cell[BoxData[
 RowBox[{"?", "Circle"}]], "Input",
 CellChangeTimes->{{3.581769957401328*^9, 3.581770017851525*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Selftests\
\>", "Subtitle",
 CellChangeTimes->{{3.581611200583548*^9, 3.5816112029079556`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"phi", ",", "result", ",", "inf"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"MoebiusTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"I", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"InstanceQ", "[", "MoebiusTransformation", "]"}], "[", "phi", 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"I", ",", 
         RowBox[{"-", "I"}], ",", "ComplexInfinity"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"result", "/.", 
       RowBox[{"ComplexInfinity", "\[Rule]", "inf"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"result", "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "inf", ",", "I"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"I", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "I"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Inhom", "[", "#", "]"}], "&"}], "/@", "result"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"result", "/.", 
       RowBox[{"ComplexInfinity", " ", "\[Rule]", "inf"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"result", "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "inf", ",", "I"}], "}"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5815838074719305`*^9, 3.581583846475058*^9}, {
  3.581583887880593*^9, 3.5815840769004097`*^9}, {3.5815841663425016`*^9, 
  3.581584209276841*^9}, {3.581584253756586*^9, 3.581584257392398*^9}, {
  3.5815843188459983`*^9, 3.5815843206712046`*^9}, {3.581584368848161*^9, 
  3.5815843759773846`*^9}, {3.5815844093800936`*^9, 3.5815844168691177`*^9}, {
  3.581584461738864*^9, 3.5815846665533314`*^9}, {3.581584717039096*^9, 
  3.581584763515647*^9}, {3.5815848331914744`*^9, 3.5815848383862915`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"phi", ",", "psi"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"MoebiusTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"I", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"psi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"MoebiusTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"phi", "@", "psi"}], ")"}], "@", "\"\<z\>\""}], "\[Equal]", 
        RowBox[{"phi", "@", 
         RowBox[{"(", 
          RowBox[{"psi", "@", "\"\<z\>\""}], ")"}]}]}], "//", "Simplify"}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5815853314968987`*^9, 3.581585421485992*^9}, {
  3.581586424733261*^9, 3.581586425654664*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "phi", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"MoebiusTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"I", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"InstanceQ", "[", "MoebiusTransformation", "]"}], "[", "phi", 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"!", 
       RowBox[{
        RowBox[{"InstanceQ", "[", "ModularTransformation", "]"}], "[", "phi", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Mat", "[", "phi", "]"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"I", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Inv", "@", 
        RowBox[{"Inv", "@", "phi"}]}], "===", "phi"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Inv", "@", 
        RowBox[{"Inv", "@", 
         RowBox[{"Inv", "@", "phi"}]}]}], "===", 
       RowBox[{"Inv", "@", "phi"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "@", 
         RowBox[{
          RowBox[{"Inv", "[", "phi", "]"}], "@", "\"\<z\>\""}]}], "\[Equal]", 
        RowBox[{
         RowBox[{"Inv", "[", "phi", "]"}], "@", 
         RowBox[{"phi", "@", "\"\<z\>\""}]}], "\[Equal]", "\"\<z\>\""}], "//",
        "Simplify"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.580486467070741*^9, 3.5804865873316684`*^9}, {
  3.580486619421009*^9, 3.5804866333674707`*^9}, {3.5804868051398234`*^9, 
  3.580486824125107*^9}, {3.5804868773993406`*^9, 3.580486878896947*^9}, {
  3.5816113088871007`*^9, 3.5816113091835017`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "phi", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"MoebiusTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"7", ",", "5"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"InstanceQ", "[", "MoebiusTransformation", "]"}], "[", "phi", 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"InstanceQ", "[", "ModularTransformation", "]"}], "[", "phi", 
       "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5804865936964965`*^9, 3.580486736109521*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CentralQuotient", "[", 
       RowBox[{"i", ",", "5"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
      ",", "1", ",", "1", ",", "1"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5816115862156043`*^9, 3.5816116829741197`*^9}, 
   3.5816117411415095`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CQuotient", "[", 
       RowBox[{"i", ",", "5"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}], "\[Equal]", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5816116868897324`*^9, 3.5816117434201174`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "disks", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"disks", "=", 
      RowBox[{"{", 
       RowBox[{"gdUnitDisk", ",", " ", 
        RowBox[{"New", "[", 
         RowBox[{"NoncompactDisk", ",", "0", ",", "1"}], "]"}], ",", 
        "gdUpperHalfplane"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"InteriorQ", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}], "/@", "disks"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False", ",", "True"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"InteriorQ", "[", 
          RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "disks"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"False", ",", "True", ",", "True"}], "}"}]}], "]"}], ";", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"InteriorQ", "[", 
          RowBox[{"#", ",", "I"}], "]"}], "&"}], "/@", "disks"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"InteriorQ", "[", 
          RowBox[{"#", ",", 
           RowBox[{"-", "I"}]}], "]"}], "&"}], "/@", "disks"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "False"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"InteriorQ", "[", 
          RowBox[{"#", ",", "ComplexInfinity"}], "]"}], "&"}], "/@", 
        "disks"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"False", ",", "True", ",", "True"}], "}"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5817415559440465`*^9, 3.581741979340231*^9}, {
  3.5817421303799224`*^9, 3.581742137025544*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"phi", ",", "disk", ",", "expectedType"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"expectedType", "=", 
      RowBox[{"{", 
       RowBox[{
       "Halfplane", ",", "CompactDisk", ",", "Halfplane", ",", 
        "NoncompactDisk", ",", "Halfplane"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "=", 
         RowBox[{"New", "[", 
          RowBox[{"MoebiusTransformation", ",", 
           RowBox[{"MatrixPower", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"I", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", "i"}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"disk", "=", 
         RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Assert", "[", 
         RowBox[{
          RowBox[{"InstanceQ", "[", 
           RowBox[{"expectedType", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}], "[", "disk", "]"}],
          "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.581760502981062*^9, 3.5817607708651342`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Off", "[", "Assert", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5804877427507343`*^9, 3.580487744950344*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{812, 634},
WindowMargins->{{188, Automatic}, {Automatic, -1}},
ShowSelection->True,
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3581614347-3048158"->{
  Cell[6111, 200, 468, 10, 60, "Print",
   CellTags->"Info3581614347-3048158"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3581614347-3048158", 45888, 1289}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 104, 1, 90, "Title"],
Cell[686, 25, 455, 9, 52, "Input"],
Cell[CellGroupData[{
Cell[1166, 38, 171, 5, 77, "Subtitle"],
Cell[1340, 45, 134, 2, 31, "Input"],
Cell[1477, 49, 431, 12, 31, "Input"],
Cell[1911, 63, 172, 4, 30, "Text"],
Cell[2086, 69, 345, 8, 31, "Input"],
Cell[2434, 79, 150, 3, 30, "Text"],
Cell[2587, 84, 617, 19, 52, "Input"],
Cell[3207, 105, 123, 3, 30, "Text"],
Cell[3333, 110, 996, 27, 72, "Input"],
Cell[4332, 139, 278, 7, 31, "Input"],
Cell[4613, 148, 116, 2, 31, "Input"],
Cell[4732, 152, 210, 4, 31, "Input"],
Cell[4945, 158, 116, 2, 31, "Input"],
Cell[5064, 162, 304, 8, 31, "Input"],
Cell[5371, 172, 375, 10, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5783, 187, 171, 5, 77, "Subtitle"],
Cell[CellGroupData[{
Cell[5979, 196, 129, 2, 31, "Input"],
Cell[6111, 200, 468, 10, 60, "Print",
 CellTags->"Info3581614347-3048158"]
}, Open  ]],
Cell[6594, 213, 142, 3, 30, "Text"],
Cell[6739, 218, 601, 18, 52, "Input"],
Cell[7343, 238, 253, 5, 30, "Text"],
Cell[7599, 245, 1036, 28, 52, "Input"],
Cell[8638, 275, 418, 11, 52, "Input"],
Cell[9059, 288, 192, 4, 30, "Text"],
Cell[9254, 294, 309, 6, 92, "Input"],
Cell[9566, 302, 366, 8, 31, "Input"],
Cell[9935, 312, 205, 4, 30, "Text"],
Cell[10143, 318, 117, 2, 31, "Input"],
Cell[10263, 322, 61, 1, 31, "Input"],
Cell[10327, 325, 129, 2, 31, "Input"],
Cell[10459, 329, 234, 4, 52, "Input"],
Cell[10696, 335, 633, 17, 52, "Input"],
Cell[11332, 354, 167, 3, 30, "Text"],
Cell[11502, 359, 122, 2, 31, "Input"],
Cell[11627, 363, 683, 18, 52, "Input"],
Cell[12313, 383, 287, 5, 30, "Text"],
Cell[12603, 390, 117, 2, 31, "Input"],
Cell[12723, 394, 2368, 59, 292, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15128, 458, 118, 4, 77, "Subtitle"],
Cell[15249, 464, 126, 2, 31, "Input"],
Cell[15378, 468, 212, 4, 30, "Text"],
Cell[15593, 474, 284, 5, 72, "Input"],
Cell[15880, 481, 294, 5, 30, "Text"],
Cell[16177, 488, 291, 5, 92, "Input"],
Cell[16471, 495, 126, 3, 30, "Text"],
Cell[16600, 500, 468, 8, 112, "Input"],
Cell[17071, 510, 238, 5, 31, "Input"],
Cell[17312, 517, 218, 4, 30, "Text"],
Cell[17533, 523, 118, 2, 31, "Input"],
Cell[17654, 527, 442, 10, 31, "Input"],
Cell[18099, 539, 480, 15, 31, "Input"],
Cell[18582, 556, 179, 4, 30, "Text"],
Cell[18764, 562, 1998, 49, 272, "Input"],
Cell[20765, 613, 276, 5, 49, "Text"],
Cell[21044, 620, 740, 22, 72, "Input"],
Cell[21787, 644, 261, 5, 30, "Text"],
Cell[22051, 651, 2100, 51, 252, "Input"],
Cell[24154, 704, 180, 4, 30, "Text"],
Cell[24337, 710, 8511, 198, 632, "Input"],
Cell[32851, 910, 115, 2, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33003, 917, 106, 4, 77, "Subtitle"],
Cell[33112, 923, 2771, 73, 232, "Input"],
Cell[35886, 998, 1352, 39, 112, "Input"],
Cell[37241, 1039, 2246, 60, 192, "Input"],
Cell[39490, 1101, 907, 24, 112, "Input"],
Cell[40400, 1127, 643, 18, 31, "Input"],
Cell[41046, 1147, 596, 17, 52, "Input"],
Cell[41645, 1166, 2140, 59, 172, "Input"],
Cell[43788, 1227, 1592, 42, 192, "Input"],
Cell[45383, 1271, 147, 3, 31, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
