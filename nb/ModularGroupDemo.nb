(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    112592,       2919]
NotebookOptionsPosition[    107578,       2776]
NotebookOutlinePosition[    107977,       2793]
CellTagsIndexPosition[    107934,       2790]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Package ModularGroup", "Title",
 CellChangeTimes->{{3.5815815119592485`*^9, 3.58158151550146*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"On", "[", "Assert", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5804843126016445`*^9, 3.5804843304169226`*^9}, {
  3.5804862825843325`*^9, 3.5804862832395353`*^9}, {3.5804863643130903`*^9, 
  3.580486365592296*^9}, {3.5804864380234137`*^9, 3.5804864420326314`*^9}, {
  3.581581444727629*^9, 3.5815814795967426`*^9}, {3.5833213205680695`*^9, 
  3.583321328161271*^9}}],

Cell[CellGroupData[{

Cell["\<\

Moebius Transformations\
\>", "Subtitle",
 CellChangeTimes->{{3.581581535267724*^9, 3.5815815390439367`*^9}, {
  3.581739965394067*^9, 3.5817399944101615`*^9}}],

Cell[BoxData[
 RowBox[{"?", "MoebiusTransformation"}]], "Input",
 CellChangeTimes->{{3.5815033554581327`*^9, 3.5815033676115723`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"MoebiusTransformation", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"I", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.581581544581955*^9, 3.5815815727732463`*^9}, {
  3.581583073447138*^9, 3.5815831217332945`*^9}}],

Cell["\<\
Evaluation for complex numbers:\
\>", "Text",
 CellChangeTimes->{{3.581583130719924*^9, 3.581583131983528*^9}, {
  3.581583369473303*^9, 3.5815833987575984`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"phi", "[", "#", "]"}], " ", "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"\"\<z\>\"", ",", " ", "I", ",", " ", 
    RowBox[{"-", "I"}], ",", " ", "ComplexInfinity"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.5815833078101015`*^9, 3.581583334214188*^9}, {
  3.581583406354823*^9, 3.581583431597705*^9}}],

Cell["\<\
Evaluation for homogeneos representation of complex numbers:\
\>", "Text",
 CellChangeTimes->{{3.581583682826324*^9, 3.581583707148803*^9}}],

Cell[BoxData[{
 RowBox[{"hom", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"phi", "[", "#", "]"}], " ", "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<z\>\"", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"I", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "I"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Inhom", "[", "#", "]"}], "&"}], "/@", "hom"}]}], "Input",
 CellChangeTimes->{{3.5815835936328335`*^9, 3.581583673262493*^9}}],

Cell["Composition of transformations:", "Text",
 CellChangeTimes->{{3.5815837390841074`*^9, 3.581583742430319*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"psi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"MoebiusTransformation", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"composition", "=", 
   RowBox[{"phi", "@", "psi"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"composition", "[", 
    RowBox[{"1", "+", "I"}], "]"}], ",", 
   RowBox[{"phi", "[", 
    RowBox[{"psi", "[", 
     RowBox[{"1", "+", "I"}], "]"}], "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.5815849350366063`*^9, 3.5815849497796545`*^9}, {
  3.581585043060358*^9, 3.5815851319874487`*^9}, {3.5815852550974493`*^9, 
  3.581585308188423*^9}, {3.581585443827265*^9, 3.581585489437214*^9}, {
  3.5815863862459354`*^9, 3.581586386573537*^9}, {3.5816070389539514`*^9, 
  3.5816070440707684`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"composition", "[", "\"\<z\>\"", "]"}], "\[Equal]", 
   RowBox[{"phi", "[", 
    RowBox[{"psi", "[", "\"\<z\>\"", "]"}], "]"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.5816070460529747`*^9, 3.5816070473009787`*^9}}],

Cell[BoxData[
 RowBox[{"?", "Mat"}]], "Input",
 CellChangeTimes->{{3.5815862089061575`*^9, 3.5815862109497643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Mat", "[", "phi", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.581586216675983*^9, 3.5815862184543886`*^9}, {
  3.581606730986747*^9, 3.5816067327339525`*^9}}],

Cell[BoxData[
 RowBox[{"?", "Inv"}]], "Input",
 CellChangeTimes->{{3.5815862222608013`*^9, 3.5815862274878182`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"phi", "[", "\"\<z\>\"", "]"}], ",", 
   RowBox[{
    RowBox[{"Inv", "[", "phi", "]"}], "[", "\"\<z\>\"", "]"}]}], 
  "}"}]], "Input",
 CellChangeTimes->{{3.581586234445441*^9, 3.5815862509678946`*^9}, {
  3.5815862836052012`*^9, 3.581586291031825*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Inv", "[", "phi", "]"}], "@", 
    RowBox[{"phi", "@", "\"\<z\>\""}]}], " ", "\[Equal]", 
   RowBox[{"phi", "@", 
    RowBox[{
     RowBox[{"Inv", "[", "phi", "]"}], "@", "\"\<z\>\""}]}], "\[Equal]", 
   "\"\<z\>\""}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.58158630794328*^9, 3.5815863650746665`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Modular Transformations\
\>", "Subtitle",
 CellChangeTimes->{{3.581581629687232*^9, 3.5815816337744455`*^9}, {
  3.5817399858925333`*^9, 3.581739988809743*^9}}],

Cell[BoxData[
 RowBox[{"?", "ModularTransformation"}]], "Input",
 CellChangeTimes->{{3.58150337928141*^9, 3.581503384569827*^9}}],

Cell["ModularTransformations are MoebiusTransformations:", "Text",
 CellChangeTimes->{{3.581607765054337*^9, 3.5816077730103626`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"ModularTransformation", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8"}], ",", 
         RowBox[{"-", "3"}]}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InstanceQ", "[", "MoebiusTransformation", "]"}], "[", "phi", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.5816071529057226`*^9, 3.581607261491295*^9}, {
  3.581608546053294*^9, 3.581608599659069*^9}}],

Cell["\<\
Some MoebiusTransformations are ModularTransformations:\
\>", "Text",
 CellChangeTimes->{{3.5816073368143406`*^9, 3.5816073610276194`*^9}, {
  3.5816073942577276`*^9, 3.5816074121207857`*^9}, {3.5816077821373925`*^9, 
  3.581607786879808*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"psi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"MoebiusTransformation", ",", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"Sqrt", "[", "2", "]"}]}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "I"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "I"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Mat", "[", "psi", "]"}], "//", "MatrixForm"}], ",", 
   RowBox[{
    RowBox[{"InstanceQ", "[", "ModularTransformation", "]"}], "[", "psi", 
    "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.581607363305227*^9, 3.581607377471073*^9}, {
   3.581607415054596*^9, 3.5816074457586966`*^9}, {3.5816075079766994`*^9, 
   3.581607560849272*^9}, {3.581607625001681*^9, 3.581607644752345*^9}, {
   3.581607675924247*^9, 3.5816076826166687`*^9}, 3.581608101744034*^9, {
   3.581608144959175*^9, 3.5816081538366036`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"psiSqr", "=", 
   RowBox[{"psi", "@", "psi"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Mat", "[", "psiSqr", "]"}], "//", "MatrixForm"}], ",", " ", 
   RowBox[{
    RowBox[{"InstanceQ", "[", "ModularTransformation", "]"}], "[", "psiSqr", 
    "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.5816075651080856`*^9, 3.5816076016776047`*^9}}],

Cell["\<\
There are some predifined ModularTransformations:\
\>", "Text",
 CellChangeTimes->{{3.581608688711159*^9, 3.581608696245185*^9}, {
  3.5816088518160925`*^9, 3.5816088535476985`*^9}}],

Cell[BoxData[{
 RowBox[{"?", "mtId"}], "\[IndentingNewLine]", 
 RowBox[{"?", "mtU"}], "\[IndentingNewLine]", 
 RowBox[{"?", "mtT"}], "\[IndentingNewLine]", 
 RowBox[{"?", "mtR"}]}], "Input",
 CellChangeTimes->{{3.5816086983667917`*^9, 3.5816086997395964`*^9}, {
  3.581741061968438*^9, 3.581741072233271*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Row", "@", 
    RowBox[{"{", 
     RowBox[{"\"\<z \[RightTeeArrow] \>\"", ",", 
      RowBox[{"#", "[", "\"\<z\>\"", "]"}]}], "}"}]}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"mtId", ",", "mtU", ",", "mtT", ",", "mtR"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.581608743422738*^9, 3.5816087670228167`*^9}, {
  3.581608809567155*^9, 3.581608824826005*^9}, {3.5820958479611177`*^9, 
  3.582095909689704*^9}, {3.58209595973999*^9, 3.5820959631040764`*^9}}],

Cell["\<\
Finding a group word representation for a ModularTransformation:\
\>", "Text",
 CellChangeTimes->{{3.581609088767665*^9, 3.5816091062407217`*^9}, {
  3.581738333131895*^9, 3.581738342460726*^9}, {3.5820959784494705`*^9, 
  3.5820959843836236`*^9}}],

Cell[BoxData[
 RowBox[{"?", "TRWord"}]], "Input",
 CellChangeTimes->{{3.582122910821069*^9, 3.5821229122141047`*^9}}],

Cell[BoxData[
 RowBox[{"TRWord", "[", "phi", "]"}]], "Input",
 CellChangeTimes->{{3.5821229143241587`*^9, 3.5821229239274054`*^9}, {
  3.5830652599409003`*^9, 3.583065261282504*^9}, {3.5830659046438403`*^9, 
  3.583065915376669*^9}, {3.58306601577854*^9, 3.5830660169953437`*^9}, {
  3.5906737339300375`*^9, 3.5906737412702236`*^9}, {3.5906737853313427`*^9, 
  3.5906737859993596`*^9}, {3.5906739591757584`*^9, 3.590673959983779*^9}}],

Cell["\<\
TRList gives the factors of the above product as list of \
ModularTransformations:\
\>", "Text",
 CellChangeTimes->{{3.5831526853774443`*^9, 3.583152688310255*^9}, {
  3.5831527769185686`*^9, 3.583152788415809*^9}, {3.583152849583626*^9, 
  3.5831529230598855`*^9}}],

Cell[BoxData[
 RowBox[{"?", "TRList"}]], "Input",
 CellChangeTimes->{{3.5831531446586695`*^9, 3.583153145875474*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "factors", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"factors", " ", "=", " ", 
     RowBox[{"TRList", "[", "phi", "]"}]}], ";", 
    RowBox[{"Row", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TRWord", "[", "phi", "]"}], ",", "\"\< = \>\"", ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"MatrixForm", "@", 
             RowBox[{"Mat", "@", "#"}]}], "&"}], "/@", "factors"}], ",", 
          "\"\<\[CenterDot]\>\""}], "]"}]}], ",", " ", "\"\< = \>\"", ",", 
       " ", 
       RowBox[{"MatrixForm", "@", 
        RowBox[{"Mat", "@", "phi"}]}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.5831529303139114`*^9, 3.5831530881396694`*^9}, {
   3.583153236823796*^9, 3.583153244795424*^9}, {3.583153611750725*^9, 
   3.583153642560834*^9}, {3.5906741386293163`*^9, 3.590674141320385*^9}, 
   3.590674243036968*^9}],

Cell["\<\
If only the rightmost or leftmost factor in the product representation is \
needed, TRLeft and TRRight may be used:\
\>", "Text",
 CellChangeTimes->{{3.5831531194801807`*^9, 3.5831531758431797`*^9}}],

Cell[BoxData[{
 RowBox[{"?", "TRLeft"}], "\[IndentingNewLine]", 
 RowBox[{"?", "TRRight"}]}], "Input",
 CellChangeTimes->{{3.583152674660207*^9, 3.583152676189012*^9}, {
  3.5831531116645527`*^9, 3.58315311361456*^9}, {3.5831531778243876`*^9, 
  3.5831531895400286`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TRLeft", "[", "phi", "]"}], "===", 
  RowBox[{"Inv", "@", "mtR"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TRRight", "[", "phi", "]"}], "===", 
  RowBox[{"Inv", "@", "mtR"}]}]}], "Input",
 CellChangeTimes->{{3.583153197979658*^9, 3.583153231878578*^9}, {
  3.5831532631566887`*^9, 3.583153328848521*^9}, {3.583153361811438*^9, 
  3.583153401118779*^9}, {3.5831534444401326`*^9, 3.5831534480905457`*^9}, {
  3.5831536967710257`*^9, 3.583153746691202*^9}}],

Cell["\<\
In general, the word representation in terms of the generators T and U is \
shorter than that in terms of T and R, but it is not unique any more:\
\>", "Text",
 CellChangeTimes->{{3.5821230318971806`*^9, 3.5821230613169365`*^9}, {
  3.5831526302312493`*^9, 3.5831526706041927`*^9}}],

Cell[BoxData[
 RowBox[{"?", "TUWord"}]], "Input",
 CellChangeTimes->{{3.5816082939672604`*^9, 3.581608295480465*^9}, {
  3.5821207960937214`*^9, 3.5821207980997734`*^9}, {3.582122849845502*^9, 
  3.58212285015551*^9}}],

Cell[BoxData[
 RowBox[{"Row", "@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"TRWord", "[", "phi", "]"}], ",", " ", "\"\< = \>\"", ",", " ", 
    RowBox[{"TUWord", "[", "phi", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.582120830079595*^9, 3.5821208437179456`*^9}, {
  3.5821229366947336`*^9, 3.582122938606783*^9}, {3.583153874674055*^9, 
  3.583153882552083*^9}}],

Cell[BoxData[
 RowBox[{"?", "QuotientFunction"}]], "Input",
 CellChangeTimes->{{3.5816093570773387`*^9, 3.5816093593559465`*^9}}],

Cell[BoxData[{
 RowBox[{"?", "CentralQuotient"}], "\[IndentingNewLine]", 
 RowBox[{"?", "CQuotient"}]}], "Input",
 CellChangeTimes->{{3.5816093711339846`*^9, 3.5816093750505977`*^9}, {
  3.581741100094962*^9, 3.5817411039013743`*^9}}],

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", 
       RowBox[{"TUWord", "[", 
        RowBox[{"phi", ",", 
         RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"f", ",", 
       RowBox[{"{", 
        RowBox[{"Quotient", ",", "CentralQuotient", ",", "CQuotient"}], 
        "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5816093862212343`*^9, 3.5816094401078095`*^9}, {
  3.5816099252761903`*^9, 3.5816099401308393`*^9}}],

Cell["\<\
Sometimes the list of exponents of the U\[CloseCurlyQuote]s is more useful:\
\>", "Text",
 CellChangeTimes->{{3.5816094988460007`*^9, 3.581609525617688*^9}}],

Cell[BoxData[
 RowBox[{"?", "TUExponents"}]], "Input",
 CellChangeTimes->{{3.581609111155738*^9, 3.5816091138701468`*^9}}],

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", 
       RowBox[{"TUExponents", "[", 
        RowBox[{"phi", ",", 
         RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"f", ",", 
       RowBox[{"{", 
        RowBox[{"Quotient", ",", "CentralQuotient", ",", "CQuotient"}], 
        "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.581609531358507*^9, 3.581609553668579*^9}, {
  3.5816097783741117`*^9, 3.581609854040358*^9}, {3.5816098946970906`*^9, 
  3.581609912014147*^9}}],

Cell["TUEval can be used for evaluating group words:", "Text",
 CellChangeTimes->{{3.581609659210923*^9, 3.58160966426634*^9}, {
  3.581610103413971*^9, 3.581610106892782*^9}, {3.5816101376736827`*^9, 
  3.5816101391556873`*^9}, {3.5817411392666893`*^9, 3.5817411475503163`*^9}}],

Cell[BoxData[
 RowBox[{"?", "TUEval"}]], "Input",
 CellChangeTimes->{{3.581609186774184*^9, 3.5816091957296133`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"factors", ",", "word", ",", "phi"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"ModularTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"13", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "8"}], ",", 
            RowBox[{"-", "3"}]}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"word", "=", 
         RowBox[{"TUWord", "[", 
          RowBox[{"phi", ",", 
           RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"factors", "=", 
         RowBox[{"TUEval", "[", 
          RowBox[{"phi", ",", 
           RowBox[{"Mat", "[", "mtT", "]"}], ",", 
           RowBox[{"Mat", "[", "mtU", "]"}], ",", "List", ",", "MatrixPower", 
           ",", 
           RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Row", "@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"word", ",", "\"\< = \>\"", ",", " ", "\[IndentingNewLine]", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MatrixForm", "[", "#", "]"}], "&"}], "/@", 
               "factors"}], ",", "\"\<\[CenterDot]\>\""}], "]"}]}], ",", " ", 
           "\"\< = \>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"Dot", "@@", "factors"}], "]"}]}], "\[IndentingNewLine]", 
          "}"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f", ",", "Quotient"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Quotient", ",", "CentralQuotient", ",", "CQuotient"}], 
          "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.581610325686096*^9, 3.5816105768035145`*^9}, 
   3.581610614964239*^9, {3.581610781331382*^9, 3.5816108756718893`*^9}}],

Cell["\<\
For creating a List of ModularTransformations, ModularGroupList may be used:\
\>", "Text",
 CellChangeTimes->{{3.582096033096875*^9, 3.5820960807060986`*^9}, {
   3.5820962104054317`*^9, 3.5820962303409443`*^9}, 3.582123323923685*^9}],

Cell[BoxData[
 RowBox[{"?", "ModularGroupList"}]], "Input",
 CellChangeTimes->{{3.582096082383142*^9, 3.582096088250293*^9}, {
   3.582096232333996*^9, 3.582096232613003*^9}, 3.5821233239676867`*^9}],

Cell["\<\
Creating a list of all ModularTransformations, where the absolute values of \
all U exponents add up to at most 3:\
\>", "Text",
 CellChangeTimes->{{3.582096253706545*^9, 3.5820962654298463`*^9}, {
   3.5820965594964037`*^9, 3.5820965601974216`*^9}, {3.582096669673235*^9, 
   3.582096709773266*^9}, {3.582096989954466*^9, 3.5820970361776543`*^9}, {
   3.582097075679669*^9, 3.582097075960676*^9}, {3.5820994614749823`*^9, 
   3.582099470449213*^9}, 3.582132809488546*^9}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", ",", "transformations"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"Function", "[", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{"Total", "@", 
           RowBox[{"Abs", "@", 
            RowBox[{"TUExponents", "[", 
             RowBox[{"t", ",", 
              RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}]}]}], 
          "\[LessEqual]", " ", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"transformations", "=", 
       RowBox[{"ModularGroupList", "[", "p", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"TUWord", "[", 
         RowBox[{"#", ",", 
          RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}], "&"}], "/@", 
       "transformations"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", "Quotient"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Quotient", ",", "CentralQuotient", ",", "CQuotient"}], 
        "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.5820967905863423`*^9, 3.5820968103638506`*^9}, {
   3.5820969297469187`*^9, 3.5820969500544405`*^9}, {3.5820972981283855`*^9, 
   3.582097366668147*^9}, {3.582097402259062*^9, 3.582097415965414*^9}, {
   3.582097462986623*^9, 3.582097478994034*^9}, {3.582097528295301*^9, 
   3.5820975633322015`*^9}, {3.5820976025302086`*^9, 3.582097610518414*^9}, {
   3.5820977235733194`*^9, 3.582097726943406*^9}, {3.582097815110672*^9, 
   3.582097817608736*^9}, {3.5820979650555253`*^9, 3.5820979783178663`*^9}, {
   3.5820981968894835`*^9, 3.582098243945693*^9}, {3.582101923044243*^9, 
   3.5821019239152656`*^9}, 3.5821233240136876`*^9}],

Cell["\<\
For searching certain ModularTransformations, it is more practical to iterate \
over an infinite sequence rather than working with finite lists:\
\>", "Text",
 CellChangeTimes->{{3.582099484213567*^9, 3.5820994844215717`*^9}, {
  3.5820995726438394`*^9, 3.5820998140160427`*^9}, {3.582132836991412*^9, 
  3.5821328410474215`*^9}}],

Cell[BoxData[
 RowBox[{"?", "ModularGroupIterator"}]], "Input",
 CellChangeTimes->{{3.5820993649365015`*^9, 3.58209936993363*^9}}],

Cell["\<\
Find the \[OpenCurlyDoubleQuote]first\[CloseCurlyDoubleQuote] six \
ModularTransformations, whose coefficients add up to 10:\
\>", "Text",
 CellChangeTimes->{{3.5820998221622515`*^9, 3.5820998534150553`*^9}, {
   3.582100663709879*^9, 3.582100673163122*^9}, 3.5821023450730886`*^9, {
   3.582102910570622*^9, 3.58210292605902*^9}, {3.5821035043068805`*^9, 
   3.5821035051629024`*^9}, {3.5831523354370065`*^9, 3.5831523361390085`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"norm", ",", "it", ",", "t", ",", "n", ",", "transformations"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"norm", "[", "mt_", "]"}], ":=", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mat", "[", "mt", "]"}], "^", "2"}], ",", "Infinity"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"it", "=", 
     RowBox[{"ModularGroupIterator", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"norm", "[", "#1", "]"}], "\[LessEqual]", 
        RowBox[{"norm", "[", "#2", "]"}]}], "&"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"n", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"transformations", " ", "=", " ", 
     RowBox[{
      RowBox[{"Reap", "[", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"n", "<", "6"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", "=", 
           RowBox[{"GetNext", "[", "it", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"Mat", "@", "t"}], ",", "Infinity"}], "]"}], 
             "\[Equal]", "10"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Sow", "[", "t", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"n", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}],
       "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Column", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Row", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"TUWord", "[", "t", "]"}], ",", 
          "\"\<: z \[RightTeeArrow] \>\"", ",", " ", 
          RowBox[{"t", "[", "\"\<z\>\"", "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "transformations"}], "}"}]}], "]"}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.58210072054134*^9, 3.5821007773738003`*^9}, {
  3.582100807485574*^9, 3.582100819979895*^9}, {3.58210086412803*^9, 
  3.582100944454094*^9}, {3.582101001967572*^9, 3.582101012076832*^9}, {
  3.5821010744434347`*^9, 3.582101079043553*^9}, {3.58210235015722*^9, 
  3.582102365999627*^9}, {3.5821024021225553`*^9, 3.5821024031605816`*^9}, {
  3.5821024375224648`*^9, 3.5821026460388236`*^9}, {3.582102735871132*^9, 
  3.5821027408992615`*^9}, {3.5821027763271723`*^9, 3.5821028568102407`*^9}, {
  3.5821029342562304`*^9, 3.58210313772946*^9}, {3.5821031703022966`*^9, 
  3.582103248169298*^9}, {3.5831505578887167`*^9, 3.5831506506466446`*^9}, {
  3.5831507365717487`*^9, 3.5831507385217557`*^9}, {3.5831519936553965`*^9, 
  3.583152111170613*^9}, {3.5831521548663673`*^9, 3.5831522949548635`*^9}, {
  3.583152374686745*^9, 3.5831523793667617`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Generalized Circles\
\>", "Subtitle",
 CellChangeTimes->{{3.5817399431483946`*^9, 3.5817399477036095`*^9}}],

Cell[BoxData[
 RowBox[{"?", "GeneralizedDisk"}]], "Input",
 CellChangeTimes->{{3.5817400071242027`*^9, 3.581740009947812*^9}}],

Cell["\<\
There are some convenience functions for creating GeneralizedDisks:\
\>", "Text",
 CellChangeTimes->{{3.5817406748063774`*^9, 3.5817407104368935`*^9}, {
  3.581740880524247*^9, 3.5817409199143753`*^9}}],

Cell[BoxData[{
 RowBox[{"?", "CompactDisk"}], "\[IndentingNewLine]", 
 RowBox[{"?", "NoncompactDisk"}], "\[IndentingNewLine]", 
 RowBox[{"?", "Halfplane"}]}], "Input",
 CellChangeTimes->{{3.581740724289738*^9, 3.581740727706149*^9}, {
  3.5817410348711495`*^9, 3.581741042296774*^9}}],

Cell["\<\
CompactDisks are defined by their radius and center, Noncompact disks by \
their \[OpenCurlyDoubleQuote]coradius\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]cocenter\[CloseCurlyDoubleQuote]:\
\>", "Text",
 CellChangeTimes->{{3.581760835542945*^9, 3.5817609744769974`*^9}, {
  3.5820855194176807`*^9, 3.582085521256728*^9}}],

Cell[BoxData[{
 RowBox[{"?", "GDiskRadius"}], "\[IndentingNewLine]", 
 RowBox[{"?", "GDiskCenter"}], "\[IndentingNewLine]", 
 RowBox[{"?", "GDiskCoradius"}], "\[IndentingNewLine]", 
 RowBox[{"?", "GDiskCocenter"}]}], "Input",
 CellChangeTimes->{{3.581760975818602*^9, 3.581761009218311*^9}}],

Cell["Predifined GeneralizedDisks are:", "Text",
 CellChangeTimes->{{3.5817409420664473`*^9, 3.5817409507868757`*^9}}],

Cell[BoxData[{
 RowBox[{"?", "gdUnitDisk"}], "\[IndentingNewLine]", 
 RowBox[{"?", "gdUpperHalfplane"}], "\[IndentingNewLine]", 
 RowBox[{"?", "gdLowerHalfplane"}], "\[IndentingNewLine]", 
 RowBox[{"?", "gdRightHalfplane"}], "\[IndentingNewLine]", 
 RowBox[{"?", "gdLeftHalfplane"}]}], "Input",
 CellChangeTimes->{{3.5817409525964813`*^9, 3.5817409583997006`*^9}, {
  3.5817410253395185`*^9, 3.5817410295671325`*^9}, {3.581741187002845*^9, 
  3.5817412013392916`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"GDiskCenter", "[", "gdUnitDisk", "]"}], ",", 
   RowBox[{"GDiskRadius", "[", "gdUnitDisk", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.5817611233482823`*^9, 3.5817611405707383`*^9}}],

Cell["Testing if a GeneralizedDisk contains a given point:", "Text",
 CellChangeTimes->{{3.581742171314456*^9, 3.581742195541335*^9}, {
   3.5817422334650583`*^9, 3.581742245227496*^9}, 3.5817611884316945`*^9}],

Cell[BoxData[
 RowBox[{"?", "InteriorQ"}]], "Input",
 CellChangeTimes->{{3.581742246959102*^9, 3.581742250375513*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InteriorQ", "[", 
    RowBox[{"gdUnitDisk", ",", "#"}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "2", ",", "ComplexInfinity"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.5817401192105675`*^9, 3.581740162329108*^9}, 
   3.581741018693897*^9, 3.581741173477601*^9, {3.5817423917275734`*^9, 
   3.5817424007132025`*^9}, {3.581743048957714*^9, 3.5817430783170094`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InteriorQ", "[", 
    RowBox[{"gdUnitDisk", ",", "#"}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.5817612017697372`*^9, 3.5817612215350018`*^9}}],

Cell["\<\
For drawing GeneralizedDisks, RegionPlot in conjunction with InteriorQ may be \
used:\
\>", "Text",
 CellChangeTimes->{{3.5817612678671527`*^9, 3.5817612910332284`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "disk", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"disk", "[", "\"\<Unit disk\>\"", "]"}], "=", "gdUnitDisk"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"disk", "[", "\"\<Upper half\>\"", "]"}], "=", 
     "gdUpperHalfplane"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"disk", "[", "\"\<Lower half\>\"", "]"}], "=", 
     "gdLowerHalfplane"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"disk", "[", "\"\<Right half\>\"", "]"}], "=", 
     "gdRightHalfplane"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"disk", "[", "\"\<Left half\>\"", "]"}], "=", 
     "gdLeftHalfplane"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{"InteriorQ", "[", 
         RowBox[{
          RowBox[{"disk", "[", "Selection", "]"}], ",", 
          RowBox[{"x", "+", 
           RowBox[{"I", " ", "y"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "False"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Selection", ",", " ", "\"\<Unit disk\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Unit disk\>\"", ",", "\"\<Upper half\>\"", ",", 
          "\"\<Lower half\>\"", ",", "\"\<Right half\>\"", ",", 
          "\"\<Left half\>\""}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.581742406812823*^9, 3.5817427759880247`*^9}, {
  3.581761315634508*^9, 3.581761318224117*^9}}],

Cell["\<\
A faster alternative for drawing GeneralizedDisks is provided by GDisk and \
GCircle:\
\>", "Text",
 CellChangeTimes->{{3.5820072749481792`*^9, 3.5820073235462966`*^9}, {
  3.58200859676517*^9, 3.582008602772185*^9}, {3.582009337295556*^9, 
  3.582009339869563*^9}}],

Cell[BoxData[{
 RowBox[{"?", "GDisk"}], "\[IndentingNewLine]", 
 RowBox[{"?", "GCircle"}]}], "Input",
 CellChangeTimes->{{3.5820073281649075`*^9, 3.582007335403325*^9}}],

Cell[TextData[{
 "The image of the unit disk under certain powers of the loxodromic Moebius \
transformation z \[RightTeeArrow]",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     RowBox[{"16", "z"}], " ", "+", " ", "16", " ", "+", " ", 
     RowBox[{"32", " ", "\[ImaginaryI]"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", " ", "+", " ", "\[ImaginaryI]"}], ")"}], "z"}], " ", "+", 
     " ", "16"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ":"
}], "Text",
 CellChangeTimes->{{3.5820163554399896`*^9, 3.5820164013231688`*^9}, {
  3.5820170111078396`*^9, 3.582017111392417*^9}, {3.5820177785405626`*^9, 
  3.582017808146323*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "transformations", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"transformations", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"New", "[", 
        RowBox[{"MoebiusTransformation", ",", 
         RowBox[{"MatrixPower", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"16", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"1", "+", 
                 RowBox[{"2", "I"}]}]}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "+", 
                RowBox[{"2", "I"}]}], ",", "16"}], "}"}]}], "}"}], ",", "p"}],
           "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"p", ",", 
         RowBox[{"-", "10."}], ",", "10.", ",", "0.5"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Lighter", "@", "Blue"}], ",", 
        RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
        RowBox[{"GDisk", "[", 
         RowBox[{"gdUnitDisk", ",", "transformations"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}]}], "\[IndentingNewLine]",
   "]"}]], "Input",
 CellChangeTimes->{{3.5820171485673723`*^9, 3.5820173181307297`*^9}, {
   3.58201740840305*^9, 3.582017445707009*^9}, 3.5820174842019978`*^9, {
   3.5820176197574816`*^9, 3.582017763850185*^9}, {3.582017846385306*^9, 
   3.582017891005452*^9}, {3.58201981702595*^9, 3.5820199944775105`*^9}, {
   3.582106883384721*^9, 3.582106888484852*^9}, {3.586096033026285*^9, 
   3.5860960345103703`*^9}, {3.5860960736476088`*^9, 3.586096144802678*^9}, {
   3.586096491864529*^9, 3.5860965205201683`*^9}}],

Cell[TextData[{
 "Generalized circles can be transformed by Moebius transformations, e.g. the \
upper halfplane is transformed to the unit disk by z \[RightTeeArrow] ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "z"}], " ", "+", " ", "1"}], 
    RowBox[{"z", " ", "+", " ", "\[ImaginaryI]"}]], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.5817431526980515`*^9, 3.5817431668004975`*^9}, {
  3.5817613580042467`*^9, 3.5817613704374866`*^9}, {3.5820157950695887`*^9, 
  3.582015881666814*^9}, {3.582016389878875*^9, 3.5820163901738825`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"MoebiusTransformation", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"I", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"disk", "=", 
   RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InteriorQ", "[", 
   RowBox[{"disk", ",", "\"\<z\>\""}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.581743169998508*^9, 3.58174326572042*^9}, {
  3.581743877554412*^9, 3.5817439132473283`*^9}, {3.5817614035563946`*^9, 
  3.581761479435042*^9}}],

Cell["\<\
Continuous animation of this transformation and its powers up to 4:\
\>", "Text",
 CellChangeTimes->{{3.581743445698206*^9, 3.58174348997115*^9}, {
  3.581744333637497*^9, 3.581744348582346*^9}, {3.581761486455065*^9, 
  3.5817615106507435`*^9}, {3.582015902446348*^9, 3.582015903103365*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"phi", ",", "disk"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"phi", "=", 
       RowBox[{"New", "[", 
        RowBox[{"MoebiusTransformation", ",", 
         RowBox[{"MatrixPower", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"I", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", "t"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"disk", "=", 
       RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Superscript", "[", 
          RowBox[{"\"\<\[Phi]\>\"", ",", "t"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "@", "Blue"}], ",", 
               RowBox[{"GDisk", "[", "disk", "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "@", "Blue"}], ",", 
               RowBox[{"GCircle", "[", "disk", "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "2"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "4", ",", "Animator", ",", 
       RowBox[{"DefaultDuration", "\[Rule]", "20"}], ",", 
       RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.5817434914531546`*^9, 3.5817436525860796`*^9}, {
   3.581743960780683*^9, 3.5817439609054832`*^9}, {3.5817440476261663`*^9, 
   3.5817441638621445`*^9}, {3.581744194485044*^9, 3.581744208790291*^9}, {
   3.58174423931959*^9, 3.581744302125395*^9}, {3.581863320797556*^9, 
   3.581863389562521*^9}, {3.5818670165184755`*^9, 3.5818670195604825`*^9}, {
   3.5820051903007507`*^9, 3.5820052531895022`*^9}, {3.582006211763415*^9, 
   3.5820062312966623`*^9}, {3.5820064713534408`*^9, 
   3.5820064719150424`*^9}, {3.5820071161735964`*^9, 3.582007155457491*^9}, 
   3.582007233495879*^9, {3.582019137212479*^9, 3.5820191491247854`*^9}, {
   3.587743362799753*^9, 3.5877434015035114`*^9}, {3.587827783571315*^9, 
   3.5878277929965725`*^9}, {3.587828243603919*^9, 3.5878282525641646`*^9}, 
   3.5878283247821436`*^9, {3.587828493086755*^9, 3.5878284947097993`*^9}, {
   3.587828549539302*^9, 3.5878286179881773`*^9}}],

Cell["\<\
The above transformation can be thought of a rotation of the Riemannian \
sphere:\
\>", "Text",
 CellChangeTimes->{{3.5817590643599777`*^9, 3.581759093890874*^9}, {
  3.581861014952953*^9, 3.5818610200073647`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "phi", ",", "disk", ",", "cone", ",", "halfSphere", ",", "regionPlot"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"halfSphere", "=", 
     RowBox[{
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "phi", "]"}], 
           RowBox[{"Cos", "[", "theta", "]"}]}], ",", 
          RowBox[{"Sin", "[", "theta", "]"}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", "phi", "]"}]}], 
           RowBox[{"Cos", "[", "theta", "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phi", ",", 
          RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"theta", ",", "0", ",", 
          RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
        RowBox[{"Mesh", "\[Rule]", "False"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Darker", "@", "Green"}], "}"}]}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cone", "[", "disk_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c", ",", "r", ",", "color"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"InstanceQ", "[", "Halfplane", "]"}], "[", "disk", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"InstanceQ", "[", "CompactDisk", "]"}], "[", "disk", 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"c", "=", 
              RowBox[{"GDiskCenter", "[", "disk", "]"}]}], ";", 
             RowBox[{"r", "=", 
              RowBox[{"GDiskRadius", "[", "disk", "]"}]}], ";", 
             RowBox[{"color", "=", "Yellow"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"c", "=", 
              RowBox[{"GDiskCocenter", "[", "disk", "]"}]}], ";", 
             RowBox[{"r", "=", 
              RowBox[{"GDiskCoradius", "[", "disk", "]"}]}], ";", 
             RowBox[{"color", "=", "Black"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"color", ",", "\[IndentingNewLine]", 
            RowBox[{"GeometricTransformation", "[", 
             RowBox[{
              RowBox[{"Cone", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "2"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
                RowBox[{"2", " ", "r"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0", ",", 
                    RowBox[{"-", 
                    RowBox[{"Re", "[", "c", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1", ",", 
                    RowBox[{"-", 
                    RowBox[{"Im", "[", "c", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}]}],
            "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"phi", "=", 
        RowBox[{"New", "[", 
         RowBox[{"MoebiusTransformation", ",", 
          RowBox[{"MatrixPower", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"I", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", 
            RowBox[{"Mod", "[", 
             RowBox[{"t", ",", "4", ",", 
              RowBox[{"-", "2"}]}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"disk", "=", 
        RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"regionPlot", "=", 
        RowBox[{"RegionPlot", "[", 
         RowBox[{
          RowBox[{"InteriorQ", "[", 
           RowBox[{"disk", ",", 
            RowBox[{"x", "+", 
             RowBox[{"I", " ", "y"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Lighter", "@", "Blue"}]}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Re[z]\>\"", ",", "\"\<Im[z]\>\""}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "False"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Column", "@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Superscript", "[", 
           RowBox[{"\"\<\[Phi]\>\"", ",", "t"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GraphicsRow", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"regionPlot", ",", "\[IndentingNewLine]", 
              RowBox[{"Graphics3D", "[", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Rotate", "[", 
                   RowBox[{"halfSphere", ",", 
                    RowBox[{"Pi", " ", 
                    RowBox[{"t", "/", "2"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"regionPlot", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x_Real", ",", "y_Real"}], "}"}], "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "0"}], "}"}]}]}], ")"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"PointSize", "\[Rule]", "Large"}], ",", "Red", 
                    ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"If", "[", 
                   RowBox[{"showProjection", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0.25", "]"}], ",", 
                    RowBox[{"EdgeForm", "[", "]"}], ",", 
                    RowBox[{"cone", "[", "disk", "]"}]}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
                 "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "2"}], ",", 
                RowBox[{"Axes", "\[Rule]", "True"}], ",", 
                RowBox[{"AxesLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Re[z]\>\"", ",", "\"\<Im[z]\>\"", ",", "\"\<\>\""}], 
                  "}"}]}], ",", 
                RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
                RowBox[{"ViewPoint", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"5", ",", 
                   RowBox[{"-", "2"}], ",", "2"}], "}"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "4", ",", "Animator", ",", 
        RowBox[{"DefaultDuration", "\[Rule]", "20"}], ",", 
        RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "showProjection", ",", "True", ",", "\"\<Show projection\>\""}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.581759118538954*^9, 3.581759124435773*^9}, {
   3.5817591552614737`*^9, 3.5817592511393857`*^9}, {3.581759570675226*^9, 
   3.581759574606439*^9}, {3.5817596371782427`*^9, 3.5817596375214443`*^9}, {
   3.581759739233775*^9, 3.581759760652645*^9}, {3.5817598600405684`*^9, 
   3.581759863831381*^9}, {3.5817599130339413`*^9, 3.581759928275191*^9}, {
   3.5817599676497188`*^9, 3.581760071748858*^9}, {3.5817601110453863`*^9, 
   3.581760111138986*^9}, {3.58176037641785*^9, 3.581760376823451*^9}, {
   3.581768125331362*^9, 3.5817684128402987`*^9}, {3.581768448720415*^9, 
   3.5817684619960585`*^9}, {3.5817686776043606`*^9, 3.5817688575041466`*^9}, 
   3.5817693477825427`*^9, {3.5817800798912587`*^9, 3.581780088611687*^9}, {
   3.581867123987134*^9, 3.5818671296031475`*^9}, {3.58186719701091*^9, 
   3.5818672046081285`*^9}, {3.581867243031021*^9, 3.5818675338313217`*^9}, {
   3.581867859388507*^9, 3.581868005108458*^9}, {3.581868081314642*^9, 
   3.581868143855192*^9}, {3.5818682767207127`*^9, 3.581868290261545*^9}, {
   3.5818683364376564`*^9, 3.5818683594321117`*^9}, {3.581868558572195*^9, 
   3.5818685822698536`*^9}, {3.5820184592050548`*^9, 3.58201852789682*^9}, {
   3.582018569551891*^9, 3.5820185704229136`*^9}, {3.582018632206501*^9, 
   3.5820186448438253`*^9}, 3.582018755716675*^9, {3.582018978435399*^9, 
   3.5820190054230924`*^9}, {3.5820190951953993`*^9, 3.582019099447509*^9}, {
   3.5831580546763487`*^9, 3.583158061836774*^9}, {3.5831582991674137`*^9, 
   3.583158369758664*^9}, {3.5831585899750433`*^9, 3.5831586000058784`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

The fundamental domain and the tessellation of the upper halfplane\
\>", "Subtitle",
 CellChangeTimes->{{3.586015512435746*^9, 3.586015538098859*^9}}],

Cell["\<\
The classic fundamental domain of the modular group has the shape of an \
circular arc triangle with vertices Exp[2\[Pi]\[ImaginaryI] / 3], Exp[2\[Pi]\
\[ImaginaryI] / 6] and \[Infinity]. Just like normal triangles, also circular \
arc triangles have an incircle. The incircle of the fundamental domain has \
center 3\[ImaginaryI] / 2 and radius 1/2:\
\>", "Text",
 CellChangeTimes->{{3.5831625176474905`*^9, 3.583162801268092*^9}, {
  3.58316293740674*^9, 3.5831629707706347`*^9}}],

Cell[BoxData[
 RowBox[{"?", "gdIncircle0"}]], "Input",
 CellChangeTimes->{{3.583162404151449*^9, 3.5831624280680904`*^9}, {
  3.5877390475481834`*^9, 3.587739051370199*^9}}],

Cell[TextData[{
 "The Moebuis transformation z \[RightTeeArrow] (",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ImaginaryI]z", " ", "+", " ", "1"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ")/(z + \[ImaginaryI]) maps the upper halfplane to the unit disk."
}], "Text",
 CellChangeTimes->{{3.5831629029448166`*^9, 3.583162933412633*^9}, {
  3.583162978218834*^9, 3.583162998652382*^9}, {3.5877392136108637`*^9, 
  3.58773921755768*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mtPhi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"MoebiusTransformation", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"I", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5831628737950354`*^9, 3.5831628951376076`*^9}}],

Cell["\<\
Each modular transformation maps the fundamental domain to a circular arc \
triangle on the upper halfplane. This triangle is mapped under mtPhi to a \
circular arc triangle within the unit disk. We define the \
\[OpenCurlyDoubleQuote]size\[CloseCurlyDoubleQuote] of a modular \
transformation to be the radius of the incircle of this circular arc triangle:\
\>", "Text",
 CellChangeTimes->{{3.583163067176218*^9, 3.5831631118604155`*^9}, {
  3.583163177962187*^9, 3.5831633735864296`*^9}, {3.5831634881194987`*^9, 
  3.5831634885495105`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"disk", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"disk", "[", "t", "]"}], "^=", 
    RowBox[{"mtPhi", "@", 
     RowBox[{"t", "@", "gdIncircle0"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"size", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"size", "[", "t", "]"}], "^=", 
    RowBox[{"GDiskRadius", "[", 
     RowBox[{"disk", "[", "t", "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.583163507070007*^9, 3.5831635765308685`*^9}, {
  3.583165972484664*^9, 3.5831660096956615`*^9}, {3.5832387291406527`*^9, 
  3.5832387300922556`*^9}, {3.5833929338134327`*^9, 3.5833929563087125`*^9}, {
  3.5840276901643677`*^9, 3.584027691287572*^9}, {3.5877395496830406`*^9, 
  3.587739550790645*^9}}],

Cell[TextData[{
 "Get a list of all modular transformations with \[OpenCurlyDoubleQuote]size\
\[CloseCurlyDoubleQuote] ",
 "\[GreaterSlantEqual]",
 " ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["2", 
    RowBox[{"-", "8"}]], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.5831637982688107`*^9, 3.58316382920664*^9}, {
   3.5831643664400373`*^9, 3.5831643664400373`*^9}, {3.583165705499509*^9, 
   3.5831657082695837`*^9}, 3.5831663271811695`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mtList", "=", 
   RowBox[{"ModularGroupList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"size", "@", "#"}], "\[GreaterEqual]", 
      SuperscriptBox["2", 
       RowBox[{"-", "8"}]]}], "&"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.58316281313841*^9, 3.583162832874939*^9}, {
  3.5831637652769265`*^9, 3.5831637722171125`*^9}, {3.5831638507402167`*^9, 
  3.5831638841861134`*^9}, {3.583164134422819*^9, 3.5831641533623266`*^9}, {
  3.5831643088264933`*^9, 3.583164309109501*^9}, {3.5833948591878457`*^9, 
  3.5833948631034594`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "allTransforms", ",", "arcTransforms", ",", "fordTransforms", ",", 
     "\[IndentingNewLine]", "normal", ",", "preview", ",", "p", ",", "mode", 
     ",", "\[IndentingNewLine]", "zf", ",", "viewCenter", ",", "viewRange", 
     ",", "\[IndentingNewLine]", "phi", ",", "phiOld", ",", " ", "mt0", ",", 
     "\[IndentingNewLine]", "incircles", ",", "fordCircles", ",", 
     "tessellation"}], "\[IndentingNewLine]", "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"allTransforms", "[", "normal", "]"}], "=", "mtList"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"arcTransforms", "[", "normal", "]"}], "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"allTransforms", "[", "normal", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "===", "mtId"}], "||", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TRRight", "@", "#"}], "===", "mtT"}], ")"}]}]}], "&"}]}],
       "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fordTransforms", "[", "normal", "]"}], "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"allTransforms", "[", "normal", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "===", "mtId"}], "||", 
         RowBox[{
          RowBox[{
           RowBox[{"Mat", "[", "#", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "\[NotEqual]", "0"}]}], 
        "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{"size", "@", "t"}], "\[GreaterEqual]", 
        SuperscriptBox["2", 
         RowBox[{"-", "6"}]]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "[", "preview", "]"}], "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"#", "[", "normal", "]"}], ",", "p"}], "]"}]}], ")"}], 
      "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"allTransforms", ",", "arcTransforms", ",", "fordTransforms"}], 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"mode", "=", 
        RowBox[{"ControlActive", "[", 
         RowBox[{"preview", ",", "normal"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"phi", "=", 
        RowBox[{"MatrixPower", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"I", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", "t"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"TrueQ", "[", 
          RowBox[{"phi", "\[NotEqual]", "phiOld"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"zoomTarget", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Re", "@", "#"}], ",", 
               RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", 
            RowBox[{"Inhom", "[", 
             RowBox[{"phi", ".", 
              RowBox[{"Inv", "[", "phiOld", "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"zoomTarget", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"zoomTarget", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "I"}]}], ",", "1"}], 
               "}"}]}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"phiOld", "=", "phi"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"zf", "=", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", "zoom"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"viewCenter", "=", 
        RowBox[{"zoomTarget", "+", 
         RowBox[{"zf", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Re", "@", "#"}], ",", 
                RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", 
             RowBox[{"Inhom", "[", 
              RowBox[{"phi", ".", 
               RowBox[{"{", 
                RowBox[{"I", ",", "1"}], "}"}]}], "]"}]}], "-", 
            "zoomTarget"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"viewRange", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "GoldenRatio", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "zf"}], ",", "zf"}], "}"}]}], "+", 
           RowBox[{"viewCenter", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "zf"}], ",", "zf"}], "}"}]}], "+", 
           RowBox[{"viewCenter", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mt0", "=", 
        RowBox[{
         RowBox[{"FundamentalRepresentative", "[", 
          RowBox[{"Inhom", "[", 
           RowBox[{"phi", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"zoomTarget", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", 
               RowBox[{
                RowBox[{"zoomTarget", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "I"}]}], ",", "1"}], "}"}]}],
            "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"fordCircles", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"show", ",", "\"\<Ford circles\>\""}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"LightBrown", ",", 
            RowBox[{"EdgeForm", "@", "Brown"}], ",", 
            RowBox[{"GDisk", "[", 
             RowBox[{"gdFord0", ",", 
              RowBox[{"fordTransforms", "[", "mode", "]"}], ",", 
              RowBox[{"FinalTransformation", "\[Rule]", "phi"}]}], "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"incircles", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"show", ",", "\"\<Incircles\>\""}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"LightBlue", ",", 
            RowBox[{"EdgeForm", "@", "Blue"}], ",", 
            RowBox[{"GDisk", "[", 
             RowBox[{"gdIncircle0", ",", 
              RowBox[{"allTransforms", "[", "mode", "]"}], ",", 
              RowBox[{"FinalTransformation", "\[Rule]", "phi"}]}], "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tessellation", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"show", ",", "\"\<Tessellation\>\""}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"GCircle", "[", 
            RowBox[{"gdUnitDisk", ",", 
             RowBox[{"arcTransforms", "[", "mode", "]"}], ",", 
             RowBox[{"FinalTransformation", "\[Rule]", "phi"}]}], "]"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
          "fordCircles", ",", "\[IndentingNewLine]", "incircles", ",", 
           "\[IndentingNewLine]", "tessellation", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"White", ",", 
             RowBox[{"EdgeForm", "[", "]"}], ",", 
             RowBox[{"GDisk", "[", 
              RowBox[{"gdLowerHalfplane", ",", 
               RowBox[{"FinalTransformation", "\[Rule]", "phi"}]}], "]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"GCircle", "[", 
              RowBox[{"gdLowerHalfplane", ",", 
               RowBox[{"FinalTransformation", "\[Rule]", "phi"}]}], "]"}]}], 
            "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "viewRange"}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}], ",", 
         RowBox[{"AxesOrigin", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "imageSize"}]}], 
        "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "\"\<Plane \[LeftRightArrow] Disk\>\""}],
          "}"}], ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"show", ",", 
          RowBox[{"{", "\"\<Tessellation\>\"", "}"}], ",", "\"\<Show\>\""}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Tessellation\>\"", ",", "\"\<Incircles\>\"", ",", 
          "\"\<Ford circles\>\""}], "}"}], ",", "TogglerBar"}], "}"}], ",", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"zoomTarget", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "Locator", ",", 
        RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"zoom", ",", "0", ",", "\"\<Zoom\>\""}], "}"}], ",", "0", 
        ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"imageSize", ",", "600", ",", "\"\<Image Size\>\""}], "}"}], 
        ",", "200", ",", "1024"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.586015708706207*^9, 3.5860158556608515`*^9}, {
   3.5860159887334347`*^9, 3.586016135018276*^9}, {3.5860162515995874`*^9, 
   3.58601633885177*^9}, {3.5860163727517185`*^9, 3.5860167388943243`*^9}, {
   3.5860168151328583`*^9, 3.586016822090489*^9}, {3.5860948459163866`*^9, 
   3.5860948915999994`*^9}, {3.586094923681834*^9, 3.5860949542995853`*^9}, {
   3.586095004067432*^9, 3.586095039033432*^9}, {3.5860951798114843`*^9, 
   3.586095198464551*^9}, {3.586178899459003*^9, 3.5861789086942434`*^9}, {
   3.586178965416092*^9, 3.586179441249378*^9}, {3.586179552633867*^9, 
   3.58617955342947*^9}, {3.586179668776376*^9, 3.5861796742832003`*^9}, {
   3.586179773749236*^9, 3.586179801470558*^9}, {3.5863997008198957`*^9, 
   3.586400019700894*^9}, {3.5864008490941305`*^9, 3.5864008774082546`*^9}, {
   3.5864009355809097`*^9, 3.586401127914153*^9}, {3.5864012526023035`*^9, 
   3.5864013153613787`*^9}, {3.586401446573554*^9, 3.5864014619240217`*^9}, {
   3.586401652120055*^9, 3.5864016733049483`*^9}, {3.586402203270472*^9, 
   3.5864022266549745`*^9}, {3.5864038692427373`*^9, 
   3.5864039209413643`*^9}, {3.586403953498707*^9, 3.58640395655632*^9}, {
   3.586404014198573*^9, 3.586404023215412*^9}, {3.586404069625616*^9, 
   3.5864040735724335`*^9}, {3.5864043704573345`*^9, 
   3.5864043854334006`*^9}, {3.5864044714989777`*^9, 3.586404477707805*^9}, {
   3.5864045715110164`*^9, 3.5864045719166183`*^9}, {3.5864046192004256`*^9, 
   3.5864046831451063`*^9}, {3.5864050688099966`*^9, 
   3.5864050906968927`*^9}, {3.5864051321306744`*^9, 
   3.5864052589280305`*^9}, {3.5864052889737625`*^9, 
   3.5864053002058115`*^9}, {3.5864053355555663`*^9, 3.58640533869118*^9}, {
   3.5864053879873962`*^9, 3.586405388611399*^9}, {3.586406671919826*^9, 
   3.586406692418316*^9}, {3.5864068782151303`*^9, 3.5864068803055396`*^9}, {
   3.58640706285754*^9, 3.5864070645111475`*^9}, {3.586407126022217*^9, 
   3.5864071270830216`*^9}, {3.586407862485846*^9, 3.5864079653838973`*^9}, {
   3.586445473052148*^9, 3.586445553400373*^9}, {3.5864455961145563`*^9, 
   3.5864456097549343`*^9}, {3.5864456423448367`*^9, 3.586445664933462*^9}, {
   3.586447081273694*^9, 3.5864471669260664`*^9}, {3.586447293845582*^9, 
   3.5864473416329055`*^9}, {3.58644737427081*^9, 3.5864473966334295`*^9}, {
   3.5864475771234283`*^9, 3.5864475800835104`*^9}, {3.5864477390739145`*^9, 
   3.5864478126749535`*^9}, {3.5864478620123196`*^9, 
   3.5864478687555065`*^9}, {3.586526415029222*^9, 3.5865264265108595`*^9}, {
   3.5865264699414005`*^9, 3.5865264795822325`*^9}, {3.5872283671959066`*^9, 
   3.587228368568712*^9}, 3.58722844815084*^9, {3.587228567968331*^9, 
   3.587228610451705*^9}, {3.587228643104639*^9, 3.5872286559288917`*^9}, {
   3.5872288204831915`*^9, 3.587228826208415*^9}, {3.587229537130128*^9, 
   3.5872295747760825`*^9}, {3.5872296417053566`*^9, 3.587229750150401*^9}, {
   3.5877392471354012`*^9, 3.5877392835771503`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Group words and \[OpenCurlyDoubleQuote]neighbourhood trees\
\[CloseCurlyDoubleQuote]\
\>", "Subtitle",
 CellChangeTimes->{{3.5831722408646526`*^9, 3.5831722494168816`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"color", ",", "sublist"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sublist", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"mtList", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"size", "@", "#"}], "\[GreaterEqual]", 
         SuperscriptBox["2", 
          RowBox[{"-", "4"}]]}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SetOptions", "[", 
     RowBox[{"TUExponents", ",", 
      RowBox[{"QuotientFunction", "\[Rule]", "CentralQuotient"}]}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"color", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"colorBy", "[", "#", "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"mtT", "\[Rule]", "Blue"}], ",", 
             RowBox[{"mtR", "\[Rule]", "Red"}], ",", 
             RowBox[{
              RowBox[{"Inv", "@", "mtR"}], "\[Rule]", "Green"}]}], "}"}]}], 
          ")"}], "&"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Lighter", "@", 
                 RowBox[{"color", "@", "#"}]}], ",", 
                RowBox[{"EdgeForm", "@", 
                 RowBox[{"Darker", "@", 
                  RowBox[{"color", "@", "#"}]}]}], ",", 
                RowBox[{"GDisk", "@", 
                 RowBox[{"disk", "[", "#", "]"}]}]}], "}"}], "&"}], "/@", 
             "mtList"}], ")"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Text", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Magnify", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"labelBy", "@", "#"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"12", 
                   RowBox[{"GDiskRadius", "@", 
                    RowBox[{"disk", "@", "#"}]}]}]}], "\[IndentingNewLine]", 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"c", "=", 
                    RowBox[{"GDiskCenter", "@", 
                    RowBox[{"disk", "@", "#"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Re", "@", "c"}], ",", 
                    RowBox[{"Im", "@", "c"}]}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "&"}], "/@", "sublist"}], 
            ")"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"colorBy", "===", "TRLeft"}], ",", "\"\<First\>\"", ",",
               " ", "\"\<Last\>\""}], "]"}], ",", "\[IndentingNewLine]", 
            "\"\< symbol in R-T group word: T \[LeftRightArrow] Blue - R \
\[LeftRightArrow] Red - \!\(\*SuperscriptBox[\(R\), \(2\)]\) \
\[LeftRightArrow] Green\>\""}], "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"colorBy", ",", "TRRight", ",", " ", "\"\<Color by\>\""}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"TRLeft", ",", "TRRight"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "labelBy", ",", " ", "TRWord", ",", " ", "\"\<Label by\>\""}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"TRWord", ",", "TUWord", ",", "TUExponents", ",", "Mat", ",", 
          RowBox[{
           RowBox[{"#", "[", "\"\<z\>\"", "]"}], "&"}]}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdxUEoQ3EAB+DXMnaQQvRIykm0KGztJZrHaiktDrMph+214mI5bG1tkobi
xmWKVhwc9krtGUsOZimtvGU1YSQ3a9a2Gi628X7/w9fXZbXP2GQURbVJcGOZ
OTcJ2bG0KnGFDSFnHB8LFyJOVLUlHBvRf2NXZKLFLN3LX9O4/WyxEyv+NpTY
X3YMYXWzj5ymNAz+8ch0uHqUmcTLlZgRv6rFeWyM3nJ4eLRixwGLexX3Pbh8
2OMJk3sUa7t4SQiSOwyffhzWlAOYXa85wa2hyCmmxdQNbsjn3vGC9ymLzbpf
cje9U8B7A4dFnPqolc9J55IWclLOKvE9P02e4pQq3PTMMnhr0KHF0W33ODbp
g4JXetN6EMc8V/eIDXezGWy73M/jr/5iAb9kQvUr0m9iifwPVFvZeA==
  "]],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"turight", ",", "exponents", ",", "color"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"turight", "[", 
      RowBox[{"t_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"exponents", "=", 
        RowBox[{"TUExponents", "[", 
         RowBox[{"t", ",", "opts"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"exponents", "\[Equal]", 
          RowBox[{"{", "0", "}"}]}], ",", "t", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Last", "[", "exponents", "]"}], "\[Equal]", "0"}], ",", 
         "mtT", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Last", "[", "exponents", "]"}], ">", "0"}], ",", "mtU", 
         ",", "\[IndentingNewLine]", "True", ",", 
         RowBox[{"Inv", "@", "mtU"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"color", "[", "t_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"turight", "[", "t", "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mtT", "\[Rule]", "White"}], ",", 
         RowBox[{"mtU", "\[Rule]", "Green"}], ",", 
         RowBox[{
          RowBox[{"Inv", "@", "mtU"}], "\[Rule]", "Red"}]}], "}"}]}], ")"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Lighter", "@", "Blue"}], ",", 
            RowBox[{"EdgeForm", "[", 
             RowBox[{"Darker", "@", "Blue"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"GDisk", "@", 
               RowBox[{"disk", "@", "#"}]}], "&"}], "/@", "mtList"}]}], "}"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"color", "@", "#"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Arrowheads", "[", 
                 RowBox[{"0.2", 
                  RowBox[{"GDiskRadius", "@", 
                   RowBox[{"disk", "@", "#"}]}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Arrow", "@", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"a", "=", 
                    RowBox[{"GDiskCenter", "@", 
                    RowBox[{"disk", "[", 
                    RowBox[{"#", "@", 
                    RowBox[{"Inv", "[", 
                    RowBox[{"turight", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"QuotientFunction", "\[Rule]", "qf"}]}], "]"}], 
                    "]"}]}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Re", "@", "a"}], ",", 
                    RowBox[{"Im", "@", "a"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"b", "=", 
                    RowBox[{"GDiskCenter", "@", 
                    RowBox[{"disk", "@", "#"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Re", "@", "b"}], ",", 
                    RowBox[{"Im", "@", "b"}]}], "}"}]}], "]"}]}], 
                  "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
               "}"}], "&"}], "/@", 
             RowBox[{"Rest", "@", "mtList"}]}]}], "\[IndentingNewLine]", 
           "}"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", "\[IndentingNewLine]", 
        RowBox[{
        "PlotLabel", "\[Rule]", 
         "\"\<T: White - U: Green - \!\(\*SuperscriptBox[\(U\), \(-1\)]\): \
Red\>\""}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"qf", ",", "CentralQuotient"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Quotient", ",", "CentralQuotient", ",", "CQuotient"}], 
         "}"}]}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.5831701209538403`*^9, 3.583170125576964*^9}, {
   3.583170202184017*^9, 3.5831704580168734`*^9}, {3.583170871636958*^9, 
   3.5831709327945967`*^9}, {3.583170966312495*^9, 3.5831712143481426`*^9}, {
   3.5831713140978155`*^9, 3.5831713596480365`*^9}, {3.5831714117274323`*^9, 
   3.5831714145595083`*^9}, {3.5831714707430134`*^9, 3.583171471952046*^9}, {
   3.583171534575724*^9, 3.583171611234779*^9}, {3.583171772631104*^9, 
   3.583171773257121*^9}, {3.5831718115151463`*^9, 3.5831718119171567`*^9}, {
   3.583238915171155*^9, 3.5832389292267933`*^9}, {3.583240284714451*^9, 
   3.583240327708167*^9}, {3.5832403601874547`*^9, 3.583240536998332*^9}, {
   3.583240624935769*^9, 3.5832406756671057`*^9}, 3.5832407216404305`*^9, {
   3.583240756802925*^9, 3.583240761950939*^9}, {3.583240806021058*^9, 
   3.5832408442723613`*^9}, {3.583240994828367*^9, 3.583241197628915*^9}, {
   3.583241234413814*^9, 3.5832412983115864`*^9}, {3.5832413450961127`*^9, 
   3.583241345189713*^9}, {3.5833901959248967`*^9, 3.5833902117745533`*^9}, {
   3.5833902420854607`*^9, 3.5833902506342907`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "color", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"color", "[", "t_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"TRRight", "[", "t", "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mtT", "\[Rule]", "White"}], ",", 
         RowBox[{"mtR", "\[Rule]", "Red"}], ",", 
         RowBox[{
          RowBox[{"Inv", "@", "mtR"}], "\[Rule]", "Green"}]}], "}"}]}], 
      ")"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighter", "@", "Blue"}], ",", 
          RowBox[{"EdgeForm", "[", 
           RowBox[{"Darker", "@", "Blue"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"GDisk", "@", 
             RowBox[{"disk", "@", "#"}]}], "&"}], "/@", "mtList"}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"color", "@", "#"}], ",", 
              RowBox[{"Arrowheads", "[", 
               RowBox[{"0.2", 
                RowBox[{"GDiskRadius", "@", 
                 RowBox[{"disk", "@", "#"}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Arrow", "@", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"a", "=", 
                    RowBox[{"GDiskCenter", "@", 
                    RowBox[{"disk", "[", 
                    RowBox[{"#", "@", 
                    RowBox[{"Inv", "[", 
                    RowBox[{"TRRight", "@", "#"}], "]"}]}], "]"}]}]}], "}"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Re", "@", "a"}], ",", 
                    RowBox[{"Im", "@", "a"}]}], "}"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"b", "=", 
                    RowBox[{"GDiskCenter", "@", 
                    RowBox[{"disk", "@", "#"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Re", "@", "b"}], ",", 
                    RowBox[{"Im", "@", "b"}]}], "}"}]}], "]"}]}], 
                "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
             "}"}], "&"}], "/@", 
           RowBox[{"Rest", "@", "mtList"}]}]}], "\[IndentingNewLine]", 
         "}"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "PlotLabel", "\[Rule]", 
       "\"\<T: White - R: Red - \!\(\*SuperscriptBox[\(R\), \(2\)]\): Green\>\
\""}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.583169169765349*^9, 3.5831692330670457`*^9}, {
  3.5831695479614844`*^9, 3.583169847696517*^9}, {3.58316990527506*^9, 
  3.583169955683411*^9}, {3.5831700020316534`*^9, 3.583170044156782*^9}, {
  3.5831700876449475`*^9, 3.583170095790166*^9}, {3.5831704854106073`*^9, 
  3.583170559245586*^9}, {3.5831706319055333`*^9, 3.583170791743817*^9}, {
  3.5832389519248543`*^9, 3.583238952283655*^9}, {3.583241323365254*^9, 
  3.5832413335832815`*^9}, {3.58324137376899*^9, 3.5832414174023075`*^9}, {
  3.583241689451442*^9, 3.5832417247699375`*^9}, {3.583390169966405*^9, 
  3.5833901838816547`*^9}, {3.5833902724275675`*^9, 3.5833902815067997`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Congruence subgroups", "Subtitle",
 CellChangeTimes->{{3.5832477980535274`*^9, 3.5832478094259577`*^9}}],

Cell[BoxData[
 RowBox[{"?", "ModularSubgroupCosets"}]], "Input",
 CellChangeTimes->{{3.583420216901037*^9, 3.583420222657458*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"TUExponents", ",", 
    RowBox[{"QuotientFunction", "\[Rule]", "CQuotient"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5833967145180106`*^9, 3.583396736404888*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"color", ",", "sublist", ",", "pattern", ",", "Coset"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Coset", "[", 
      RowBox[{"n_", ",", "pattern_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Coset", "[", 
       RowBox[{"n", ",", "pattern"}], "]"}], "=", 
      RowBox[{"ModularSubgroupCosets", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"Mat", "@", "#"}], ",", "n"}], "]"}], ",", "pattern"}], 
          "]"}], "&"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"size", "@", "#1"}], "\[GreaterEqual]", 
          RowBox[{"size", "@", "#2"}]}], "&"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sublist", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"mtList", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"size", "@", "#"}], "\[GreaterEqual]", 
         SuperscriptBox["2", 
          RowBox[{"-", "4"}]]}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SetOptions", "[", 
     RowBox[{"TUExponents", ",", 
      RowBox[{"QuotientFunction", "\[Rule]", "CentralQuotient"}]}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"pattern", "=", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "subgroup", ",", "\[IndentingNewLine]", "\"\<\[CapitalGamma](n)\>\"",
           ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \(0\)]\)(n)\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"_", ",", "_"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "_"}], "}"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<\!\(\*SuperscriptBox[\(\[CapitalGamma]\), \(0\)]\)(n)\>\"", 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"_", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"_", ",", "_"}], "}"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          "\"\<\!\(\*SubsuperscriptBox[\(\[CapitalGamma]\), \(0\), \
\(0\)]\)(n)\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"_", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "_"}], "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"color", "=", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"Mat", "@", "#"}], ",", "n"}], "]"}], ",", "pattern"}],
             "]"}], ",", "Red", ",", "Blue"}], "]"}], "&"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Lighter", "@", 
                 RowBox[{"color", "@", "#"}]}], ",", 
                RowBox[{"EdgeForm", "@", 
                 RowBox[{"Darker", "@", 
                  RowBox[{"color", "@", "#"}]}]}], ",", 
                RowBox[{"GDisk", "@", 
                 RowBox[{"disk", "[", "#", "]"}]}]}], "}"}], "&"}], "/@", 
             "mtList"}], ")"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"showCosets", ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"White", ",", " ", 
               RowBox[{"Opacity", "@", "0.5"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"GDisk", "@", 
                  RowBox[{"disk", "[", "#", "]"}]}], "&"}], "/@", 
                RowBox[{"Coset", "[", 
                 RowBox[{"n", ",", "pattern"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Text", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Magnify", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"labelBy", "@", "#"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"12", 
                   RowBox[{"GDiskRadius", "@", 
                    RowBox[{"disk", "@", "#"}]}]}]}], "\[IndentingNewLine]", 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"c", "=", 
                    RowBox[{"GDiskCenter", "@", 
                    RowBox[{"disk", "@", "#"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Re", "@", "c"}], ",", 
                    RowBox[{"Im", "@", "c"}]}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "&"}], "/@", "sublist"}], 
            ")"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
           RowBox[{"\"\<The elements of \>\"", ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{"subgroup", ",", 
              RowBox[{"\"\<n\>\"", "\[Rule]", 
               RowBox[{"ToString", "@", "n"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"showCosets", ",", 
              RowBox[{"\"\<\\nGroup index: \>\"", "<>", 
               RowBox[{"ToString", "@", 
                RowBox[{"Length", "[", 
                 RowBox[{"Coset", "[", 
                  RowBox[{"n", ",", "pattern"}], "]"}], "]"}]}]}], ",", 
              "\"\<\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "subgroup", ",", "\"\<\[CapitalGamma](n)\>\"", ",", 
          "\"\<Subgroup\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\[CapitalGamma](n)\>\"", ",", 
          "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \(0\)]\)(n)\>\"", ",", 
          "\"\<\!\(\*SuperscriptBox[\(\[CapitalGamma]\), \(0\)]\)(n)\>\"", 
          ",", "\"\<\!\(\*SubsuperscriptBox[\(\[CapitalGamma]\), \(0\), \
\(0\)]\)(n)\>\""}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"n", ",", "2", ",", "10", ",", "1", ",", 
        RowBox[{"ControlType", "\[Rule]", "SetterBar"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "labelBy", ",", " ", "TRWord", ",", " ", "\"\<Label by\>\""}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"TRWord", ",", "TUWord", ",", "TUExponents", ",", "Mat", ",", 
          RowBox[{
           RowBox[{"#", "[", "\"\<z\>\"", "]"}], "&"}]}], "}"}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "showCosets", ",", "False", ",", 
          "\"\<Show coset representatives\>\""}], "}"}], " ", ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQ/fBKW8eaTa8c3ylP7wbR6rf/TjwBpBUqHWeBaL1N
qstB9ItvF9eC6HOTCjaB6DnvzbeC6Da27hMgej276EUQvScv9zqIDq5tugE2
J+nBPRDt2bT6PYj2WzNZ/CSQ3jDjMJi2WrlNFkS7/JugAKKf6XxPA9FJa/Uy
wOLeZ36C6AA7IdZTQFrEgJ0TRC/Q5QXTWzoseUG0QoMfmDY4scwORGunrPUC
00/uBIDokMy+EBDdsPZeBNicavdkEL2sdTbXJSA9xeIuL4hWeeUmBKIVBCNF
QPRM4XVxl4H0iVaOBBA98/qe5CtAuufzy1QQbSF6SPfv5leOT3nrDEG0Efs/
OxD9qWS7O4iWqNcOANH2lUWBIHrfEYWpIFpg4925IHrqhWVHQPT8h1uPgmgA
xjDm4w==
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Selftests\
\>", "Subtitle",
 CellChangeTimes->{{3.581611200583548*^9, 3.5816112029079556`*^9}, {
  3.5833176000924797`*^9, 3.5833176005294914`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"On", "[", "Assert", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5833213103998003`*^9, 3.583321315881945*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"phi", ",", "result", ",", "inf"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"MoebiusTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"I", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"InstanceQ", "[", "MoebiusTransformation", "]"}], "[", "phi", 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"I", ",", 
         RowBox[{"-", "I"}], ",", "ComplexInfinity"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"result", "/.", 
       RowBox[{"ComplexInfinity", "\[Rule]", "inf"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"result", "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "inf", ",", "I"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"I", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "I"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Inhom", "[", "#", "]"}], "&"}], "/@", "result"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"result", "/.", 
       RowBox[{"ComplexInfinity", " ", "\[Rule]", "inf"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"result", "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "inf", ",", "I"}], "}"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5815838074719305`*^9, 3.581583846475058*^9}, {
  3.581583887880593*^9, 3.5815840769004097`*^9}, {3.5815841663425016`*^9, 
  3.581584209276841*^9}, {3.581584253756586*^9, 3.581584257392398*^9}, {
  3.5815843188459983`*^9, 3.5815843206712046`*^9}, {3.581584368848161*^9, 
  3.5815843759773846`*^9}, {3.5815844093800936`*^9, 3.5815844168691177`*^9}, {
  3.581584461738864*^9, 3.5815846665533314`*^9}, {3.581584717039096*^9, 
  3.581584763515647*^9}, {3.5815848331914744`*^9, 3.5815848383862915`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"phi", ",", "psi"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"MoebiusTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"I", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"psi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"MoebiusTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"phi", "@", "psi"}], ")"}], "@", "\"\<z\>\""}], "\[Equal]", 
        RowBox[{"phi", "@", 
         RowBox[{"(", 
          RowBox[{"psi", "@", "\"\<z\>\""}], ")"}]}]}], "//", "Simplify"}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5815853314968987`*^9, 3.581585421485992*^9}, {
  3.581586424733261*^9, 3.581586425654664*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "phi", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"MoebiusTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"I", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"InstanceQ", "[", "MoebiusTransformation", "]"}], "[", "phi", 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"!", 
       RowBox[{
        RowBox[{"InstanceQ", "[", "ModularTransformation", "]"}], "[", "phi", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Mat", "[", "phi", "]"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"I", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Inv", "@", 
        RowBox[{"Inv", "@", "phi"}]}], "===", "phi"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Inv", "@", 
        RowBox[{"Inv", "@", 
         RowBox[{"Inv", "@", "phi"}]}]}], "===", 
       RowBox[{"Inv", "@", "phi"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "@", 
         RowBox[{
          RowBox[{"Inv", "[", "phi", "]"}], "@", "\"\<z\>\""}]}], "\[Equal]", 
        RowBox[{
         RowBox[{"Inv", "[", "phi", "]"}], "@", 
         RowBox[{"phi", "@", "\"\<z\>\""}]}], "\[Equal]", "\"\<z\>\""}], "//",
        "Simplify"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.580486467070741*^9, 3.5804865873316684`*^9}, {
  3.580486619421009*^9, 3.5804866333674707`*^9}, {3.5804868051398234`*^9, 
  3.580486824125107*^9}, {3.5804868773993406`*^9, 3.580486878896947*^9}, {
  3.5816113088871007`*^9, 3.5816113091835017`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "phi", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"MoebiusTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"7", ",", "5"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"InstanceQ", "[", "MoebiusTransformation", "]"}], "[", "phi", 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"InstanceQ", "[", "ModularTransformation", "]"}], "[", "phi", 
       "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5804865936964965`*^9, 3.580486736109521*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CentralQuotient", "[", 
       RowBox[{"i", ",", "5"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
      ",", "1", ",", "1", ",", "1"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5816115862156043`*^9, 3.5816116829741197`*^9}, 
   3.5816117411415095`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CQuotient", "[", 
       RowBox[{"i", ",", "5"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}], "\[Equal]", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5816116868897324`*^9, 3.5816117434201174`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRLeft", "[", "mtId", "]"}], "===", "mtT"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRRight", "[", "mtId", "]"}], "===", "mtT"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRLeft", "[", "mtT", "]"}], "===", "mtT"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRRight", "[", "mtT", "]"}], "===", "mtT"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRLeft", "[", "mtR", "]"}], "===", "mtR"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRRight", "[", "mtR", "]"}], "===", "mtR"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRLeft", "[", 
     RowBox[{"Inv", "@", "mtR"}], "]"}], "===", 
    RowBox[{"Inv", "@", "mtR"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRRight", "[", 
     RowBox[{"Inv", "@", "mtR"}], "]"}], "===", 
    RowBox[{"Inv", "@", "mtR"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRLeft", "[", "mtU", "]"}], "===", "mtT"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRRight", "[", "mtU", "]"}], "===", "mtR"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRLeft", "[", 
     RowBox[{"Inv", "@", "mtU"}], "]"}], "===", 
    RowBox[{"Inv", "@", "mtR"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRRight", "[", 
     RowBox[{"Inv", "@", "mtU"}], "]"}], "===", "mtT"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.583148866842733*^9, 3.583148915265304*^9}, {
  3.5831489526430364`*^9, 3.583149169593004*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRList", "[", 
     RowBox[{"mtU", "@", "mtU"}], "]"}], "===", 
    RowBox[{"{", 
     RowBox[{"mtT", ",", "mtR", ",", "mtT", ",", "mtR"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRList", "[", 
     RowBox[{"Inv", "@", 
      RowBox[{"mtU", "@", "mtU"}]}], "]"}], "===", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Inv", "@", "mtR"}], ",", "mtT", ",", 
      RowBox[{"Inv", "@", "mtR"}], ",", "mtT"}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.583149920735662*^9, 3.583150016785202*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TUExponents", "[", 
     RowBox[{"mtT", "@", "mtU"}], "]"}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TUExponents", "[", 
     RowBox[{"mtU", "@", 
      RowBox[{"mtT", "@", 
       RowBox[{"Inv", "@", "mtU"}]}]}], "]"}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TUExponents", "[", 
     RowBox[{
      RowBox[{"Inv", "[", "mtU", "]"}], "@", "mtT"}], "]"}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.583150032120056*^9, 3.583150216013507*^9}, {
  3.583150312765049*^9, 3.583150316009861*^9}, {3.583150366179638*^9, 
  3.5831503690812483`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "disks", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"disks", "=", 
      RowBox[{"{", 
       RowBox[{"gdUnitDisk", ",", " ", 
        RowBox[{"New", "[", 
         RowBox[{"NoncompactDisk", ",", "0", ",", "1"}], "]"}], ",", 
        "gdUpperHalfplane"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"InteriorQ", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}], "/@", "disks"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False", ",", "True"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"InteriorQ", "[", 
          RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "disks"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"False", ",", "True", ",", "True"}], "}"}]}], "]"}], ";", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"InteriorQ", "[", 
          RowBox[{"#", ",", "I"}], "]"}], "&"}], "/@", "disks"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"InteriorQ", "[", 
          RowBox[{"#", ",", 
           RowBox[{"-", "I"}]}], "]"}], "&"}], "/@", "disks"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "False"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"InteriorQ", "[", 
          RowBox[{"#", ",", "ComplexInfinity"}], "]"}], "&"}], "/@", 
        "disks"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"False", ",", "True", ",", "True"}], "}"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5817415559440465`*^9, 3.581741979340231*^9}, {
  3.5817421303799224`*^9, 3.581742137025544*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"phi", ",", "disk", ",", "expectedType"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"expectedType", "=", 
      RowBox[{"{", 
       RowBox[{
       "Halfplane", ",", "CompactDisk", ",", "Halfplane", ",", 
        "NoncompactDisk", ",", "Halfplane"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "=", 
         RowBox[{"New", "[", 
          RowBox[{"MoebiusTransformation", ",", 
           RowBox[{"MatrixPower", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"I", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", "i"}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"disk", "=", 
         RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Assert", "[", 
         RowBox[{
          RowBox[{"InstanceQ", "[", 
           RowBox[{"expectedType", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}], "[", "disk", "]"}],
          "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.581760502981062*^9, 3.5817607708651342`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Off", "[", "Assert", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5804877427507343`*^9, 3.580487744950344*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{997, 626},
WindowMargins->{{63, Automatic}, {Automatic, 0}},
ShowSelection->False,
Magnification->1.100000023841858,
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 104, 1, 99, "Title"],
Cell[686, 25, 506, 10, 53, "Input"],
Cell[CellGroupData[{
Cell[1217, 39, 171, 5, 88, "Subtitle"],
Cell[1391, 46, 134, 2, 32, "Input"],
Cell[1528, 50, 431, 12, 32, "Input"],
Cell[1962, 64, 172, 4, 32, "Text"],
Cell[2137, 70, 345, 8, 32, "Input"],
Cell[2485, 80, 150, 3, 32, "Text"],
Cell[2638, 85, 617, 19, 53, "Input"],
Cell[3258, 106, 115, 1, 32, "Text"],
Cell[3376, 109, 996, 27, 73, "Input"],
Cell[4375, 138, 278, 7, 32, "Input"],
Cell[4656, 147, 116, 2, 32, "Input"],
Cell[4775, 151, 210, 4, 32, "Input"],
Cell[4988, 157, 116, 2, 32, "Input"],
Cell[5107, 161, 304, 8, 32, "Input"],
Cell[5414, 171, 375, 10, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5826, 186, 171, 5, 88, "Subtitle"],
Cell[6000, 193, 129, 2, 32, "Input"],
Cell[6132, 197, 134, 1, 32, "Text"],
Cell[6269, 200, 601, 18, 53, "Input"],
Cell[6873, 220, 253, 5, 32, "Text"],
Cell[7129, 227, 1036, 28, 53, "Input"],
Cell[8168, 257, 418, 11, 53, "Input"],
Cell[8589, 270, 192, 4, 32, "Text"],
Cell[8784, 276, 309, 6, 93, "Input"],
Cell[9096, 284, 502, 11, 32, "Input"],
Cell[9601, 297, 258, 5, 32, "Text"],
Cell[9862, 304, 117, 2, 32, "Input"],
Cell[9982, 308, 434, 6, 32, "Input"],
Cell[10419, 316, 276, 6, 32, "Text"],
Cell[10698, 324, 117, 2, 32, "Input"],
Cell[10818, 328, 1044, 26, 113, "Input"],
Cell[11865, 356, 209, 4, 32, "Text"],
Cell[12077, 362, 271, 5, 53, "Input"],
Cell[12351, 369, 497, 10, 53, "Input"],
Cell[12851, 381, 292, 5, 53, "Text"],
Cell[13146, 388, 218, 4, 32, "Input"],
Cell[13367, 394, 370, 8, 32, "Input"],
Cell[13740, 404, 129, 2, 32, "Input"],
Cell[13872, 408, 234, 4, 53, "Input"],
Cell[14109, 414, 633, 17, 53, "Input"],
Cell[14745, 433, 167, 3, 32, "Text"],
Cell[14915, 438, 122, 2, 32, "Input"],
Cell[15040, 442, 683, 18, 53, "Input"],
Cell[15726, 462, 279, 3, 32, "Text"],
Cell[16008, 467, 117, 2, 32, "Input"],
Cell[16128, 471, 2368, 59, 293, "Input"],
Cell[18499, 532, 244, 4, 32, "Text"],
Cell[18746, 538, 199, 3, 32, "Input"],
Cell[18948, 543, 482, 8, 32, "Text"],
Cell[19433, 553, 1932, 43, 173, "Input"],
Cell[21368, 598, 340, 6, 53, "Text"],
Cell[21711, 606, 130, 2, 32, "Input"],
Cell[21844, 610, 445, 7, 32, "Text"],
Cell[22292, 619, 3019, 68, 313, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25348, 692, 118, 4, 88, "Subtitle"],
Cell[25469, 698, 126, 2, 32, "Input"],
Cell[25598, 702, 212, 4, 32, "Text"],
Cell[25813, 708, 284, 5, 73, "Input"],
Cell[26100, 715, 342, 6, 32, "Text"],
Cell[26445, 723, 291, 5, 93, "Input"],
Cell[26739, 730, 118, 1, 32, "Text"],
Cell[26860, 733, 468, 8, 113, "Input"],
Cell[27331, 743, 238, 5, 32, "Input"],
Cell[27572, 750, 210, 2, 32, "Text"],
Cell[27785, 754, 118, 2, 32, "Input"],
Cell[27906, 758, 442, 10, 32, "Input"],
Cell[28351, 770, 480, 15, 32, "Input"],
Cell[28834, 787, 179, 4, 32, "Text"],
Cell[29016, 793, 1998, 49, 253, "Input"],
Cell[31017, 844, 276, 6, 32, "Text"],
Cell[31296, 852, 169, 3, 53, "Input"],
Cell[31468, 857, 680, 19, 43, "Text"],
Cell[32151, 878, 1908, 45, 173, "Input"],
Cell[34062, 925, 599, 13, 63, "Text"],
Cell[34664, 940, 740, 22, 73, "Input"],
Cell[35407, 964, 302, 5, 32, "Text"],
Cell[35712, 971, 3016, 65, 293, "Input"],
Cell[38731, 1038, 224, 5, 32, "Text"],
Cell[38958, 1045, 10551, 236, 753, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49546, 1286, 161, 4, 88, "Subtitle"],
Cell[49710, 1292, 492, 8, 73, "Text"],
Cell[50205, 1302, 173, 3, 32, "Input"],
Cell[50381, 1307, 444, 10, 32, "Text"],
Cell[50828, 1319, 384, 11, 32, "Input"],
Cell[51215, 1332, 553, 9, 73, "Text"],
Cell[51771, 1343, 784, 19, 53, "Input"],
Cell[52558, 1364, 461, 13, 34, "Text"],
Cell[53022, 1379, 580, 13, 35, "Input"],
Cell[53605, 1394, 13545, 308, 1083, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67187, 1707, 183, 5, 88, "Subtitle"],
Cell[67373, 1714, 4791, 114, 544, "Input"],
Cell[72167, 1830, 5882, 129, 612, "Input"],
Cell[78052, 1961, 3821, 89, 346, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81910, 2055, 110, 1, 55, "Subtitle"],
Cell[82023, 2058, 130, 2, 32, "Input"],
Cell[82156, 2062, 240, 6, 32, "Input"],
Cell[82399, 2070, 8664, 213, 861, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91100, 2288, 159, 5, 88, "Subtitle"],
Cell[91262, 2295, 146, 3, 32, "Input"],
Cell[91411, 2300, 2771, 73, 233, "Input"],
Cell[94185, 2375, 1352, 39, 113, "Input"],
Cell[95540, 2416, 2246, 60, 193, "Input"],
Cell[97789, 2478, 907, 24, 113, "Input"],
Cell[98699, 2504, 643, 18, 32, "Input"],
Cell[99345, 2524, 596, 17, 53, "Input"],
Cell[99944, 2543, 2062, 66, 253, "Input"],
Cell[102009, 2611, 656, 20, 53, "Input"],
Cell[102668, 2633, 994, 29, 73, "Input"],
Cell[103665, 2664, 2140, 59, 173, "Input"],
Cell[105808, 2725, 1592, 42, 193, "Input"],
Cell[107403, 2769, 147, 3, 32, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
