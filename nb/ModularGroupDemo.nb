(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    325152,       8120]
NotebookOptionsPosition[    315863,       7852]
NotebookOutlinePosition[    316263,       7869]
CellTagsIndexPosition[    316220,       7866]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Package ModularGroup", "Title",
 CellChangeTimes->{{3.5815815119592485`*^9, 3.58158151550146*^9}}],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 CellChangeTimes->{{3.612623767245245*^9, 3.6126237718113737`*^9}}],

Cell[TextData[{
 "This is a demonstration for the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " package ",
 StyleBox["ModularGroup",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.6126239914915686`*^9, 3.612624001896862*^9}, {
  3.6126243243039536`*^9, 3.612624338131344*^9}, {3.612624450658517*^9, 
  3.6126245360299244`*^9}, {3.6126246020667863`*^9, 3.612624602297793*^9}, {
  3.6126265262520466`*^9, 3.6126265566509037`*^9}}],

Cell[CellGroupData[{

Cell["About", "Subsection",
 CellChangeTimes->{{3.6126258675864735`*^9, 3.6126258680254855`*^9}}],

Cell[TextData[{
 "The package ",
 StyleBox["ModularGroup",
  FontSlant->"Italic"],
 " has been developed in the course of the diploma thesis ",
 StyleBox["Computer Algebra and Analysis: Complex Variables Visualized,",
  FontSlant->"Italic"],
 " carried out at the ",
 StyleBox["Research Institute for Symbolic Computation (RISC)",
  FontSlant->"Italic"],
 " of the ",
 StyleBox["Johannes Kepler University Linz",
  FontSlant->"Italic"],
 " by Thomas Ponweiser under supervision of Univ.-Prof. Dr. Peter Paule. The \
thesis is available online at http://www.risc.jku.at/publications/."
}], "Text",
 CellChangeTimes->{{3.612624540376047*^9, 3.6126245470062337`*^9}, {
  3.612625060757721*^9, 3.612625190960393*^9}, {3.6126252231162996`*^9, 
  3.612625276832814*^9}, {3.6126253411666284`*^9, 3.6126253421606565`*^9}, {
  3.612625375469596*^9, 3.6126254137896767`*^9}, {3.6126254549978385`*^9, 
  3.612625468038206*^9}, {3.612625721997368*^9, 3.612625747302081*^9}, {
  3.6126258728966227`*^9, 3.612625874500668*^9}}],

Cell[TextData[{
 "The package has been developed and tested with ",
 StyleBox["Wolfram Mathematica 9",
  FontSlant->"Italic"],
 " (Student Edition). "
}], "Text",
 CellChangeTimes->{{3.6126257665346236`*^9, 3.612625833760519*^9}, {
   3.612625890121108*^9, 3.6126259119047227`*^9}, {3.6126260606019163`*^9, 
   3.6126262285156507`*^9}, {3.6126263506660957`*^9, 3.612626361615404*^9}, 
   3.612626407771706*^9, {3.612626945900881*^9, 3.612626952754074*^9}}],

Cell["\<\
The current version (v0.1) contains prototypical implementations of the \
algorithms described in the above mentioned thesis. Check \
https://github.com/ponweist/ModularGroup for newer versions of the package \
with improved and extended features. \
\>", "Text",
 CellChangeTimes->{{3.6126264116148143`*^9, 3.612626427109251*^9}, {
   3.6126265653161483`*^9, 3.6126265973140507`*^9}, 3.61262663734118*^9, {
   3.61262668521653*^9, 3.612626691288701*^9}, {3.6126267454982295`*^9, 
   3.61262676678983*^9}, {3.612626866221634*^9, 3.6126268971045046`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["License", "Subsection",
 CellChangeTimes->{{3.6126242176129456`*^9, 3.6126242202790203`*^9}}],

Cell["\<\
The MIT License (MIT)

Copyright (c) 2014 Thomas Ponweiser

Permission is hereby granted, free of charge, to any person obtaining a copy \
of this software and associated documentation files (the \
\[OpenCurlyDoubleQuote]Software\[CloseCurlyDoubleQuote]), to deal in the \
Software without restriction, including without limitation the rights to use, \
copy, modify, merge, publish, distribute, sublicense, and/or sell copies of \
the Software, and to permit persons to whom the Software is furnished to do \
so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in \
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED \[OpenCurlyDoubleQuote]AS \
IS\[CloseCurlyDoubleQuote], WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, \
INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A \
PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR \
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, \
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR \
IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\
\>", "Text",
 CellChangeTimes->{{3.6126242529139404`*^9, 3.612624290235993*^9}, 
   3.6126255279758964`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Installation", "Subsection",
 CellChangeTimes->{{3.6126271019822817`*^9, 3.6126271043103476`*^9}, {
  3.6126271374982834`*^9, 3.6126271695131865`*^9}}],

Cell[TextData[{
 "Prior to viewing this ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " Notebook (evaluating its cells), the package ",
 StyleBox["ModularGroup",
  FontSlant->"Italic"],
 " needs to be loaded. "
}], "Text",
 CellChangeTimes->{{3.6126271571328373`*^9, 3.612627218262561*^9}, {
  3.612627261623784*^9, 3.612627317068347*^9}, {3.6126274406218314`*^9, 
  3.6126275529990005`*^9}, {3.612627590071046*^9, 3.612627648454692*^9}, {
  3.61262845691549*^9, 3.612628620320098*^9}, {3.6126287572349586`*^9, 
  3.6126287661982117`*^9}, {3.612630081532303*^9, 3.612630088369496*^9}}],

Cell[TextData[{
 "It is recommended to install the package ",
 StyleBox["ModularGroup",
  FontSlant->"Italic"],
 " such that ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " can load it via:"
}], "Text",
 CellChangeTimes->{{3.612628628574331*^9, 3.6126286788287477`*^9}, {
  3.6126287172878323`*^9, 3.6126287965580673`*^9}, {3.6126288978929253`*^9, 
  3.612628914661398*^9}, {3.61262975022696*^9, 3.612629752009011*^9}, {
  3.612630121075418*^9, 3.612630152447303*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell["\<\
Package installation can be done in (at least) two ways:\
\>", "Text",
 CellChangeTimes->{{3.612628628574331*^9, 3.6126286788287477`*^9}, {
  3.6126287172878323`*^9, 3.6126287965580673`*^9}, {3.6126288978929253`*^9, 
  3.612628914661398*^9}, {3.61262975022696*^9, 3.612629752009011*^9}, {
  3.612630121075418*^9, 3.6126302197081995`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Variant A (works in particular for ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 9)"
}], "Item",
 CellChangeTimes->{{3.612628808561406*^9, 3.6126289257647114`*^9}, {
  3.612630221415248*^9, 3.6126302333325834`*^9}}],

Cell[CellGroupData[{

Cell["Select File \[RightArrow] Install...", "Subitem",
 CellChangeTimes->{{3.612628808561406*^9, 3.6126289523014593`*^9}, {
  3.612629417619581*^9, 3.6126294182796*^9}}],

Cell["\<\
In the install dialog, for \[OpenCurlyDoubleQuote]Type of item to install\
\[CloseCurlyDoubleQuote] select \[OpenCurlyDoubleQuote]Package\
\[CloseCurlyDoubleQuote] and for \[OpenCurlyDoubleQuote]Source\
\[CloseCurlyDoubleQuote] select \[OpenCurlyDoubleQuote]From file...\
\[CloseCurlyDoubleQuote]\
\>", "Subitem",
 CellChangeTimes->{{3.612628808561406*^9, 3.61262901117512*^9}, {
  3.6126290449180713`*^9, 3.6126290894783278`*^9}}],

Cell["\<\
In the file selection dialog navigate to the file \
\[OpenCurlyDoubleQuote]ModularGroup.m\[CloseCurlyDoubleQuote] and open it.\
\>", "Subitem",
 CellChangeTimes->{{3.612628808561406*^9, 3.61262901117512*^9}, {
  3.6126290449180713`*^9, 3.6126292054875994`*^9}}],

Cell["\<\
Back in the install dialog, click OK.\
\>", "Subitem",
 CellChangeTimes->{{3.612628808561406*^9, 3.61262901117512*^9}, {
  3.6126290449180713`*^9, 3.612629164939456*^9}, {3.61262920835468*^9, 
  3.612629217292932*^9}, {3.6126292914760237`*^9, 3.6126293934789004`*^9}, {
  3.6126294391411877`*^9, 3.61262948602251*^9}}]
}, Open  ]],

Cell["Variant B", "Item",
 CellChangeTimes->{{3.612629502884986*^9, 3.61262950446603*^9}}],

Cell["Evaluate the following cell:", "Subitem",
 CellChangeTimes->{{3.612628808561406*^9, 3.61262901117512*^9}, {
   3.6126290449180713`*^9, 3.612629164939456*^9}, {3.61262920835468*^9, 
   3.6126292525039253`*^9}, 3.6126294089173355`*^9, {3.6126295064280853`*^9, 
   3.6126295442931533`*^9}, 3.612629614331128*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Print", "[", "$UserBaseDirectory", "]"}]], "Input",
 CellChangeTimes->{{3.61262956190265*^9, 3.6126295670697956`*^9}, {
  3.612630304639594*^9, 3.6126303236481304`*^9}}],

Cell["\<\
Copy the file \[OpenCurlyDoubleQuote]ModularGroup.m\[CloseCurlyDoubleQuote] \
into the subdirectory \[OpenCurlyDoubleQuote]Applications\
\[CloseCurlyDoubleQuote], which is located in the directory listed above.\
\>", "Subitem",
 CellChangeTimes->{{3.6126295470632315`*^9, 3.6126295478152523`*^9}, {
  3.6126296376427855`*^9, 3.612629702963628*^9}, {3.612629979057413*^9, 
  3.6126299804444523`*^9}, {3.6126302639864483`*^9, 3.6126302970873814`*^9}, {
  3.6126303369155045`*^9, 3.612630363489254*^9}, {3.612631152544505*^9, 
  3.612631152919515*^9}}],

Cell[TextData[{
 "Alternatively, you can of course open \[OpenCurlyDoubleQuote]ModularGroup.m\
\[CloseCurlyDoubleQuote] with ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " and run the package manually (without installing) prior to viewing this \
Notebook."
}], "Text",
 CellChangeTimes->{{3.6126299974679327`*^9, 3.61263003852109*^9}, {
  3.6126303812737556`*^9, 3.6126304120906243`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Feature overview and some demonstrations\
\>", "Section",
 CellChangeTimes->{{3.6126239023590555`*^9, 3.6126239860684156`*^9}, {
  3.6126243592399387`*^9, 3.612624365884126*^9}}],

Cell[CellGroupData[{

Cell["Moebius Transformations", "Subsection",
 CellChangeTimes->{{3.581581535267724*^9, 3.5815815390439367`*^9}, {
   3.581739965394067*^9, 3.5817399944101615`*^9}, 3.6126240981555767`*^9}],

Cell[BoxData[
 RowBox[{"?", "MoebiusTransformation"}]], "Input",
 CellChangeTimes->{{3.5815033554581327`*^9, 3.5815033676115723`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"MoebiusTransformation", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"I", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.581581544581955*^9, 3.5815815727732463`*^9}, {
  3.581583073447138*^9, 3.5815831217332945`*^9}}],

Cell["\<\
Note that phi is the \[OpenCurlyDoubleQuote]modified Cayley transformation\
\[CloseCurlyDoubleQuote], which is also predifined:\
\>", "Text",
 CellChangeTimes->{{3.6122469514283504`*^9, 3.6122469694941587`*^9}}],

Cell[BoxData[
 RowBox[{"?", "mtModCayley"}]], "Input",
 CellChangeTimes->{{3.61224697214616*^9, 3.612246974799161*^9}}],

Cell["Evaluation for complex numbers:", "Text",
 CellChangeTimes->{{3.581583130719924*^9, 3.581583131983528*^9}, {
  3.581583369473303*^9, 3.5815833987575984`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"phi", "[", "\"\<z\>\"", "]"}], ",", " ", 
   RowBox[{"phi", "[", "I", "]"}], ",", " ", 
   RowBox[{"phi", "[", 
    RowBox[{"-", "I"}], "]"}], ",", " ", 
   RowBox[{"phi", "[", "ComplexInfinity", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.5815833078101015`*^9, 3.581583334214188*^9}, {
  3.581583406354823*^9, 3.581583431597705*^9}, {3.6028619524622645`*^9, 
  3.60286197675593*^9}, {3.6028620218401656`*^9, 3.602862049300918*^9}, {
  3.6028623062629585`*^9, 3.602862306992978*^9}}],

Cell["\<\
Evaluation for homogeneous representation of complex numbers:\
\>", "Text",
 CellChangeTimes->{{3.581583682826324*^9, 3.581583707148803*^9}, 
   3.599827299718096*^9}],

Cell[BoxData[
 RowBox[{"?", "Inhom"}]], "Input",
 CellChangeTimes->{{3.602862099782301*^9, 3.602862100694326*^9}}],

Cell[BoxData[{
 RowBox[{"hom", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"phi", "@", 
     RowBox[{"{", 
      RowBox[{"\"\<z\>\"", ",", "1"}], "}"}]}], ",", 
    RowBox[{"phi", "@", 
     RowBox[{"{", 
      RowBox[{"I", ",", "1"}], "}"}]}], ",", 
    RowBox[{"phi", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "I"}], ",", "1"}], "}"}]}], ",", 
    RowBox[{"phi", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Inhom", "/@", "hom"}]}], "Input",
 CellChangeTimes->{{3.5815835936328335`*^9, 3.581583673262493*^9}, {
  3.6028620902720404`*^9, 3.602862151173709*^9}}],

Cell["Composition of transformations:", "Text",
 CellChangeTimes->{{3.5815837390841074`*^9, 3.581583742430319*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"psi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"MoebiusTransformation", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"composition", "=", 
   RowBox[{"phi", "@", "psi"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"composition", "[", 
    RowBox[{"1", "+", "I"}], "]"}], ",", 
   RowBox[{"phi", "[", 
    RowBox[{"psi", "[", 
     RowBox[{"1", "+", "I"}], "]"}], "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.5815849350366063`*^9, 3.5815849497796545`*^9}, {
  3.581585043060358*^9, 3.5815851319874487`*^9}, {3.5815852550974493`*^9, 
  3.581585308188423*^9}, {3.581585443827265*^9, 3.581585489437214*^9}, {
  3.5815863862459354`*^9, 3.581586386573537*^9}, {3.5816070389539514`*^9, 
  3.5816070440707684`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"composition", "[", "\"\<z\>\"", "]"}], "\[Equal]", 
   RowBox[{"phi", "[", 
    RowBox[{"psi", "[", "\"\<z\>\"", "]"}], "]"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.5816070460529747`*^9, 3.5816070473009787`*^9}}],

Cell[BoxData[
 RowBox[{"?", "Mat"}]], "Input",
 CellChangeTimes->{{3.5815862089061575`*^9, 3.5815862109497643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Mat", "[", "phi", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.581586216675983*^9, 3.5815862184543886`*^9}, {
  3.581606730986747*^9, 3.5816067327339525`*^9}}],

Cell[BoxData[
 RowBox[{"?", "Inv"}]], "Input",
 CellChangeTimes->{{3.5815862222608013`*^9, 3.5815862274878182`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"phi", "[", "\"\<z\>\"", "]"}], ",", 
   RowBox[{
    RowBox[{"Inv", "[", "phi", "]"}], "[", "\"\<z\>\"", "]"}]}], 
  "}"}]], "Input",
 CellChangeTimes->{{3.581586234445441*^9, 3.5815862509678946`*^9}, {
  3.5815862836052012`*^9, 3.581586291031825*^9}, {3.602862299785781*^9, 
  3.6028623217523828`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Inv", "[", "phi", "]"}], "@", 
    RowBox[{"phi", "@", "\"\<z\>\""}]}], " ", "\[Equal]", 
   RowBox[{"phi", "@", 
    RowBox[{
     RowBox[{"Inv", "[", "phi", "]"}], "@", "\"\<z\>\""}]}], "\[Equal]", 
   "\"\<z\>\""}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.58158630794328*^9, 3.5815863650746665`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Modular Transformations", "Subsection",
 CellChangeTimes->{{3.581581629687232*^9, 3.5815816337744455`*^9}, {
   3.5817399858925333`*^9, 3.581739988809743*^9}, 3.6126241122769747`*^9}],

Cell[BoxData[
 RowBox[{"?", "ModularTransformation"}]], "Input",
 CellChangeTimes->{{3.58150337928141*^9, 3.581503384569827*^9}}],

Cell["ModularTransformations are MoebiusTransformations:", "Text",
 CellChangeTimes->{{3.581607765054337*^9, 3.5816077730103626`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"ModularTransformation", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8"}], ",", 
         RowBox[{"-", "3"}]}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InstanceQ", "[", "MoebiusTransformation", "]"}], "[", "phi", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.5816071529057226`*^9, 3.581607261491295*^9}, {
  3.581608546053294*^9, 3.581608599659069*^9}}],

Cell["Some MoebiusTransformations are ModularTransformations:", "Text",
 CellChangeTimes->{{3.5816073368143406`*^9, 3.5816073610276194`*^9}, {
  3.5816073942577276`*^9, 3.5816074121207857`*^9}, {3.5816077821373925`*^9, 
  3.581607786879808*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"psi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"MoebiusTransformation", ",", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"Sqrt", "[", "2", "]"}]}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "I"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "I"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Mat", "[", "psi", "]"}], "//", "MatrixForm"}], ",", 
   RowBox[{
    RowBox[{"InstanceQ", "[", "ModularTransformation", "]"}], "[", "psi", 
    "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.581607363305227*^9, 3.581607377471073*^9}, {
   3.581607415054596*^9, 3.5816074457586966`*^9}, {3.5816075079766994`*^9, 
   3.581607560849272*^9}, {3.581607625001681*^9, 3.581607644752345*^9}, {
   3.581607675924247*^9, 3.5816076826166687`*^9}, 3.581608101744034*^9, {
   3.581608144959175*^9, 3.5816081538366036`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"psiSqr", "=", 
   RowBox[{"psi", "@", "psi"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Mat", "[", "psiSqr", "]"}], "//", "MatrixForm"}], ",", " ", 
   RowBox[{
    RowBox[{"InstanceQ", "[", "ModularTransformation", "]"}], "[", "psiSqr", 
    "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.5816075651080856`*^9, 3.5816076016776047`*^9}}],

Cell["There are some predefined ModularTransformations:", "Text",
 CellChangeTimes->{{3.581608688711159*^9, 3.581608696245185*^9}, {
   3.5816088518160925`*^9, 3.5816088535476985`*^9}, 3.5998272271777782`*^9}],

Cell[BoxData[{
 RowBox[{"?", "mtId"}], "\[IndentingNewLine]", 
 RowBox[{"?", "mtU"}], "\[IndentingNewLine]", 
 RowBox[{"?", "mtT"}], "\[IndentingNewLine]", 
 RowBox[{"?", "mtR"}]}], "Input",
 CellChangeTimes->{{3.5816086983667917`*^9, 3.5816086997395964`*^9}, {
  3.581741061968438*^9, 3.581741072233271*^9}}],

Cell["\<\
Finding a group word representation for a ModularTransformation:\
\>", "Text",
 CellChangeTimes->{{3.581609088767665*^9, 3.5816091062407217`*^9}, {
  3.581738333131895*^9, 3.581738342460726*^9}, {3.5820959784494705`*^9, 
  3.5820959843836236`*^9}}],

Cell[BoxData[
 RowBox[{"?", "TRWord"}]], "Input",
 CellChangeTimes->{{3.582122910821069*^9, 3.5821229122141047`*^9}}],

Cell[BoxData[
 RowBox[{"TRWord", "[", "phi", "]"}]], "Input",
 CellChangeTimes->{{3.5821229143241587`*^9, 3.5821229239274054`*^9}, {
  3.5830652599409003`*^9, 3.583065261282504*^9}, {3.5830659046438403`*^9, 
  3.583065915376669*^9}, {3.58306601577854*^9, 3.5830660169953437`*^9}, {
  3.5906737339300375`*^9, 3.5906737412702236`*^9}, {3.5906737853313427`*^9, 
  3.5906737859993596`*^9}, {3.5906739591757584`*^9, 3.590673959983779*^9}}],

Cell["\<\
TRList gives the factors of the above product as list of \
ModularTransformations:\
\>", "Text",
 CellChangeTimes->{{3.5831526853774443`*^9, 3.583152688310255*^9}, {
  3.5831527769185686`*^9, 3.583152788415809*^9}, {3.583152849583626*^9, 
  3.5831529230598855`*^9}}],

Cell[BoxData[
 RowBox[{"?", "TRList"}]], "Input",
 CellChangeTimes->{{3.5831531446586695`*^9, 3.583153145875474*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "factors", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"factors", " ", "=", " ", 
     RowBox[{"TRList", "[", "phi", "]"}]}], ";", 
    RowBox[{"Row", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TRWord", "[", "phi", "]"}], ",", "\"\< = \>\"", ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"MatrixForm", "@", 
             RowBox[{"Mat", "@", "#"}]}], "&"}], "/@", "factors"}], ",", 
          "\"\<\[CenterDot]\>\""}], "]"}]}], ",", " ", "\"\< = \>\"", ",", 
       " ", 
       RowBox[{"MatrixForm", "@", 
        RowBox[{"Mat", "@", "phi"}]}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.5831529303139114`*^9, 3.5831530881396694`*^9}, {
   3.583153236823796*^9, 3.583153244795424*^9}, {3.583153611750725*^9, 
   3.583153642560834*^9}, {3.5906741386293163`*^9, 3.590674141320385*^9}, 
   3.590674243036968*^9}],

Cell["\<\
If only the rightmost or leftmost factor in the product representation is \
needed, TRLeft and TRRight may be used:\
\>", "Text",
 CellChangeTimes->{{3.5831531194801807`*^9, 3.5831531758431797`*^9}}],

Cell[BoxData[{
 RowBox[{"?", "TRLeft"}], "\[IndentingNewLine]", 
 RowBox[{"?", "TRRight"}]}], "Input",
 CellChangeTimes->{{3.583152674660207*^9, 3.583152676189012*^9}, {
  3.5831531116645527`*^9, 3.58315311361456*^9}, {3.5831531778243876`*^9, 
  3.5831531895400286`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TRLeft", "[", "phi", "]"}], "===", 
  RowBox[{"Inv", "@", "mtR"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TRRight", "[", "phi", "]"}], "===", 
  RowBox[{"Inv", "@", "mtR"}]}]}], "Input",
 CellChangeTimes->{{3.583153197979658*^9, 3.583153231878578*^9}, {
  3.5831532631566887`*^9, 3.583153328848521*^9}, {3.583153361811438*^9, 
  3.583153401118779*^9}, {3.5831534444401326`*^9, 3.5831534480905457`*^9}, {
  3.5831536967710257`*^9, 3.583153746691202*^9}}],

Cell["\<\
In general, the word representation in terms of the generators T and U is \
shorter than that in terms of T and R, but it is not unique any more:\
\>", "Text",
 CellChangeTimes->{{3.5821230318971806`*^9, 3.5821230613169365`*^9}, {
  3.5831526302312493`*^9, 3.5831526706041927`*^9}}],

Cell[BoxData[
 RowBox[{"?", "TUWord"}]], "Input",
 CellChangeTimes->{{3.5816082939672604`*^9, 3.581608295480465*^9}, {
  3.5821207960937214`*^9, 3.5821207980997734`*^9}, {3.582122849845502*^9, 
  3.58212285015551*^9}}],

Cell[BoxData[
 RowBox[{"Row", "@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"TRWord", "[", "phi", "]"}], ",", " ", "\"\< = \>\"", ",", " ", 
    RowBox[{"TUWord", "[", "phi", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.582120830079595*^9, 3.5821208437179456`*^9}, {
  3.5821229366947336`*^9, 3.582122938606783*^9}, {3.583153874674055*^9, 
  3.583153882552083*^9}}],

Cell[BoxData[
 RowBox[{"?", "QuotientFunction"}]], "Input",
 CellChangeTimes->{{3.5816093570773387`*^9, 3.5816093593559465`*^9}}],

Cell[BoxData[{
 RowBox[{"?", "CentralQuotient"}], "\[IndentingNewLine]", 
 RowBox[{"?", "CQuotient"}]}], "Input",
 CellChangeTimes->{{3.5816093711339846`*^9, 3.5816093750505977`*^9}, {
  3.581741100094962*^9, 3.5817411039013743`*^9}}],

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", 
       RowBox[{"TUWord", "[", 
        RowBox[{"phi", ",", 
         RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"f", ",", 
       RowBox[{"{", 
        RowBox[{"Quotient", ",", "CentralQuotient", ",", "CQuotient"}], 
        "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5816093862212343`*^9, 3.5816094401078095`*^9}, {
  3.5816099252761903`*^9, 3.5816099401308393`*^9}}],

Cell["\<\
Sometimes the list of exponents of the U\[CloseCurlyQuote]s is more useful:\
\>", "Text",
 CellChangeTimes->{{3.5816094988460007`*^9, 3.581609525617688*^9}}],

Cell[BoxData[
 RowBox[{"?", "TUExponents"}]], "Input",
 CellChangeTimes->{{3.581609111155738*^9, 3.5816091138701468`*^9}}],

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", 
       RowBox[{"TUExponents", "[", 
        RowBox[{"phi", ",", 
         RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"f", ",", 
       RowBox[{"{", 
        RowBox[{"Quotient", ",", "CentralQuotient", ",", "CQuotient"}], 
        "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.581609531358507*^9, 3.581609553668579*^9}, {
  3.5816097783741117`*^9, 3.581609854040358*^9}, {3.5816098946970906`*^9, 
  3.581609912014147*^9}}],

Cell["TUEval can be used for evaluating group words:", "Text",
 CellChangeTimes->{{3.581609659210923*^9, 3.58160966426634*^9}, {
  3.581610103413971*^9, 3.581610106892782*^9}, {3.5816101376736827`*^9, 
  3.5816101391556873`*^9}, {3.5817411392666893`*^9, 3.5817411475503163`*^9}}],

Cell[BoxData[
 RowBox[{"?", "TUEval"}]], "Input",
 CellChangeTimes->{{3.581609186774184*^9, 3.5816091957296133`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"factors", ",", "word", ",", "phi"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"ModularTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"13", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "8"}], ",", 
            RowBox[{"-", "3"}]}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"word", "=", 
         RowBox[{"TUWord", "[", 
          RowBox[{"phi", ",", 
           RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"factors", "=", 
         RowBox[{"TUEval", "[", 
          RowBox[{"phi", ",", 
           RowBox[{"Mat", "[", "mtT", "]"}], ",", 
           RowBox[{"Mat", "[", "mtU", "]"}], ",", "List", ",", "MatrixPower", 
           ",", 
           RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Row", "@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"word", ",", "\"\< = \>\"", ",", " ", "\[IndentingNewLine]", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MatrixForm", "[", "#", "]"}], "&"}], "/@", 
               "factors"}], ",", "\"\<\[CenterDot]\>\""}], "]"}]}], ",", " ", 
           "\"\< = \>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"Dot", "@@", "factors"}], "]"}]}], "\[IndentingNewLine]", 
          "}"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "f", ",", "Quotient", ",", "\"\<Integer division function:\>\""}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Quotient", ",", "CentralQuotient", ",", "CQuotient"}], 
          "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.581610325686096*^9, 3.5816105768035145`*^9}, 
   3.581610614964239*^9, {3.581610781331382*^9, 3.5816108756718893`*^9}, {
   3.6028626474843073`*^9, 3.60286267494206*^9}}],

Cell["\<\
For creating a List of ModularTransformations, ModularGroupList may be used:\
\>", "Text",
 CellChangeTimes->{{3.582096033096875*^9, 3.5820960807060986`*^9}, {
   3.5820962104054317`*^9, 3.5820962303409443`*^9}, 3.582123323923685*^9}],

Cell[BoxData[
 RowBox[{"?", "ModularGroupList"}]], "Input",
 CellChangeTimes->{{3.582096082383142*^9, 3.582096088250293*^9}, {
   3.582096232333996*^9, 3.582096232613003*^9}, 3.5821233239676867`*^9}],

Cell["\<\
Creating a list of all ModularTransformations, where the absolute values of \
all U exponents add up to at most 3:\
\>", "Text",
 CellChangeTimes->{{3.582096253706545*^9, 3.5820962654298463`*^9}, {
   3.5820965594964037`*^9, 3.5820965601974216`*^9}, {3.582096669673235*^9, 
   3.582096709773266*^9}, {3.582096989954466*^9, 3.5820970361776543`*^9}, {
   3.582097075679669*^9, 3.582097075960676*^9}, {3.5820994614749823`*^9, 
   3.582099470449213*^9}, 3.582132809488546*^9}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", ",", "transformations"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"Function", "[", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{"Total", "@", 
           RowBox[{"Abs", "@", 
            RowBox[{"TUExponents", "[", 
             RowBox[{"t", ",", 
              RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}]}]}], 
          "\[LessEqual]", " ", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"transformations", "=", 
       RowBox[{"ModularGroupList", "[", "p", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"TUWord", "[", 
         RowBox[{"#", ",", 
          RowBox[{"QuotientFunction", "\[Rule]", "f"}]}], "]"}], "&"}], "/@", 
       "transformations"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", "Quotient"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Quotient", ",", "CentralQuotient", ",", "CQuotient"}], 
        "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.5820967905863423`*^9, 3.5820968103638506`*^9}, {
   3.5820969297469187`*^9, 3.5820969500544405`*^9}, {3.5820972981283855`*^9, 
   3.582097366668147*^9}, {3.582097402259062*^9, 3.582097415965414*^9}, {
   3.582097462986623*^9, 3.582097478994034*^9}, {3.582097528295301*^9, 
   3.5820975633322015`*^9}, {3.5820976025302086`*^9, 3.582097610518414*^9}, {
   3.5820977235733194`*^9, 3.582097726943406*^9}, {3.582097815110672*^9, 
   3.582097817608736*^9}, {3.5820979650555253`*^9, 3.5820979783178663`*^9}, {
   3.5820981968894835`*^9, 3.582098243945693*^9}, {3.582101923044243*^9, 
   3.5821019239152656`*^9}, 3.5821233240136876`*^9}],

Cell["\<\
For searching certain ModularTransformations, it is more practical to iterate \
over an infinite sequence rather than working with finite lists:\
\>", "Text",
 CellChangeTimes->{{3.582099484213567*^9, 3.5820994844215717`*^9}, {
  3.5820995726438394`*^9, 3.5820998140160427`*^9}, {3.582132836991412*^9, 
  3.5821328410474215`*^9}}],

Cell[BoxData[
 RowBox[{"?", "ModularGroupIterator"}]], "Input",
 CellChangeTimes->{{3.5820993649365015`*^9, 3.58209936993363*^9}}],

Cell["\<\
Find the \[OpenCurlyDoubleQuote]first\[CloseCurlyDoubleQuote] six \
ModularTransformations, whose coefficients add up to 10:\
\>", "Text",
 CellChangeTimes->{{3.5820998221622515`*^9, 3.5820998534150553`*^9}, {
   3.582100663709879*^9, 3.582100673163122*^9}, 3.5821023450730886`*^9, {
   3.582102910570622*^9, 3.58210292605902*^9}, {3.5821035043068805`*^9, 
   3.5821035051629024`*^9}, {3.5831523354370065`*^9, 3.5831523361390085`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"it", ",", "t", ",", "n", ",", "transformations"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"it", "=", 
     RowBox[{"ModularGroupIterator", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PSL2ZGrading", "@", 
         RowBox[{"Mat", "[", "#1", "]"}]}], "\[LessEqual]", 
        RowBox[{"PSL2ZGrading", "@", 
         RowBox[{"Mat", "[", "#2", "]"}]}]}], "&"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"n", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"transformations", " ", "=", " ", 
     RowBox[{
      RowBox[{"Reap", "[", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"n", "<", "6"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", "=", 
           RowBox[{"GetNext", "[", "it", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"Mat", "@", "t"}], ",", "Infinity"}], "]"}], 
             "\[Equal]", "10"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Sow", "[", "t", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"n", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}],
       "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Column", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Row", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"TUWord", "[", "t", "]"}], ",", "\"\<: \>\"", ",", " ", 
          RowBox[{"MatrixForm", "@", 
           RowBox[{"Mat", "@", "t"}]}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "transformations"}], "}"}]}], "]"}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQvSJIcF7AhleOOt+0l4LoS53vV4Bo3+j6VWC+BMsG
EP2hnW8XiI76ZncQRGeUNh0C0fMM/E6B6JMpD8H0J/ajmYEg+s/+bBD987Vz
AYiuUU4F0xw7NpSAaG67g30gOuDB75kg+sCxObNAtFEF13wQXfdWciWI5jI+
sQlE7wk3PwOis9Z4XgDRT7JYb4HouII91oGbgOZsDHEH0Ue8hYJAtOWmADDN
9NPkPYheWfr0L4j22BnNHASk7fruiYDoiz+vyoHo5j3Z8iCa6VOQmcKlV44G
2x+B6TP9b61ANANToy2Itj6htOrCy1eO005vWgOiAU5Yq6k=
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generalized Circles", "Subsection",
 CellChangeTimes->{{3.5817399431483946`*^9, 3.5817399477036095`*^9}, 
   3.6126241246383233`*^9}],

Cell[BoxData[
 RowBox[{"?", "GeneralizedDisk"}]], "Input",
 CellChangeTimes->{{3.5817400071242027`*^9, 3.581740009947812*^9}}],

Cell["\<\
There are some convenience functions for creating GeneralizedDisks:\
\>", "Text",
 CellChangeTimes->{{3.5817406748063774`*^9, 3.5817407104368935`*^9}, {
  3.581740880524247*^9, 3.5817409199143753`*^9}}],

Cell[BoxData[{
 RowBox[{"?", "CompactDisk"}], "\[IndentingNewLine]", 
 RowBox[{"?", "NoncompactDisk"}], "\[IndentingNewLine]", 
 RowBox[{"?", "Halfplane"}]}], "Input",
 CellChangeTimes->{{3.581740724289738*^9, 3.581740727706149*^9}, {
  3.5817410348711495`*^9, 3.581741042296774*^9}}],

Cell["\<\
CompactDisks are defined by their radius and center, Noncompact disks by \
their \[OpenCurlyDoubleQuote]coradius\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]cocenter\[CloseCurlyDoubleQuote]:\
\>", "Text",
 CellChangeTimes->{{3.581760835542945*^9, 3.5817609744769974`*^9}, {
  3.5820855194176807`*^9, 3.582085521256728*^9}}],

Cell[BoxData[{
 RowBox[{"?", "GDiskRadius"}], "\[IndentingNewLine]", 
 RowBox[{"?", "GDiskCenter"}], "\[IndentingNewLine]", 
 RowBox[{"?", "GDiskCoradius"}], "\[IndentingNewLine]", 
 RowBox[{"?", "GDiskCocenter"}]}], "Input",
 CellChangeTimes->{{3.581760975818602*^9, 3.581761009218311*^9}}],

Cell["Predefined GeneralizedDisks are:", "Text",
 CellChangeTimes->{{3.5817409420664473`*^9, 3.5817409507868757`*^9}, 
   3.5998272501098785`*^9}],

Cell[BoxData[{
 RowBox[{"?", "gdUnitDisk"}], "\[IndentingNewLine]", 
 RowBox[{"?", "gdUpperHalfplane"}], "\[IndentingNewLine]", 
 RowBox[{"?", "gdLowerHalfplane"}], "\[IndentingNewLine]", 
 RowBox[{"?", "gdRightHalfplane"}], "\[IndentingNewLine]", 
 RowBox[{"?", "gdLeftHalfplane"}]}], "Input",
 CellChangeTimes->{{3.5817409525964813`*^9, 3.5817409583997006`*^9}, {
  3.5817410253395185`*^9, 3.5817410295671325`*^9}, {3.581741187002845*^9, 
  3.5817412013392916`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"GDiskCenter", "[", "gdUnitDisk", "]"}], ",", 
   RowBox[{"GDiskRadius", "[", "gdUnitDisk", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.5817611233482823`*^9, 3.5817611405707383`*^9}}],

Cell["Testing if a GeneralizedDisk contains a given point:", "Text",
 CellChangeTimes->{{3.581742171314456*^9, 3.581742195541335*^9}, {
   3.5817422334650583`*^9, 3.581742245227496*^9}, 3.5817611884316945`*^9}],

Cell[BoxData[
 RowBox[{"?", "InteriorQ"}]], "Input",
 CellChangeTimes->{{3.581742246959102*^9, 3.581742250375513*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InteriorQ", "[", 
    RowBox[{"gdUnitDisk", ",", "#"}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", "2", ",", "ComplexInfinity"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.5817401192105675`*^9, 3.581740162329108*^9}, 
   3.581741018693897*^9, 3.581741173477601*^9, {3.5817423917275734`*^9, 
   3.5817424007132025`*^9}, {3.581743048957714*^9, 3.5817430783170094`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InteriorQ", "[", 
    RowBox[{"gdUnitDisk", ",", "#"}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.5817612017697372`*^9, 3.5817612215350018`*^9}}],

Cell["\<\
For drawing GeneralizedDisks, RegionPlot in conjunction with InteriorQ may be \
used:\
\>", "Text",
 CellChangeTimes->{{3.5817612678671527`*^9, 3.5817612910332284`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "disk", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"disk", "[", "\"\<Unit disk\>\"", "]"}], "=", "gdUnitDisk"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"disk", "[", "\"\<Upper half\>\"", "]"}], "=", 
     "gdUpperHalfplane"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"disk", "[", "\"\<Lower half\>\"", "]"}], "=", 
     "gdLowerHalfplane"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"disk", "[", "\"\<Right half\>\"", "]"}], "=", 
     "gdRightHalfplane"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"disk", "[", "\"\<Left half\>\"", "]"}], "=", 
     "gdLeftHalfplane"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{"InteriorQ", "[", 
         RowBox[{
          RowBox[{"disk", "[", "Selection", "]"}], ",", 
          RowBox[{"x", "+", 
           RowBox[{"I", " ", "y"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", 
          RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "False"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Selection", ",", " ", "\"\<Unit disk\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Unit disk\>\"", ",", "\"\<Upper half\>\"", ",", 
          "\"\<Lower half\>\"", ",", "\"\<Right half\>\"", ",", 
          "\"\<Left half\>\""}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.581742406812823*^9, 3.5817427759880247`*^9}, {
  3.581761315634508*^9, 3.581761318224117*^9}}],

Cell["\<\
A faster alternative for drawing GeneralizedDisks is provided by GDisk and \
GCircle:\
\>", "Text",
 CellChangeTimes->{{3.5820072749481792`*^9, 3.5820073235462966`*^9}, {
  3.58200859676517*^9, 3.582008602772185*^9}, {3.582009337295556*^9, 
  3.582009339869563*^9}}],

Cell[BoxData[{
 RowBox[{"?", "GDisk"}], "\[IndentingNewLine]", 
 RowBox[{"?", "GDiskNPoints"}], "\[IndentingNewLine]", 
 RowBox[{"?", "GCircle"}]}], "Input",
 CellChangeTimes->{{3.5820073281649075`*^9, 3.582007335403325*^9}, {
  3.60286291693169*^9, 3.602862945826482*^9}}],

Cell[TextData[{
 "The image of the unit disk under certain powers of the loxodromic Moebius \
transformation z \[RightTeeArrow]",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     RowBox[{"16", "z"}], " ", "+", " ", "16", " ", "+", " ", 
     RowBox[{"32", " ", "\[ImaginaryI]"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", " ", "+", " ", "\[ImaginaryI]"}], ")"}], "z"}], " ", "+", 
     " ", "16"}]], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.5820163554399896`*^9, 3.5820164013231688`*^9}, {
  3.5820170111078396`*^9, 3.582017111392417*^9}, {3.5820177785405626`*^9, 
  3.582017808146323*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"transformations", ",", "m"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"16", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"1", "+", 
           RowBox[{"2", "I"}]}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"2", "I"}]}], ",", "16"}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"transformations", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"MatrixPower", "[", 
        RowBox[{
         RowBox[{"m", "/", 
          RowBox[{"Sqrt", "@", 
           RowBox[{"Det", "@", "m"}]}]}], ",", "p"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", 
         RowBox[{"-", "10"}], ",", "10", ",", "0.5"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Lighter", "@", "Blue"}], ",", 
        RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
        RowBox[{"GDisk", "[", 
         RowBox[{"gdUnitDisk", ",", "transformations"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "12"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", " ", "]"}]], "Input",
 CellChangeTimes->{{3.5820171485673723`*^9, 3.5820173181307297`*^9}, {
   3.58201740840305*^9, 3.582017445707009*^9}, 3.5820174842019978`*^9, {
   3.5820176197574816`*^9, 3.582017763850185*^9}, {3.582017846385306*^9, 
   3.582017891005452*^9}, {3.58201981702595*^9, 3.5820199944775105`*^9}, {
   3.582106883384721*^9, 3.582106888484852*^9}, {3.586096033026285*^9, 
   3.5860960345103703`*^9}, {3.5860960736476088`*^9, 3.586096144802678*^9}, {
   3.586096491864529*^9, 3.5860965205201683`*^9}, {3.5912010092898397`*^9, 
   3.5912011359618607`*^9}, {3.5912011967394705`*^9, 3.59120125436588*^9}, {
   3.5912013538626966`*^9, 3.591201444311512*^9}, {3.591201479317918*^9, 
   3.5912015181931243`*^9}, {3.591201575679134*^9, 3.5912015920903363`*^9}, {
   3.591201624631942*^9, 3.5912017608979645`*^9}, {3.5912017915519695`*^9, 
   3.5912018169487743`*^9}, {3.591202463520892*^9, 3.5912024788244944`*^9}, {
   3.5912025662781096`*^9, 3.5912026892841296`*^9}}],

Cell[TextData[{
 "Generalized circles can be transformed by Moebius transformations, e.g. the \
upper halfplane is transformed to the unit disk by z \[RightTeeArrow] ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "z"}], " ", "+", " ", "1"}], 
    RowBox[{"z", " ", "+", " ", "\[ImaginaryI]"}]], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.5817431526980515`*^9, 3.5817431668004975`*^9}, {
  3.5817613580042467`*^9, 3.5817613704374866`*^9}, {3.5820157950695887`*^9, 
  3.582015881666814*^9}, {3.582016389878875*^9, 3.5820163901738825`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{"New", "[", 
    RowBox[{"MoebiusTransformation", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"I", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"disk", "=", 
   RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InteriorQ", "[", 
   RowBox[{"disk", ",", "\"\<z\>\""}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.581743169998508*^9, 3.58174326572042*^9}, {
  3.581743877554412*^9, 3.5817439132473283`*^9}, {3.5817614035563946`*^9, 
  3.581761479435042*^9}, {3.6028630110752697`*^9, 3.6028630285097475`*^9}}],

Cell["\<\
Continuous animation of this transformation and its powers up to 4:\
\>", "Text",
 CellChangeTimes->{{3.581743445698206*^9, 3.58174348997115*^9}, {
  3.581744333637497*^9, 3.581744348582346*^9}, {3.581761486455065*^9, 
  3.5817615106507435`*^9}, {3.582015902446348*^9, 3.582015903103365*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"phi", ",", "disk"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"phi", "=", 
       RowBox[{"New", "[", 
        RowBox[{"MoebiusTransformation", ",", 
         RowBox[{"MatrixPower", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"I", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", "t"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"disk", "=", 
       RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Column", "@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Superscript", "[", 
          RowBox[{"\"\<\[Phi]\>\"", ",", "t"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "@", "Blue"}], ",", 
               RowBox[{"GDisk", "[", "disk", "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "@", "Blue"}], ",", 
               RowBox[{"GCircle", "[", "disk", "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "2"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "4", ",", "Animator", ",", 
       RowBox[{"DefaultDuration", "\[Rule]", "20"}], ",", 
       RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.5817434914531546`*^9, 3.5817436525860796`*^9}, {
   3.581743960780683*^9, 3.5817439609054832`*^9}, {3.5817440476261663`*^9, 
   3.5817441638621445`*^9}, {3.581744194485044*^9, 3.581744208790291*^9}, {
   3.58174423931959*^9, 3.581744302125395*^9}, {3.581863320797556*^9, 
   3.581863389562521*^9}, {3.5818670165184755`*^9, 3.5818670195604825`*^9}, {
   3.5820051903007507`*^9, 3.5820052531895022`*^9}, {3.582006211763415*^9, 
   3.5820062312966623`*^9}, {3.5820064713534408`*^9, 
   3.5820064719150424`*^9}, {3.5820071161735964`*^9, 3.582007155457491*^9}, 
   3.582007233495879*^9, {3.582019137212479*^9, 3.5820191491247854`*^9}, {
   3.587743362799753*^9, 3.5877434015035114`*^9}, {3.587827783571315*^9, 
   3.5878277929965725`*^9}, {3.587828243603919*^9, 3.5878282525641646`*^9}, 
   3.5878283247821436`*^9, {3.587828493086755*^9, 3.5878284947097993`*^9}, {
   3.587828549539302*^9, 3.5878286179881773`*^9}}],

Cell["\<\
The above transformation can be thought of a rotation of the Riemann sphere:\
\>", "Text",
 CellChangeTimes->{{3.5817590643599777`*^9, 3.581759093890874*^9}, {
   3.581861014952953*^9, 3.5818610200073647`*^9}, 3.5998272794380074`*^9}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "phi", ",", "disk", ",", "cone", ",", "halfSphere", ",", "regionPlot"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"halfSphere", "=", 
     RowBox[{
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "phi", "]"}], 
           RowBox[{"Cos", "[", "theta", "]"}]}], ",", 
          RowBox[{"Sin", "[", "theta", "]"}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", "phi", "]"}]}], 
           RowBox[{"Cos", "[", "theta", "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phi", ",", 
          RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"theta", ",", "0", ",", 
          RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
        RowBox[{"Mesh", "\[Rule]", "False"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Darker", "@", "Green"}], "}"}]}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cone", "[", "disk_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c", ",", "r", ",", "color"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"InstanceQ", "[", "Halfplane", "]"}], "[", "disk", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"InstanceQ", "[", "CompactDisk", "]"}], "[", "disk", 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"c", "=", 
              RowBox[{"GDiskCenter", "[", "disk", "]"}]}], ";", 
             RowBox[{"r", "=", 
              RowBox[{"GDiskRadius", "[", "disk", "]"}]}], ";", 
             RowBox[{"color", "=", "Yellow"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"c", "=", 
              RowBox[{"GDiskCocenter", "[", "disk", "]"}]}], ";", 
             RowBox[{"r", "=", 
              RowBox[{"GDiskCoradius", "[", "disk", "]"}]}], ";", 
             RowBox[{"color", "=", "Black"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"color", ",", "\[IndentingNewLine]", 
            RowBox[{"GeometricTransformation", "[", 
             RowBox[{
              RowBox[{"Cone", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "2"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
                RowBox[{"2", " ", "r"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0", ",", 
                    RowBox[{"-", 
                    RowBox[{"Re", "[", "c", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1", ",", 
                    RowBox[{"-", 
                    RowBox[{"Im", "[", "c", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}]}],
            "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"phi", "=", 
        RowBox[{"New", "[", 
         RowBox[{"MoebiusTransformation", ",", 
          RowBox[{"MatrixPower", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"I", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", 
            RowBox[{"Mod", "[", 
             RowBox[{"t", ",", "4", ",", 
              RowBox[{"-", "2"}]}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"disk", "=", 
        RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"regionPlot", "=", 
        RowBox[{"RegionPlot", "[", 
         RowBox[{
          RowBox[{"InteriorQ", "[", 
           RowBox[{"disk", ",", 
            RowBox[{"x", "+", 
             RowBox[{"I", " ", "y"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Lighter", "@", "Blue"}]}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Re[z]\>\"", ",", "\"\<Im[z]\>\""}], "}"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "False"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Column", "@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Superscript", "[", 
           RowBox[{"\"\<\[Phi]\>\"", ",", "t"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"GraphicsRow", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"regionPlot", ",", "\[IndentingNewLine]", 
              RowBox[{"Graphics3D", "[", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Rotate", "[", 
                   RowBox[{"halfSphere", ",", 
                    RowBox[{"Pi", " ", 
                    RowBox[{"t", "/", "2"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"regionPlot", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x_Real", ",", "y_Real"}], "}"}], "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "0"}], "}"}]}]}], ")"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"PointSize", "\[Rule]", "Large"}], ",", "Red", 
                    ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"If", "[", 
                   RowBox[{"showProjection", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0.25", "]"}], ",", 
                    RowBox[{"EdgeForm", "[", "]"}], ",", 
                    RowBox[{"cone", "[", "disk", "]"}]}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
                 "}"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "2"}], ",", 
                RowBox[{"Axes", "\[Rule]", "True"}], ",", 
                RowBox[{"AxesLabel", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<Re[z]\>\"", ",", "\"\<Im[z]\>\"", ",", "\"\<\>\""}], 
                  "}"}]}], ",", 
                RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
                RowBox[{"ViewPoint", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"5", ",", 
                   RowBox[{"-", "2"}], ",", "2"}], "}"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "4", ",", "Animator", ",", 
        RowBox[{"DefaultDuration", "\[Rule]", "20"}], ",", 
        RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "showProjection", ",", "True", ",", "\"\<Show projection\>\""}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.581759118538954*^9, 3.581759124435773*^9}, {
   3.5817591552614737`*^9, 3.5817592511393857`*^9}, {3.581759570675226*^9, 
   3.581759574606439*^9}, {3.5817596371782427`*^9, 3.5817596375214443`*^9}, {
   3.581759739233775*^9, 3.581759760652645*^9}, {3.5817598600405684`*^9, 
   3.581759863831381*^9}, {3.5817599130339413`*^9, 3.581759928275191*^9}, {
   3.5817599676497188`*^9, 3.581760071748858*^9}, {3.5817601110453863`*^9, 
   3.581760111138986*^9}, {3.58176037641785*^9, 3.581760376823451*^9}, {
   3.581768125331362*^9, 3.5817684128402987`*^9}, {3.581768448720415*^9, 
   3.5817684619960585`*^9}, {3.5817686776043606`*^9, 3.5817688575041466`*^9}, 
   3.5817693477825427`*^9, {3.5817800798912587`*^9, 3.581780088611687*^9}, {
   3.581867123987134*^9, 3.5818671296031475`*^9}, {3.58186719701091*^9, 
   3.5818672046081285`*^9}, {3.581867243031021*^9, 3.5818675338313217`*^9}, {
   3.581867859388507*^9, 3.581868005108458*^9}, {3.581868081314642*^9, 
   3.581868143855192*^9}, {3.5818682767207127`*^9, 3.581868290261545*^9}, {
   3.5818683364376564`*^9, 3.5818683594321117`*^9}, {3.581868558572195*^9, 
   3.5818685822698536`*^9}, {3.5820184592050548`*^9, 3.58201852789682*^9}, {
   3.582018569551891*^9, 3.5820185704229136`*^9}, {3.582018632206501*^9, 
   3.5820186448438253`*^9}, 3.582018755716675*^9, {3.582018978435399*^9, 
   3.5820190054230924`*^9}, {3.5820190951953993`*^9, 3.582019099447509*^9}, {
   3.5831580546763487`*^9, 3.583158061836774*^9}, {3.5831582991674137`*^9, 
   3.583158369758664*^9}, {3.5831585899750433`*^9, 3.5831586000058784`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The fundamental domain and the tiling of the upper half-plane\
\>", "Subsection",
 CellChangeTimes->{{3.586015512435746*^9, 3.586015538098859*^9}, {
   3.591200545470562*^9, 3.591200548106962*^9}, 3.591205547775443*^9, {
   3.5998274859985127`*^9, 3.599827499710973*^9}, 3.602915246010132*^9, 
   3.612624142322822*^9}],

Cell["\<\
The tiling of the upper complex halfplane associated to the modular group can \
easily plotted:\
\>", "Text",
 CellChangeTimes->{{3.591200468016549*^9, 3.591200468515749*^9}, {
   3.591200513662157*^9, 3.5912005186541576`*^9}, {3.591200550914963*^9, 
   3.591200611084173*^9}, 3.591205547775443*^9}],

Cell[BoxData[
 RowBox[{"?", "ModularTiling"}]], "Input",
 CellChangeTimes->{{3.591200615686174*^9, 3.591200621270975*^9}, 
   3.591205547775443*^9, {3.5918685882207556`*^9, 3.5918685949287567`*^9}}],

Cell["\<\
To produce a list of modular transformations used by the function \
ModularTiling, we define the \[OpenCurlyDoubleQuote]grading\
\[CloseCurlyDoubleQuote] of a modular Transformation to be the sum of its \
coefficients squared.\
\>", "Text",
 CellChangeTimes->{{3.5912008534302135`*^9, 3.591200911883423*^9}, 
   3.591205547791043*^9}],

Cell[BoxData[
 RowBox[{"?", "PSL2ZGrading"}]], "Input",
 CellChangeTimes->{{3.6029129092669597`*^9, 3.602912935225466*^9}}],

Cell["\<\
Now, we list all transformations with a grading not greater than 100.\
\>", "Text",
 CellChangeTimes->{{3.591200934768627*^9, 3.591200945470229*^9}, {
   3.591202769936143*^9, 3.5912027901381464`*^9}, 3.591205547791043*^9, {
   3.6029151979775352`*^9, 3.6029152069319715`*^9}, {3.6029161829499693`*^9, 
   3.60291618535238*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mtList", "=", 
   RowBox[{"ModularGroupList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PSL2ZGrading", "@", 
       RowBox[{"Mat", "@", "#"}]}], "\[LessEqual]", "100"}], "&"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "@", "mtList"}]}], "Input",
 CellChangeTimes->{{3.591202794162947*^9, 3.5912028033981485`*^9}, 
   3.591205547791043*^9, {3.602912944335903*^9, 3.6029129583915606`*^9}}],

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"ModularTiling", "[", 
    RowBox[{"mtList", ",", "mtId", ",", 
     RowBox[{"LabelMode", "\[Rule]", "TUWord"}], ",", 
     RowBox[{"Magnification", "\[Rule]", "5"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "#"}], ",", "#"}], "}"}], "&"}], "@", "GoldenRatio"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"Axes", "\[Rule]", "True"}], ",", 
   RowBox[{"AxesStyle", "\[Rule]", "Gray"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.59120281177535*^9, 3.5912029861989794`*^9}, {
   3.591203021423785*^9, 3.5912030303625865`*^9}, {3.59120327914266*^9, 
   3.5912033027298636`*^9}, 3.591205547791043*^9}],

Cell["\<\
Here is a more fancy demonstration of ModularTiling and its options:\
\>", "Text",
 CellChangeTimes->{{3.5912030537781906`*^9, 3.591203058177391*^9}, {
   3.591203139802147*^9, 3.5912031536965346`*^9}, 3.5912055478066425`*^9}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "mtListPreview", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mtListPreview", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"mtList", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"PSL2ZGrading", "@", 
          RowBox[{"Mat", "@", "#"}]}], "\[LessEqual]", "40"}], "&"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "phi0", ",", "phi", ",", "opts", ",", "mts", ",", "viewCenter", ",", 
          "plotRange", ",", "labelFu"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mts", "=", 
          RowBox[{"ControlActive", "[", 
           RowBox[{"mtListPreview", ",", "mtList"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phi0", "=", 
          RowBox[{"MatrixPower", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"I", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", "t"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"phi", "=", 
          RowBox[{"phi0", ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"Cos", "[", "s", "]"}]}], ",", 
               RowBox[{"Tan", "[", "s", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"viewCenter", "=", 
          RowBox[{"Inhom", "@", 
           RowBox[{"(", 
            RowBox[{"phi0", ".", 
             RowBox[{"{", 
              RowBox[{"I", ",", "1"}], "}"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"plotRange", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Re", "[", "viewCenter", "]"}], "+", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "#"}], ",", "#"}], "}"}]}], "&"}], "@", 
             "GoldenRatio"}], ",", 
            RowBox[{
             RowBox[{"Im", "[", "viewCenter", "]"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"labelFu", "=", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"label", "===", "\"\<Function\>\""}], ",", 
            RowBox[{"Function", "[", 
             RowBox[{"m", ",", 
              RowBox[{"Inhom", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MatrixQ", "[", "m", "]"}], ",", "m", ",", 
                  RowBox[{"Mat", "@", "m"}]}], "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"\"\<z\>\"", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"label", "===", "\"\<Matrix\>\""}], ",", 
            RowBox[{"Function", "[", 
             RowBox[{"m", ",", 
              RowBox[{"MatrixForm", "@", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MatrixQ", "[", "m", "]"}], ",", "m", ",", 
                 RowBox[{"Mat", "@", "m"}]}], "]"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", "True", ",", "label"}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"opts", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"show", ",", "\"\<Tessellation\>\""}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"opts", ",", 
              RowBox[{"TilingMode", "\[Rule]", "Off"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"show", ",", "\"\<Incircles\>\""}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"opts", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"opts", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"IncircleMode", "\[Rule]", "GDisk"}], ",", 
                 RowBox[{"IncircleStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"EdgeForm", "@", 
                    RowBox[{"Lighter", "@", "Blue"}]}], ",", 
                    RowBox[{"Lighter", "@", 
                    RowBox[{"Lighter", "@", "Blue"}]}]}], "]"}]}]}], "}"}]}], 
              "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"show", ",", "\"\<Ford circles\>\""}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"opts", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"opts", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"FordDiskMode", "\[Rule]", "GDisk"}], ",", 
                 RowBox[{"FordDiskStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"EdgeForm", "@", 
                    RowBox[{"Lighter", "@", "Brown"}]}], ",", 
                    RowBox[{"Lighter", "@", 
                    RowBox[{"Lighter", "@", "Brown"}]}]}], "]"}]}]}], "}"}]}],
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{"label", "===", "Off"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"opts", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"opts", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"LabelMode", "\[Rule]", "labelFu"}], ",", 
                RowBox[{"Magnification", "\[Rule]", "labelSize"}]}], "}"}]}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"show", ",", "\"\<Fundamental region\>\""}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"LightGray", ",", 
                 RowBox[{"GDisk", "[", 
                  RowBox[{"gdUnitDisk", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"phi", ".", "#"}], "&"}], "/@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Mat", "@", "mtId"}], ",", 
                    RowBox[{"Mat", "@", "mtR"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], 
                    "}"}]}]}], "]"}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ModularTiling", "[", 
              RowBox[{"mts", ",", "phi", ",", 
               RowBox[{"Sequence", "@@", "opts"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", 
           RowBox[{"AxesStyle", "\[Rule]", "Gray"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "imageSize"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "\"\<Plane \[LeftRightArrow] Disk\>\""}],
          "}"}], ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "s", ",", "0", ",", 
          "\"\<Center: \[ImaginaryI] \[LeftRightArrow] \[Rho]\>\""}], "}"}], 
        ",", "0", ",", 
        RowBox[{"Pi", "/", "6"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"show", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Fundamental region\>\"", ",", " ", "\"\<Tessellation\>\""}], 
           "}"}], ",", "\"\<Show\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Fundamental region\>\"", ",", " ", "\"\<Tessellation\>\"", ",", 
          "\"\<Incircles\>\"", ",", "\"\<Ford circles\>\""}], "}"}], ",", 
        "TogglerBar"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"label", ",", "Off", ",", "\"\<Label\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "Off", ",", "TUWord", ",", "TRWord", ",", "\"\<Matrix\>\"", ",", 
          "\"\<Function\>\""}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"labelSize", ",", "5", ",", "\"\<Label size\>\""}], "}"}], 
        ",", "1", ",", "10"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"imageSize", ",", "400", ",", "\"\<Image Size\>\""}], "}"}], 
        ",", "200", ",", "1024"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 ShowSelection->True,
 CellChangeTimes->{{3.59120316463984*^9, 3.591203200905647*^9}, {
   3.5912032457410545`*^9, 3.5912032483004546`*^9}, {3.591203381544077*^9, 
   3.591203408891882*^9}, {3.591203471559092*^9, 3.5912035820739107`*^9}, {
   3.591203649093522*^9, 3.5912039848331785`*^9}, {3.5912040269697857`*^9, 
   3.591204072788993*^9}, {3.591204184473412*^9, 3.5912042900572295`*^9}, {
   3.591204448698656*^9, 3.591204477544061*^9}, 3.591204524689269*^9, {
   3.5912046178232846`*^9, 3.591204703001299*^9}, {3.591204740583705*^9, 
   3.591204751441307*^9}, {3.591204795028714*^9, 3.591204809895517*^9}, {
   3.5912048573049245`*^9, 3.5912048985835314`*^9}, {3.591204996757348*^9, 
   3.59120547170783*^9}, 3.5912055478066425`*^9, {3.591205633375657*^9, 
   3.591205634530057*^9}, {3.602863119698246*^9, 3.6028631435508995`*^9}, {
   3.602863326333982*^9, 3.602863341637645*^9}, {3.6028633791889987`*^9, 
   3.602863404601503*^9}, {3.6028635302796173`*^9, 3.6028635387504525`*^9}, {
   3.602863572119989*^9, 3.6028635954274845`*^9}, {3.602907746380173*^9, 
   3.602907747050976*^9}, {3.602912968219601*^9, 3.6029129726344194`*^9}, 
   3.602915322372445*^9, {3.6075816117622848`*^9, 3.6075817650291843`*^9}, {
   3.607581845656247*^9, 3.6075819216490946`*^9}, {3.6075821137475204`*^9, 
   3.6075821520798454`*^9}, {3.607582299667326*^9, 3.607582332414833*^9}, {
   3.607582551985948*^9, 3.6075825606449766`*^9}, {3.6075826285881977`*^9, 
   3.6075827046278453`*^9}, {3.6075827708550615`*^9, 
   3.6075828221988287`*^9}, {3.6075830324255133`*^9, 3.607583085422886*^9}, {
   3.607583121196803*^9, 3.6075831470012865`*^9}, {3.6122478318103476`*^9, 
   3.612247874244366*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The action modular transformations on the modular tiling", "Subsection",
 CellChangeTimes->{{3.602915296335938*^9, 3.6029153242444525`*^9}, 
   3.612624151885092*^9}],

Cell["\<\
We can animate the action of modular transformations on the modular tiling. 
Selection of a modular transformation A can be done by clicking on its \
corresponding tile (that is the image of the fundamental domain under A).
For a given point of the upper half-plane, the corresponding transformation A \
and its inverse can be found with the following routines:\
\>", "Text",
 CellChangeTimes->{{3.602914144183618*^9, 3.6029142064902735`*^9}, {
  3.602914306549083*^9, 3.6029143952198467`*^9}, {3.602915214279602*^9, 
  3.602915237960499*^9}, {3.602915327302065*^9, 3.6029153554601803`*^9}, {
  3.6029154478905587`*^9, 3.602915781747526*^9}, {3.602915888264763*^9, 
  3.6029159155492744`*^9}}],

Cell[BoxData[{
 RowBox[{"?", "AssociatedMap"}], "\[IndentingNewLine]", 
 RowBox[{"?", "InvAssociatedMap"}]}], "Input",
 CellChangeTimes->{{3.6029082312457595`*^9, 3.6029082327277656`*^9}, {
  3.6029085349634037`*^9, 3.602908538005416*^9}}],

Cell[TextData[{
 "We use the modified Cayley transform to map the tiling of the upper \
half-plane to the unit disk. \nIn order to animate the action of the selected \
transformation A, we use ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "\[CloseCurlyQuote]s built-in MatrixPower.\nFor a parameter t \[Element] \
[0,1], the \[OpenCurlyDoubleQuote]intermediate image\[CloseCurlyDoubleQuote] \
of the tiling is induced by the M\[ODoubleDot]bius transformation \
MatrixPower[A,t].\nNote the little trick that for drawing the tiling, we use \
a paramter t\[CloseCurlyQuote] which cycles through the interval [-0.5,0.5] \
instead.\nThis ensures that we see the same tiling lines for t=0 and t=1."
}], "Text",
 CellChangeTimes->{{3.602915796442786*^9, 3.6029158021368103`*^9}, {
  3.6029158343041415`*^9, 3.602915844490983*^9}, {3.602916252105053*^9, 
  3.6029165510334773`*^9}, {3.6029165970224657`*^9, 3.602916638565436*^9}, {
  3.6029166737747803`*^9, 3.602916688875642*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mtListPreview", ",", "modCayley"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mtListPreview", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"mtList", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"PSL2ZGrading", "@", 
          RowBox[{"Mat", "@", "#"}]}], "\[LessEqual]", "40"}], "&"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"modCayley", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"I", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mts", ",", "z", ",", "z0", ",", "fix", ",", "t", ",", "phipt", ",", 
          "phitess", ",", "labelFu"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mts", "=", 
          RowBox[{"ControlActive", "[", 
           RowBox[{"mtListPreview", ",", "mtList"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"z", "=", 
          RowBox[{"Inhom", "[", 
           RowBox[{
            RowBox[{"PSL2CInv", "[", "modCayley", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Complex", "@@", "P"}], ",", "1"}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"t", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"z", "===", "ComplexInfinity"}], ",", 
            RowBox[{"IdentityMatrix", "@", "2"}], ",", 
            RowBox[{"AssociatedMap", "[", "z", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"z0", "=", 
          RowBox[{"Inhom", "[", 
           RowBox[{
            RowBox[{"PSL2ZInv", "[", "t", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fix", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"t", "\[Equal]", 
             RowBox[{"IdentityMatrix", "@", "2"}]}], ",", "Null", ",", 
            RowBox[{"First", "@", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"Eigenvectors", "[", "t", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Im", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                   RowBox[{"Conjugate", "@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], 
                 "\[GreaterEqual]", "0"}], "&"}]}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phipt", "=", 
          RowBox[{"modCayley", ".", 
           RowBox[{"MatrixPower", "[", 
            RowBox[{"t", ",", "p"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"phitess", "=", 
          RowBox[{"modCayley", ".", 
           RowBox[{"MatrixPower", "[", 
            RowBox[{"t", ",", 
             RowBox[{"Mod", "[", 
              RowBox[{"p", ",", "1", ",", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "2"}]}], "]"}]}], "]"}]}]}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"labelFu", "=", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"label", "===", "\"\<Function\>\""}], ",", 
            RowBox[{"Function", "[", 
             RowBox[{"m", ",", 
              RowBox[{"Inhom", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MatrixQ", "[", "m", "]"}], ",", "m", ",", 
                  RowBox[{"Mat", "@", "m"}]}], "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"\"\<z\>\"", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"label", "===", "\"\<Matrix\>\""}], ",", 
            RowBox[{"Function", "[", 
             RowBox[{"m", ",", 
              RowBox[{"MatrixForm", "@", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MatrixQ", "[", "m", "]"}], ",", "m", ",", 
                 RowBox[{"Mat", "@", "m"}]}], "]"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", "True", ",", "label"}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Column", "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Graphics", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ModularTiling", "[", 
                   RowBox[{"mts", ",", "phitess"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ModularTiling", "[", 
                   RowBox[{"mts", ",", "phipt", ",", "\[IndentingNewLine]", 
                    RowBox[{"TilingMode", "\[Rule]", "Off"}], ",", 
                    RowBox[{"BorderMode", "\[Rule]", "Off"}], ",", 
                    RowBox[{"ExteriorMode", "\[Rule]", "Off"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"LabelMode", "\[Rule]", "labelFu"}], ",", 
                    RowBox[{"LabelThreshold", "\[Rule]", 
                    RowBox[{"1", "/", "labelThreshold"}]}], ",", 
                    RowBox[{"Magnification", "\[Rule]", "labelSize"}]}], 
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", 
                  RowBox[{"PointSize", "@", "Medium"}], ",", 
                  RowBox[{"Point", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Re", "@", "#"}], ",", 
                    RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", 
                    RowBox[{"Inhom", "[", 
                    RowBox[{"phipt", ".", 
                    RowBox[{"{", 
                    RowBox[{"z0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], 
                 "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"t", "\[NotEqual]", 
                   RowBox[{"IdentityMatrix", "@", "2"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Blue", ",", 
                    RowBox[{"PointSize", "@", "Medium"}], ",", 
                    RowBox[{"Point", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Re", "@", "#"}], ",", 
                    RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", 
                    RowBox[{"Inhom", "[", 
                    RowBox[{"phipt", ".", "fix"}], "]"}]}], "]"}]}], "}"}]}], 
                 "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotRange", "\[Rule]", "1.05"}], ",", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Axes", "\[Rule]", "True"}], ",", 
                RowBox[{"AxesStyle", "\[Rule]", "Gray"}], ","}], "*)"}], 
              RowBox[{"ImageSize", "\[Rule]", "imageSize"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Grid", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<Selected point:\>\"", ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{"z", ",", "0.001"}], "]"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"\"\<Associated transformation:\>\"", ",", " ", 
                  RowBox[{"labelFu", "@", "t"}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"\"\<Fixed point in \[ScriptCapitalH]:\>\"", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"fix", "===", "Null"}], ",", 
                    "\"\<(all points)\>\"", ",", 
                    RowBox[{
                    RowBox[{"Simplify", "@", 
                    RowBox[{"Inhom", "@", "fix"}]}], "/.", 
                    RowBox[{"ComplexInfinity", "\[Rule]", "\[Infinity]"}]}]}],
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Equivalent point in \[ScriptCapitalF]:\>\"", ",", 
                  RowBox[{"Round", "[", 
                   RowBox[{"z0", ",", "0.001"}], "]"}]}], "}"}]}], 
               "\[IndentingNewLine]", "}"}], ",", 
              RowBox[{"Alignment", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Left", ",", "Left"}], "}"}]}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"P", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "Locator"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "0", ",", "\"\<Animate Transformation\>\""}], 
         "}"}], ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"label", ",", "TUWord", ",", "\"\<Label\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "TUWord", ",", "TRWord", ",", "\"\<Matrix\>\"", ",", 
          "\"\<Function\>\""}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "labelThreshold", ",", "8", ",", 
          "\"\<Less labels \[LeftRightArrow] More labels\>\""}], "}"}], ",", 
        "8", ",", "32"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"labelSize", ",", "8", ",", "\"\<Label size\>\""}], "}"}], 
        ",", "1", ",", "16"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"imageSize", ",", "400", ",", "\"\<Image Size\>\""}], "}"}], 
        ",", "200", ",", "1024"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.59120316463984*^9, 3.591203200905647*^9}, {
   3.5912032457410545`*^9, 3.5912032483004546`*^9}, {3.591203381544077*^9, 
   3.591203408891882*^9}, {3.591203471559092*^9, 3.5912035820739107`*^9}, {
   3.591203649093522*^9, 3.5912039848331785`*^9}, {3.5912040269697857`*^9, 
   3.591204072788993*^9}, {3.591204184473412*^9, 3.5912042900572295`*^9}, {
   3.591204448698656*^9, 3.591204477544061*^9}, 3.591204524689269*^9, {
   3.5912046178232846`*^9, 3.591204703001299*^9}, {3.591204740583705*^9, 
   3.591204751441307*^9}, {3.591204795028714*^9, 3.591204809895517*^9}, {
   3.5912048573049245`*^9, 3.5912048985835314`*^9}, {3.591204996757348*^9, 
   3.59120547170783*^9}, 3.5912055478066425`*^9, {3.591205633375657*^9, 
   3.591205634530057*^9}, {3.602863119698246*^9, 3.6028631435508995`*^9}, {
   3.602863326333982*^9, 3.602863341637645*^9}, {3.6028633791889987`*^9, 
   3.602863404601503*^9}, {3.6028635302796173`*^9, 3.6028635387504525`*^9}, {
   3.602863572119989*^9, 3.6028635954274845`*^9}, {3.602907746380173*^9, 
   3.602907747050976*^9}, {3.6029079180276766`*^9, 3.602907999194809*^9}, {
   3.602908274395536*^9, 3.60290840958569*^9}, {3.6029085112357063`*^9, 
   3.602908531484589*^9}, {3.602908568456741*^9, 3.6029087006828823`*^9}, {
   3.6029087587151203`*^9, 3.6029088589611306`*^9}, {3.602908912999752*^9, 
   3.6029090093457465`*^9}, {3.60290907603602*^9, 3.602909110746162*^9}, {
   3.6029091508695264`*^9, 3.60290925670036*^9}, {3.6029093312218647`*^9, 
   3.602909435976294*^9}, {3.6029094758344574`*^9, 3.602909485553297*^9}, {
   3.602909516347823*^9, 3.6029095407307234`*^9}, {3.6029096242378654`*^9, 
   3.602909806275011*^9}, {3.602909862669242*^9, 3.6029102494260263`*^9}, {
   3.6029102871001806`*^9, 3.602910383430575*^9}, {3.602910532785587*^9, 
   3.6029105480112495`*^9}, {3.6029129812300544`*^9, 3.602912985566872*^9}, {
   3.602913061851185*^9, 3.602913749892003*^9}, {3.602913800670211*^9, 
   3.6029139105102606`*^9}, {3.6029139406651845`*^9, 3.602914016278694*^9}, {
   3.602914085293377*^9, 3.6029141101286783`*^9}, {3.602914512376326*^9, 
   3.6029145213775635`*^9}, {3.6029153914339275`*^9, 
   3.6029154409017305`*^9}, {3.602918379914773*^9, 3.6029183821611824`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hyperbolic geometry: Canonical fundamental regions", "Subsection",
 CellChangeTimes->{{3.599827542829562*^9, 3.599827557415626*^9}, 
   3.612624161714369*^9}],

Cell["\<\
The following function finds a hyperbolic rigid motion A of the upper \
half-plane (that is a M\[ODoubleDot]bius transformation with real coefficients)
which maps two points z\[CloseCurlyQuote] and w\[CloseCurlyQuote] on the unit \
disk with Im[z\[CloseCurlyQuote]]=Im[w\[CloseCurlyQuote]]
to the given points z and w on the upper half-plane.
* The hyperbolic line joing z and w is given by the image of the unit disk \
under A.
* The hyperbolic perpendicular bisector of z and w is given by the image of \
the imaginary axis under A.
Note: I\[CloseCurlyQuote]m sure that this can be done smarter and faster...\
\>", "Text",
 CellChangeTimes->{{3.6029167360658355`*^9, 3.602916994636894*^9}, {
  3.6029177311471114`*^9, 3.602917770053671*^9}, {3.612249778773775*^9, 
  3.6122497801943755`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindHypMotion", "[", 
    RowBox[{"z_", ",", "w_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mat", ",", "\[Gamma]", ",", "\[Lambda]", ",", "\[Mu]", ",", "sol"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mat", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "w"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Lambda]", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "\[Mu]"}], "}"}]}], "}"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "\[Gamma]"}], "}"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{
        RowBox[{"FindInstance", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "@", "mat"}], "\[Element]", "Reals"}], ",", 
            RowBox[{
             RowBox[{"Abs", "@", "\[Gamma]"}], "\[Equal]", "1"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "\[Lambda]", ",", "\[Mu]"}], "}"}]}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mat", "/.", "sol"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.599837452860448*^9, 3.5998375107130504`*^9}, {
   3.5998375655205684`*^9, 3.5998376542590265`*^9}, {3.599837743694504*^9, 
   3.5998377518877306`*^9}, 3.5998408541986623`*^9}],

Cell["\<\
ModSubgroupQ returns a membership predicate for the certain subgroups of the \
modular group: \
\>", "Text",
 CellChangeTimes->{{3.6029170168669853`*^9, 3.6029170778788357`*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "ModSubgroupQ", "]"}]], "Input",
 CellChangeTimes->{{3.599839876648585*^9, 3.5998398807116976`*^9}, 
   3.5998408542026625`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ModSubgroupQ", "[", 
    RowBox[{"\"\<\[CapitalGamma]\>\"", ",", "n_"}], "]"}], ":=", 
   RowBox[{"True", "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModSubgroupQ", "[", 
    RowBox[{"\"\<\[CapitalGamma](n)\>\"", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Abs", "@", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"Mat", "@", "#"}], ",", "n", ",", 
         RowBox[{
          RowBox[{"-", "n"}], "/", "2"}]}], "]"}]}], "\[Equal]", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ")"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModSubgroupQ", "[", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \(0\)]\)(n)\>\"", ",", 
     "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MatchQ", "[", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"Mat", "@", "#"}], ",", "n"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "_"}], "}"}]}], "}"}]}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModSubgroupQ", "[", 
    RowBox[{
    "\"\<\!\(\*SuperscriptBox[\(\[CapitalGamma]\), \(0\)]\)(n)\>\"", ",", 
     "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MatchQ", "[", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"Mat", "@", "#"}], ",", "n"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModSubgroupQ", "[", 
    RowBox[{
    "\"\<\!\(\*SubsuperscriptBox[\(\[CapitalGamma]\), \(0\), \(0\)]\)(n)\>\"",
      ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MatchQ", "[", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"Mat", "@", "#"}], ",", "n"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "_"}], "}"}]}], "}"}]}], "]"}], "&"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.5998384427408667`*^9, 3.599838772578003*^9}, {
   3.5998390935148926`*^9, 3.599839141816231*^9}, 3.5998408542076626`*^9}],

Cell[TextData[{
 "A canonical fundamental domain for a subgroup G of the modular group can be \
found the following way:\n* Fix a point z on the upper halfplane.\n* For each \
g \[Element] G\\{1}, determine the hyperbolic perpendicular bisector ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "g"], TraditionalForm]]],
 " of the hyperbolic line through z and gz.\n* ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["L", "g"], TraditionalForm]]],
 " splits the hyperbolic plane (that is the upper half-plane) into two \
hyperbolic half-planes ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "g"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["B", "g"], TraditionalForm]]],
 ", where z \[Element] ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "g"], TraditionalForm]]],
 " and gz \[Element] ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["B", "g"], TraditionalForm]]],
 ".\n* The points w \[Element] ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "g"], TraditionalForm]]],
 " are characterized by the property d(w,z) < d(w,gz), where d is the \
hyperbolic distance metric.\n* The canonical fundamental domain (with respect \
to the point z) is the intersection of all these half-planes ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "g"], TraditionalForm]]],
 ", g \[Epsilon] G.\n\nA canonical fundamental domain F is therefore \
characterized by the property d(w,z) < d(w,gz) for all w \[Element] F and g \
\[Element] G."
}], "Text",
 CellChangeTimes->{{3.6029170901248856`*^9, 3.602917703113796*^9}, {
  3.6029178098806343`*^9, 3.6029179478787994`*^9}, {3.6029180262847204`*^9, 
  3.60291809940222*^9}, {3.602918252477851*^9, 3.602918271931131*^9}}],

Cell[TextData[StyleBox["WARNING: The following demonstration is in a \
preliminary state and neither optimized for speed nor well-tested.",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.612249871445817*^9, 3.6122499414480486`*^9}, {
  3.6122499836022673`*^9, 3.6122500239156857`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"modgrp", ",", "GetHypMotion", ",", "oldz"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"modgrp", "=", 
     RowBox[{"ModularGroupList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PSL2ZGrading", "@", 
         RowBox[{"Mat", "@", "#"}]}], "<", "300"}], "&"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"modgrp", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{"modgrp", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"PSL2ZGrading", "@", 
           RowBox[{"Mat", "@", "#1"}]}], "<", 
          RowBox[{"PSL2ZGrading", "@", 
           RowBox[{"Mat", "@", "#2"}]}]}], ")"}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"subgrp", ",", "z", ",", "ws", ",", "m", ",", "ts"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"subgrp", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"modgrp", ",", 
            RowBox[{"ModSubgroupQ", "[", 
             RowBox[{"subgroup", ",", "n"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"z", "=", 
          RowBox[{"Complex", "@@", 
           RowBox[{"Rationalize", "@", "P"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"TrueQ", "[", 
             RowBox[{"oldz", "\[Equal]", "z"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"oldz", "=", "z"}], ";", "\[IndentingNewLine]", 
            RowBox[{"ClearAll", "[", "GetHypMotion", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"GetHypMotion", "[", 
              RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
             RowBox[{
              RowBox[{"GetHypMotion", "[", 
               RowBox[{"a", ",", "b"}], "]"}], "=", 
              RowBox[{"FindHypMotion", "[", 
               RowBox[{"a", ",", "b"}], "]"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"ws", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "z", "]"}], "&"}], "/@", "subgrp"}], ",", 
            "z"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "ws"}], ">", "max"}], ",", 
           RowBox[{"ws", "=", 
            RowBox[{"Take", "[", 
             RowBox[{"ws", ",", "max"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ts", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"GetHypMotion", "[", 
             RowBox[{"z", ",", "#"}], "]"}], "&"}], "/@", "ws"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Re", "@", "#"}], ",", 
                    RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "/@", "ws"}], 
                "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Opacity", "[", "0.1", "]"}], ",", "Black", ",", 
               RowBox[{"GDisk", "[", 
                RowBox[{"gdRightHalfplane", ",", "ts"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Gray", ",", "Dashed", ",", 
               RowBox[{"GCircle", "[", 
                RowBox[{"gdUnitDisk", ",", "ts"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"GCircle", "[", 
               RowBox[{"gdRightHalfplane", ",", "ts"}], "]"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"White", ",", 
               RowBox[{"GDisk", "[", "gdLowerHalfplane", "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", "z"}]}], "\[IndentingNewLine]", 
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"P", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"3", "/", "2"}]}], "}"}]}], "}"}], ",", "Locator", ",", 
        RowBox[{"ContinuousAction", "\[Rule]", "False"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "subgroup", ",", "\"\<\[CapitalGamma]\>\"", ",", 
          "\"\<Subgroup\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\[CapitalGamma]\>\"", ",", "\"\<\[CapitalGamma](n)\>\"", ",", 
          "\"\<\!\(\*SubscriptBox[\(\[CapitalGamma]\), \(0\)]\)(n)\>\"", ",", 
          "\"\<\!\(\*SuperscriptBox[\(\[CapitalGamma]\), \(0\)]\)(n)\>\"", 
          ",", "\"\<\!\(\*SubsuperscriptBox[\(\[CapitalGamma]\), \(0\), \
\(0\)]\)(n)\>\""}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"n", ",", "2", ",", "5", ",", "1", ",", 
        RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"max", ",", "9", ",", "\"\<max. Transformations\>\""}], 
         "}"}], ",", "1", ",", "20", ",", "1", ",", 
        RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.5997488282997217`*^9, 3.5997491030443325`*^9}, {
   3.5997492310428777`*^9, 3.599749477153695*^9}, {3.599749521322918*^9, 
   3.5997497614495697`*^9}, {3.599749809913912*^9, 3.5997498436418457`*^9}, {
   3.599749879618843*^9, 3.5997501179224434`*^9}, {3.599750149011305*^9, 
   3.5997502343106675`*^9}, {3.5997502807469535`*^9, 3.59975032756225*^9}, {
   3.5997504595609064`*^9, 3.599750538613096*^9}, {3.599750593649621*^9, 
   3.5997506672776604`*^9}, {3.599750724894256*^9, 3.59975074958794*^9}, {
   3.599750783987893*^9, 3.599750787663995*^9}, 3.599750891385868*^9, {
   3.5997516865928946`*^9, 3.5997519086170444`*^9}, {3.5997519425679846`*^9, 
   3.5997520399656825`*^9}, {3.599752087381996*^9, 3.599752145463605*^9}, {
   3.599752193134925*^9, 3.599752200661134*^9}, {3.599752270234061*^9, 
   3.5997524461579337`*^9}, {3.5997524912741833`*^9, 
   3.5997525337813606`*^9}, {3.5997525888888874`*^9, 
   3.5997525925609894`*^9}, {3.5997526897876825`*^9, 
   3.5997526908907127`*^9}, {3.5997527433051643`*^9, 
   3.5997527507373705`*^9}, {3.5997528373777704`*^9, 
   3.5997528533422127`*^9}, {3.599752973046528*^9, 3.599753057412865*^9}, {
   3.5997531397001443`*^9, 3.599753151034458*^9}, {3.5997531935886374`*^9, 
   3.5997532367738333`*^9}, {3.5997532806120477`*^9, 3.599753453213828*^9}, {
   3.599753484003681*^9, 3.599753497102044*^9}, {3.5997535759922295`*^9, 
   3.5997535782302914`*^9}, {3.5997536466641865`*^9, 3.599753678146059*^9}, {
   3.5997537487740154`*^9, 3.599753781641926*^9}, {3.59975383087729*^9, 
   3.599753863895204*^9}, {3.5997539678720837`*^9, 3.5997539918897495`*^9}, {
   3.5997540275347366`*^9, 3.599754076854103*^9}, {3.5997541180192432`*^9, 
   3.5997541435539503`*^9}, {3.5997541821860204`*^9, 3.599754182286023*^9}, {
   3.5997542256892257`*^9, 3.5997542356315007`*^9}, {3.5997542967341933`*^9, 
   3.5997543646280737`*^9}, {3.599754559990485*^9, 3.599754635078565*^9}, {
   3.599754725293064*^9, 3.599754731105225*^9}, {3.5997547829986625`*^9, 
   3.599754844088355*^9}, {3.5997548854124994`*^9, 3.5997548880225716`*^9}, {
   3.5997549746509714`*^9, 3.599754992963478*^9}, {3.599755180691678*^9, 
   3.5997551933310285`*^9}, {3.599755267254076*^9, 3.5997552816784754`*^9}, {
   3.5997553146393886`*^9, 3.599755317241461*^9}, {3.599755350753389*^9, 
   3.599755363649746*^9}, {3.599837910372121*^9, 3.599838090233103*^9}, {
   3.599838120783949*^9, 3.5998381238180327`*^9}, {3.5998388025498333`*^9, 
   3.5998388403178797`*^9}, {3.5998390502556944`*^9, 3.599839058190914*^9}, {
   3.5998391466143637`*^9, 3.5998391966247487`*^9}, {3.599839328189393*^9, 
   3.599839565107956*^9}, {3.599839618988448*^9, 3.599839631016781*^9}, {
   3.5998396632086725`*^9, 3.599839668128809*^9}, {3.5998397487400417`*^9, 
   3.5998397924072514`*^9}, {3.5998399275069933`*^9, 3.599839935757222*^9}, {
   3.5998400222736187`*^9, 3.599840031610877*^9}, {3.599840099647762*^9, 
   3.5998401064559507`*^9}, {3.5998403180098104`*^9, 3.599840467863961*^9}, {
   3.5998405091791058`*^9, 3.599840530886707*^9}, {3.5998405969665375`*^9, 
   3.5998405971775427`*^9}, {3.5998406272493763`*^9, 3.599840630575468*^9}, {
   3.599840661007311*^9, 3.5998406637823877`*^9}, {3.5998407090206413`*^9, 
   3.5998407090986433`*^9}, {3.599840766535234*^9, 3.5998407667692404`*^9}, 
   3.5998408542146626`*^9, {3.5998411050076094`*^9, 3.5998411111907806`*^9}, {
   3.599841168280362*^9, 3.599841193864071*^9}, {3.5998412324391394`*^9, 
   3.5998412334951687`*^9}, {3.5998413913015394`*^9, 
   3.5998414525272355`*^9}, {3.5998415206951237`*^9, 3.599841549159912*^9}, {
   3.5998416385483885`*^9, 3.5998416386623917`*^9}, {3.602855388105488*^9, 
   3.6028554032749033`*^9}, {3.6028554351157756`*^9, 3.602855478280958*^9}, {
   3.602855893609338*^9, 3.602855971994486*^9}, 3.602856140954115*^9, {
   3.6028611649646873`*^9, 3.6028612220732527`*^9}, {3.6031132557596507`*^9, 
   3.6031132708110633`*^9}, {3.6122495133691373`*^9, 3.612249526038494*^9}, {
   3.612249571871482*^9, 3.6122495910760903`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The modular Group and continued fractions", "Subsection",
 CellChangeTimes->{{3.5912057333882737`*^9, 3.591205747132876*^9}, 
   3.6126241707576237`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MyTicks", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"min_", ",", "max_"}], "}"}], ",", "special_List", ",", 
     "n_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ticks", ",", "spInRange"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"spInRange", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"special", ",", 
         RowBox[{
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{
            RowBox[{"Interval", "[", 
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}], "]"}], ",", "#"}], "]"}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"N", "@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"FindDivisions", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}], ",", "n"}], "]"}], ",", 
           RowBox[{
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"#", "-", "spInRange"}], "]"}], "\[GreaterEqual]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"max", "-", "min"}], ")"}], "/", "n"}]}], "]"}], 
              ")"}]}], "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        "spInRange"}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MyContinuedFraction", "[", 
    RowBox[{"x_", ",", "n_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "c", ",", 
       RowBox[{"t", "=", "x"}], ",", 
       RowBox[{"cs", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "=", "0"}], ";", 
         RowBox[{"c", "=", 
          RowBox[{"Quotient", "[", 
           RowBox[{"t", ",", "1", ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"i", "<", "n"}], "&&", 
         RowBox[{
          RowBox[{"t", "-", "c"}], "\[NotEqual]", "0"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t", "=", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"t", "-", "c"}], ")"}]}]}], ";", 
         RowBox[{"c", "=", 
          RowBox[{"Quotient", "[", 
           RowBox[{"t", ",", "1", ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]}], "]"}]}], ";", 
         RowBox[{"i", "++"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"cs", "=", 
         RowBox[{"{", 
          RowBox[{"cs", ",", "c"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "<", "n"}], ",", 
        RowBox[{"cs", "=", 
         RowBox[{"{", 
          RowBox[{"cs", ",", "c"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "@", "cs"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ModularConvergents", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"quotients", ",", "_Integer", ",", "1"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sgn", ",", "i", ",", "m"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sgn", "=", 
         RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sgn", "*=", 
            RowBox[{"-", "1"}]}], ";", 
           RowBox[{"m", "=", 
            RowBox[{"m", ".", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"sgn", " ", 
                  RowBox[{"quotients", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "}"}]}]}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "quotients", "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.590592634155904*^9, 3.590592695004449*^9}, {
  3.590599370173994*^9, 3.590599452657089*^9}, {3.590851735752557*^9, 
  3.590851736516958*^9}, {3.591194515374296*^9, 3.591194515599303*^9}, {
  3.5911962490476646`*^9, 3.5911962665081515`*^9}, {3.5911963964277763`*^9, 
  3.5911965371237016`*^9}, {3.5911966313813314`*^9, 3.591196676064578*^9}, {
  3.591196837252075*^9, 3.5911968509474573`*^9}, {3.5911969342677813`*^9, 
  3.5911969414349813`*^9}, {3.5911969885282955`*^9, 3.591196994017449*^9}, {
  3.5917894791923637`*^9, 3.5917895316348267`*^9}, {3.591789648343083*^9, 
  3.591789648873098*^9}, {3.591870044418598*^9, 3.5918700475541987`*^9}, {
  3.5918898558864393`*^9, 3.5918898788340435`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ModularAuxConvergents", "[", "quotients_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"exponents", ",", "list", ",", "factors"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"exponents", "=", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{
             RowBox[{"First", "@", "#2"}], "+", "1"}]], "#1"}], "&"}], ",", 
         "quotients"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"list", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Riffle", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"Sign", "@", "#"}], ",", 
              RowBox[{"Abs", "@", "#"}]}], "]"}], "&"}], "/@", "exponents"}], 
          ",", "\[IndentingNewLine]", "0", ",", "2"}], "\[IndentingNewLine]", 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"list", ">", "100"}], "]"}], ",", 
        RowBox[{"list", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"list", ",", "100"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"factors", "=", 
       RowBox[{"list", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"0", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"1", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"FoldList", "[", 
       RowBox[{"Dot", ",", 
        RowBox[{"IdentityMatrix", "@", "2"}], ",", "factors"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5918456239560676`*^9, 3.5918458487761073`*^9}, {
   3.5918459111605177`*^9, 3.591845936884922*^9}, {3.5918459814073296`*^9, 
   3.591845995837332*^9}, {3.5918460628081427`*^9, 3.591846086442147*^9}, {
   3.5918461651441603`*^9, 3.5918461752685614`*^9}, {3.591846254407375*^9, 
   3.5918462665909767`*^9}, {3.5918642620544257`*^9, 3.591864277701228*^9}, {
   3.5918643522848406`*^9, 3.5918644189436517`*^9}, {3.591864475322061*^9, 
   3.591864548158473*^9}, {3.5918645867684793`*^9, 3.5918647078712997`*^9}, 
   3.5918648552913246`*^9, {3.5918650247541523`*^9, 3.591865081506962*^9}, {
   3.591866802171649*^9, 3.591866983084879*^9}, {3.5918671822657123`*^9, 
   3.591867194527314*^9}, {3.5918672290501204`*^9, 3.5918672809825287`*^9}, {
   3.5918674605697584`*^9, 3.5918674664509597`*^9}, {3.5918675123305674`*^9, 
   3.591867513266567*^9}, {3.591867661435392*^9, 3.5918677704482102`*^9}, {
   3.5918899453056545`*^9, 3.5918899509996557`*^9}}],

Cell[TextData[{
 "The following is a demonstration for nearest integer continued fraction \
representations of arbitrary numbers (any ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " expression may be used as input). Be careful with too high zoom factors - \
errors may occur due to machine-precision calculations."
}], "Text",
 CellChangeTimes->{{3.612250257730991*^9, 3.6122503186358185`*^9}, {
  3.6122503993884554`*^9, 3.612250723044402*^9}, {3.6122507584739447`*^9, 
  3.6122509113146505`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "mtList", ",", "mtPreviewList", ",", "quotients", ",", "convergents", ",",
      "controlPoints", ",", "f", ",", "m", ",", "plotRange", ",", "zf", ",", 
     "ts", ",", "viewCenter"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mtList", "=", 
     RowBox[{"ModularGroupList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PSL2ZGrading", "@", 
         RowBox[{"Mat", "@", "#"}]}], "<", "100"}], "&"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mtPreviewList", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"mtList", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"PSL2ZGrading", "@", 
          RowBox[{"Mat", "@", "#"}]}], "<", "25"}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"quotients", "=", 
        RowBox[{"MyContinuedFraction", "[", 
         RowBox[{"number", ",", "6"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"convergents", "=", 
        RowBox[{"ModularConvergents", "[", "quotients", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"controlPoints", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Re", "@", "#"}], ",", 
            RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "/@", 
         RowBox[{"GDiskMatCenter", "[", 
          RowBox[{"GDiskMatMap", "[", 
           RowBox[{
            RowBox[{"Mat", "@", "gdIncircle0"}], ",", "convergents"}], "]"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"f", "=", 
        RowBox[{"BSplineFunction", "[", 
         RowBox[{"controlPoints", ",", 
          RowBox[{"SplineDegree", "\[Rule]", "2"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ts", "=", 
           RowBox[{"ControlActive", "[", 
            RowBox[{"mtPreviewList", ",", "mtList"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"m", "=", 
           RowBox[{"convergents", "[", 
            RowBox[{"[", 
             RowBox[{"1", "+", 
              RowBox[{"Floor", "[", 
               RowBox[{"t", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Length", "[", "convergents", "]"}], "-", "1"}], 
                 ")"}]}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"viewCenter", "=", 
           RowBox[{"f", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"zf", "=", " ", 
           RowBox[{"viewCenter", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"plotRange", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"viewCenter", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", 
              RowBox[{"GoldenRatio", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "zf"}], ",", "zf"}], "}"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", "zf"}]}], "}"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ModularTiling", "[", 
               RowBox[{"ts", ",", "m", ",", "\[IndentingNewLine]", 
                RowBox[{"FordDiskMode", "\[Rule]", "GDisk"}], ",", 
                RowBox[{"FordDiskStyle", "\[Rule]", "LightGray"}], ",", 
                RowBox[{"FordDiskThreshold", "\[Rule]", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"IncircleMode", "\[Rule]", "GDisk"}], ",", 
                RowBox[{"IncircleStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"White", ",", 
                   RowBox[{"EdgeForm", "[", "Gray", "]"}]}], "]"}]}], ",", 
                RowBox[{"IncircleThreshold", "\[Rule]", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"TilingStyle", "\[Rule]", "Gray"}], ",", " ", 
                RowBox[{"TilingThreshold", "\[Rule]", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"ExteriorMode", "\[Rule]", "Off"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"LabelMode", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "+", "1"}]], 
                    RowBox[{"Last", "@", "#"}]}], "&"}], "@", 
                    RowBox[{"TUExponents", "[", 
                    RowBox[{
                    RowBox[{"m", ".", 
                    RowBox[{"Mat", "@", "#"}]}], ",", 
                    RowBox[{
                    "QuotientFunction", "\[Rule]", "CentralQuotient"}]}], 
                    "]"}]}], "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"Magnification", "\[Rule]", 
                 RowBox[{"8", "/", "zf"}]}], ",", 
                RowBox[{"LabelThreshold", "\[Rule]", 
                 RowBox[{
                  SuperscriptBox["2", 
                   RowBox[{"-", "4"}]], "zf"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"FordLabelMode", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Inhom", "[", 
                    RowBox[{"m", ".", 
                    RowBox[{"(", 
                    RowBox[{"Mat", "@", "#"}], ")"}], ".", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "&"}], ")"}]}], 
                ",", 
                RowBox[{"FordLabelThreshold", "\[Rule]", 
                 RowBox[{
                  SuperscriptBox["2", 
                   RowBox[{"-", "3"}]], "zf"}]}]}], "\[IndentingNewLine]", 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Yellow", ",", 
                RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
                RowBox[{"GDisk", "[", 
                 RowBox[{"gdIncircle0", ",", "convergents"}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"White", ",", 
                RowBox[{"Rectangle", "[", 
                 RowBox[{
                  RowBox[{"Scaled", "@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], ",", 
                  RowBox[{"Scaled", "@", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "0"}], "}"}]}]}], "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
            RowBox[{"Axes", "\[Rule]", "True"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
            RowBox[{"Ticks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"MyTicks", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#1", ",", "#2"}], "}"}], ",", 
                  RowBox[{"{", "number", "}"}], ",", "12"}], "]"}], "&"}], 
               ",", "Automatic"}], "}"}]}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", 
             RowBox[{"Row", "@", 
              RowBox[{"{", 
               RowBox[{"number", ",", "\"\<: \>\"", ",", "quotients"}], 
               "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "\"\<Zoom\>\""}], "}"}], ",", "0", 
           ",", "1", ",", 
           RowBox[{"ControlType", "\[Rule]", "Animator"}], ",", 
           RowBox[{"DefaultDuration", "\[Rule]", "30"}], ",", 
           RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"number", ",", "GoldenRatio", ",", "\"\<Number\>\""}], "}"}],
         ",", 
        RowBox[{"ControlType", "\[Rule]", "InputField"}]}], "}"}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellOpen->True,
 CellChangeTimes->CompressedData["
1:eJwd0VtImgEUB3DpjlFB0Ijlw+ylCwbLVRvLxC+6ZwUlSRYUtWh0UVgprYJc
bFDSRUMqjCxzGxFZJDYYQV90EZuEVIvVipAVXaQxZrA5jdr3/x4Ov5dzzh/O
YdfKSuv9GAxGAlVQv7w3srnmIqYsnaPwgSB5Ag7ai2h3NQ4jTDM9fw+9EtUM
LAn3X4QeAXcJ6oucn6HN2rcCC4/mSHie6LcBpYs+B/xJvvBAnlrqg6WWrnt6
fnMv2ErZ3PwyEjb5NFFwQcl+CHMmhSyoWPrEhmVPObHQqq2Mg+upzHhYcPqL
CztavqbBV1XcDNh7IRdA5rw3G/LnRXmw9V+3EHrv3cWQp3vcCAM0LCm9Vz8l
h30r6td0X1n1Gxj07EcPjM9dV0OdxKSFzlzeOJ2/b5iAVaY2A7Q0DE3D6B3T
DNTwi2dh5pn5YItSVhHxHYocYSdw9O2xEz4567mFY2Zx0BfcMdoYCnsDjDGw
hmBxoNaSngI9cjsflv8VZ8JVsv4Q5pHKY6i7kQXaKVUZIUz4qKJbdUo5Z/s2
AltbFAb4USL8ALt4d2aY9OeQhOHt/fvn+FdB0wHMyl8Q/6aUZC3TNsoGtqHg
Uk/b/i604xZ5dQolvHa7OddbLmLNPJQEbQM7IbtXLmJYRITB/0KJiLg=
  "]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Thesis figures", "Section",
 CellChangeTimes->{{3.612630569432061*^9, 3.612630595336792*^9}, {
  3.612630843294784*^9, 3.612630856907168*^9}}],

Cell[TextData[{
 "This section lists the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " commands used to to create the figures of the diploma thesis ",
 StyleBox["Computer Algebra and Analysis: Complex Variables Visualized",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.61263060306901*^9, 3.6126308226942034`*^9}, {
  3.612630862230318*^9, 3.6126308775347495`*^9}}],

Cell[CellGroupData[{

Cell["Circle inversion", "Subsection",
 CellChangeTimes->{{3.595510388254083*^9, 3.595510391349166*^9}, 
   3.6126308860899906`*^9}],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t", "=", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "1"}], "]"}]}], ",", 
     RowBox[{"phi", "=", "0.3"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"p", "=", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0"}], "}"}]}], ",", 
       RowBox[{"q", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "t"}], ",", "0"}], "}"}]}], ",", "n1", ",", "n2", 
       ",", "m"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n1", "=", 
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"t", " "}], "2"]}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n2", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}], ".", "n1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"RotationMatrix", "[", "phi", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c", ",", "p", ",", "q", ",", "n1", ",", "n2"}], "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c", ",", "p", ",", "q", ",", "n1", ",", "n2"}], "}"}], ".", 
        RowBox[{"Transpose", "@", "m"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Darker", "@", "Green"}], ",", 
            RowBox[{"Circle", "[", 
             RowBox[{"c", ",", "1"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Darker", "@", "Green"}], ",", 
            RowBox[{"Arrow", "@", 
             RowBox[{"{", 
              RowBox[{"c", ",", 
               RowBox[{"c", "+", 
                RowBox[{"m", ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.6"}], ",", "0.8"}], "}"}]}]}]}], "}"}]}], 
            ",", 
            RowBox[{"Text", "[", 
             RowBox[{"\"\<r\>\"", ",", 
              RowBox[{"c", "+", 
               RowBox[{
                RowBox[{"m", ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.6"}], ",", "0.8"}], "}"}]}], "/", "2"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"Line", "@", 
             RowBox[{"{", 
              RowBox[{"c", ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{
                 RowBox[{"m", ".", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "0"}], "}"}]}], ",", "q"}], "]"}]}], 
              "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Dashed", ",", 
            RowBox[{"Line", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Scaled", "[", 
                RowBox[{
                 RowBox[{"m", ".", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], ",", "p"}], "]"}], ",", 
               RowBox[{"Scaled", "[", 
                RowBox[{
                 RowBox[{"m", ".", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], ",", "p"}], "]"}]}], 
              "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Dashed", ",", 
            RowBox[{"Circle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"c", "+", "q"}], ")"}], "/", "2"}], ",", 
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"q", "-", "c"}], "]"}], "/", "2"}]}], "]"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "@", "Medium"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"pt", ",", "label"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Point", "[", "pt", "]"}], ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{"label", ",", "pt", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1.5"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
             "@@@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"c", ",", "\"\<C\>\""}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"p", ",", "\"\<P\>\""}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"q", ",", "\"\<Q\>\""}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Point", "/@", 
             RowBox[{"{", 
              RowBox[{"n1", ",", "n2"}], "}"}]}]}], "\[IndentingNewLine]", 
           "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "3"}], "}"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "}"}], "+", "0.25"}]}], "}"}]}],
         ",", 
        RowBox[{"ImageSize", "\[Rule]", "200"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0VsoQwEcBvDREisryQNhm1z24lIuW1LMEpamMUSNkoOsrM2IYbI0opZc
lhinJIU1UoQohQc8eFrWWrZyyzJyick05zsP/3711df38Oc1q6qIUAaDkUAd
vAhmVd6de0UXW5u0GV8TtbCg3FgPA59hjfBwTeyC+eyaN3hXanuHXL73G0rT
x/zwZLTlD+ZERofcU67c7LBgckddDPQmxcZC/+58HJ237ifCPsLAgRuXe3x4
ZbNkQud1QAh1ijMxXFe4JXS/8KMG1pN22SOlZPK4Aca/+tpgp72nHQ5vm/Sw
O/TFBJeHHmZgUXXZLGRaHYswV/xDQrdZlfqEPaeGtlhKCCBTaRHCCt+ACB6U
bNOSAY8UPk9HyaBjqqsOHhkWaCuaYhSQe2sl4NyvWgn9re+0RrJaDcN/dFqY
7ZH3wxFtmh6aT3uX8uxeESeCRcJxLk8noNS4hIMwdVXOYz9R/0oJJsN/3d8V
Bw==
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Modified Cayley Transform, Stereographic Projection", "Subsection",
 CellChangeTimes->{{3.5898633737382154`*^9, 3.589863403581113*^9}, 
   3.612630893672205*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "phi", ",", "disk", ",", "cone", ",", "rays", ",", "halfSphere", ",", 
     "regionPlot", ",", "plots", ",", "figure", ",", "plots2", ",", 
     "figure2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"halfSphere", "=", 
     RowBox[{
      RowBox[{"ParametricPlot3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "phi", "]"}], 
           RowBox[{"Cos", "[", "theta", "]"}]}], ",", 
          RowBox[{"Sin", "[", "theta", "]"}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", "phi", "]"}]}], 
           RowBox[{"Cos", "[", "theta", "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"phi", ",", 
          RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"theta", ",", "0", ",", 
          RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "6"}], ",", 
        RowBox[{"Mesh", "\[Rule]", "False"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Darker", "@", "Green"}], "}"}]}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rays", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1_", ",", "p2_"}], "}"}], ",", "r_"}], "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Line", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"p1", "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"r", " ", 
              RowBox[{"Cos", "[", "alpha", "]"}]}], ",", 
             RowBox[{"r", " ", 
              RowBox[{"Sin", "[", "alpha", "]"}]}], ",", "0"}], "}"}]}], ",", 
          "p2"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"alpha", ",", "0", ",", 
         RowBox[{"11", 
          RowBox[{"Pi", "/", "6"}]}], ",", 
         RowBox[{"Pi", "/", "6"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cone", "[", "disk_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c", ",", "r", ",", "color"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"InstanceQ", "[", "Halfplane", "]"}], "[", "disk", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"InstanceQ", "[", "CompactDisk", "]"}], "[", "disk", 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"c", "=", 
              RowBox[{"GDiskCenter", "[", "disk", "]"}]}], ";", 
             RowBox[{"r", "=", 
              RowBox[{"GDiskRadius", "[", "disk", "]"}]}], ";", 
             RowBox[{"color", "=", "Gray"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"c", "=", 
              RowBox[{"GDiskCocenter", "[", "disk", "]"}]}], ";", 
             RowBox[{"r", "=", 
              RowBox[{"GDiskCoradius", "[", "disk", "]"}]}], ";", 
             RowBox[{"color", "=", "Black"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"color", ",", 
            RowBox[{"rays", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"2", 
                   RowBox[{"Re", "[", "c", "]"}]}], ",", 
                  RowBox[{"2", 
                   RowBox[{"Im", "[", "c", "]"}]}], ",", 
                  RowBox[{"-", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
              RowBox[{"2", "r"}]}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]",
         "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"plots", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "=", 
         RowBox[{"New", "[", 
          RowBox[{"MoebiusTransformation", ",", 
           RowBox[{"MatrixPower", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"I", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", 
             RowBox[{"Mod", "[", 
              RowBox[{"t", ",", "4", ",", 
               RowBox[{"-", "2"}]}], "]"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"disk", "=", 
         RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"regionPlot", "=", 
         RowBox[{"RegionPlot", "[", 
          RowBox[{
           RowBox[{"InteriorQ", "[", 
            RowBox[{"disk", ",", 
             RowBox[{"x", "+", 
              RowBox[{"I", " ", "y"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
           RowBox[{"PlotPoints", "\[Rule]", "6"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
              RowBox[{"Lighter", "@", "Blue"}]}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<Re\>\"", ",", "\"\<Im\>\""}], "}"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", "False"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
                RowBox[{"Rotate", "[", 
                 RowBox[{"halfSphere", ",", 
                  RowBox[{"Pi", " ", 
                   RowBox[{"t", "/", "2"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], 
                 "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"regionPlot", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "/.", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x_Real", ",", "y_Real"}], "}"}], "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "0"}], "}"}]}]}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PointSize", "\[Rule]", "Large"}], ",", "Red", ",", 
                  RowBox[{"Point", "[", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}]}], "}"}], 
                ","}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Dashed", ",", 
                RowBox[{"cone", "[", "disk", "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "2"}], ",", 
            RowBox[{"Axes", "\[Rule]", "True"}], ",", 
            RowBox[{"AxesLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<Re\>\"", ",", "\"\<Im\>\"", ",", "\"\<\>\""}], 
              "}"}]}], ",", 
            RowBox[{"Ticks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "]"}]}], "}"}]}], ",", 
            RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
            RowBox[{"ViewPoint", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"5", ",", 
               RowBox[{"-", "1.8"}], ",", "2"}], "}"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", "regionPlot"}], "\[IndentingNewLine]", 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "3", ",", 
         RowBox[{"1", "/", "2"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"plots2", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "=", 
         RowBox[{"New", "[", 
          RowBox[{"MoebiusTransformation", ",", 
           RowBox[{"MatrixPower", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"I", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", 
             RowBox[{"Mod", "[", 
              RowBox[{"t", ",", "4", ",", 
               RowBox[{"-", "2"}]}], "]"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"disk", "=", 
         RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"regionPlot", "=", 
         RowBox[{"RegionPlot", "[", 
          RowBox[{
           RowBox[{"InteriorQ", "[", 
            RowBox[{"disk", ",", 
             RowBox[{"x", "+", 
              RowBox[{"I", " ", "y"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
           RowBox[{"PlotPoints", "\[Rule]", "6"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
              RowBox[{"Lighter", "@", "Blue"}]}], "}"}]}], ",", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<Re\>\"", ",", "\"\<Im\>\""}], "}"}]}], ",", 
           RowBox[{"Frame", "\[Rule]", "False"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
                RowBox[{"Rotate", "[", 
                 RowBox[{"halfSphere", ",", 
                  RowBox[{"Pi", " ", 
                   RowBox[{"t", "/", "2"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], 
                 "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"regionPlot", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "/.", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x_Real", ",", "y_Real"}], "}"}], "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "0"}], "}"}]}]}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"PointSize", "\[Rule]", "Large"}], ",", "Red", ",", 
                  RowBox[{"Point", "[", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}]}], "}"}], 
                ","}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Dashed", ",", 
                RowBox[{"cone", "[", "disk", "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "2"}], ",", 
            RowBox[{"Axes", "\[Rule]", "True"}], ",", 
            RowBox[{"AxesLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<Re\>\"", ",", "\"\<Im\>\"", ",", "\"\<\>\""}], 
              "}"}]}], ",", 
            RowBox[{"Ticks", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"-", "2"}], ",", "2"}], "]"}]}], "}"}]}], ",", 
            RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
            RowBox[{"ViewPoint", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"5", ",", 
               RowBox[{"-", "1.8"}], ",", "2"}], "}"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", "regionPlot"}], "\[IndentingNewLine]", 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "1", ",", 
         RowBox[{"1", "/", "3."}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"figure", "=", 
     RowBox[{"GraphicsGrid", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plots", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"plots", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"plots", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "+", "2"}], ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"plots", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "+", "2"}], ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Scaled", "[", ".25", "]"}], ",", 
          RowBox[{"Scaled", "[", ".5", "]"}]}], "}"}]}], ",", 
       RowBox[{"Dividers", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", "\[Rule]", "Black"}], "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"figure2", "=", 
     RowBox[{"GraphicsGrid", "[", 
      RowBox[{"plots2", ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Scaled", "[", ".5", "]"}], ",", 
          RowBox[{"Scaled", "[", ".25", "]"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Column", "@", 
     RowBox[{"{", 
      RowBox[{"figure", ",", "figure2"}], "}"}]}]}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.5857972063137493`*^9, 3.5857973418033805`*^9}, {
   3.5857974026090097`*^9, 3.5857974228625526`*^9}, {3.5857974860702467`*^9, 
   3.585797517080078*^9}, {3.585797553378051*^9, 3.585797612723641*^9}, {
   3.585797672085232*^9, 3.585797672788251*^9}, {3.5857977086012106`*^9, 
   3.5857977137113476`*^9}, {3.585797756150485*^9, 3.5857977568735037`*^9}, {
   3.58579790523348*^9, 3.5857979234929695`*^9}, {3.58579837390504*^9, 
   3.585798393864575*^9}, {3.585798460414358*^9, 3.585798490369161*^9}, {
   3.585798525457102*^9, 3.5857985411955233`*^9}, {3.5857985753744392`*^9, 
   3.5857986158305235`*^9}, {3.585798672897053*^9, 3.585798713943153*^9}, {
   3.5857988602480736`*^9, 3.58579893286802*^9}, {3.5857989985397797`*^9, 
   3.5857990881571817`*^9}, {3.585799208185398*^9, 3.585799222244775*^9}, {
   3.585799274223168*^9, 3.5857992981568093`*^9}, {3.5857993601094694`*^9, 
   3.5857994806347*^9}, {3.585799698779546*^9, 3.585799788271944*^9}, {
   3.585799851656643*^9, 3.585799889799665*^9}, {3.5857999221565323`*^9, 
   3.585799933442835*^9}, {3.585800019504141*^9, 3.585800030514436*^9}, {
   3.5858001194448195`*^9, 3.5858001230329156`*^9}, {3.585800158946878*^9, 
   3.5858001598199015`*^9}, {3.585801799588846*^9, 3.5858018309086857`*^9}, {
   3.5858022792337*^9, 3.5858022810757494`*^9}, {3.5858023287590275`*^9, 
   3.585802368928104*^9}, {3.5858024183454285`*^9, 3.5858025292454004`*^9}, {
   3.5858025911160583`*^9, 3.585802614870695*^9}, {3.58580271544039*^9, 
   3.5858027720049057`*^9}, {3.585802804679782*^9, 3.585802810058926*^9}, {
   3.585802844097838*^9, 3.5858028495579844`*^9}, {3.5858028807918215`*^9, 
   3.5858028821468577`*^9}, {3.5858029519947295`*^9, 3.585802979173458*^9}, {
   3.5858030610296516`*^9, 3.585803078760127*^9}, {3.5858031250603676`*^9, 
   3.5858031277104387`*^9}, {3.585803326224759*^9, 3.5858033282348127`*^9}, {
   3.5858034868170624`*^9, 3.5858035039395213`*^9}, {3.5858036035081897`*^9, 
   3.5858036906945267`*^9}, {3.5858045504445667`*^9, 3.585804551974608*^9}, {
   3.5858046701747756`*^9, 3.585804737284574*^9}, {3.585804791126017*^9, 
   3.585804791898038*^9}, {3.585805026570327*^9, 3.585805115058698*^9}, {
   3.585805287028307*^9, 3.5858052873943167`*^9}, {3.5858053989773073`*^9, 
   3.5858055756190405`*^9}, {3.5858056224642963`*^9, 
   3.5858057129947224`*^9}, {3.585806186522413*^9, 3.585806190116509*^9}, {
   3.585806247401044*^9, 3.5858062647895103`*^9}, {3.5858063441736374`*^9, 
   3.5858065827460313`*^9}, {3.5858067596227713`*^9, 
   3.5858068033179426`*^9}, {3.585806846802108*^9, 3.5858068662416286`*^9}, {
   3.5858069615061817`*^9, 3.585806969063384*^9}, {3.587225160143324*^9, 
   3.5872252613409386`*^9}, {3.5872253288892155`*^9, 3.587225414767567*^9}, 
   3.587225476965022*^9, 3.587225522408008*^9, {3.587225554029338*^9, 
   3.587225567663793*^9}, {3.5872256079899583`*^9, 3.5872256097371655`*^9}, {
   3.587226013993427*^9, 3.587226028002284*^9}, {3.5930147648750105`*^9, 
   3.593014856761026*^9}, {3.59301500091088*^9, 3.59301500208088*^9}, {
   3.5930153555713396`*^9, 3.5930153556337395`*^9}, {3.61184907811373*^9, 
   3.6118491030269413`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Minimal region", "Subsection",
 CellChangeTimes->{{3.595508267242242*^9, 3.595508270618332*^9}, 
   3.612630901764433*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Lighter", "@", 
         RowBox[{"Lighter", "@", "Blue"}]}], ",", 
        RowBox[{"EdgeForm", "@", "Black"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"Scaled", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], ",", "0"}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "2"}], ",", "0"}], "}"}]}], "]"}]}], "]"}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"White", ",", 
        RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", "0"}], "}"}], ",", "1"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Transparent", ",", 
        RowBox[{"EdgeForm", "[", 
         RowBox[{"Directive", "[", 
          RowBox[{"Dashed", ",", "Black"}], "]"}], "]"}], ",", 
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"Scaled", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], ",", "0"}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "2"}], ",", "0"}], "}"}]}], "]"}]}], "]"}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "@", "Medium"}], ",", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"phi", ",", "label"}], "}"}], ",", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"coords", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Cos", "@", "phi"}], ",", 
                 RowBox[{"Sin", "@", "phi"}]}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Point", "[", "coords", "]"}], ",", 
               RowBox[{"Text", "[", 
                RowBox[{"label", ",", "coords", ",", 
                 RowBox[{
                  RowBox[{"-", "2"}], "coords"}]}], "]"}]}], "}"}]}], "]"}]}],
           "]"}], "@@@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Pi", "/", "3"}], ",", "\"\<T\[Rho]\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"Pi", "/", "3"}]}], ",", "\"\<\[Rho]\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"4", 
              RowBox[{"Pi", "/", "3"}]}], ",", "\"\<-T\[Rho]\>\""}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"5", 
              RowBox[{"Pi", "/", "3"}]}], ",", "\"\<-\[Rho]\>\""}], "}"}]}], 
          "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Dashed", ",", 
        RowBox[{"Circle", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}],
     ",", 
    RowBox[{"Axes", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2.2"}], ",", "2.2"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "#"}], ",", "#"}], "}"}], "&"}], "@", 
        "GoldenRatio"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5955063663262987`*^9, 3.59550650632305*^9}, {
  3.595506538193904*^9, 3.595506573401848*^9}, {3.5955066477378397`*^9, 
  3.5955066734605293`*^9}, {3.595506720993803*^9, 3.5955069284323626`*^9}, {
  3.595506989644003*^9, 3.595506993098095*^9}, {3.595507039407336*^9, 
  3.595507419054511*^9}, {3.595507750454392*^9, 3.5955077505703955`*^9}, {
  3.5955082852687244`*^9, 3.5955083882814856`*^9}, {3.595509317332383*^9, 
  3.595509340845013*^9}, {3.595509400703617*^9, 3.595509432781477*^9}, {
  3.5955094951841497`*^9, 3.595509498880248*^9}, {3.597836458711372*^9, 
  3.597836489491298*^9}, {3.597836656889984*^9, 3.597836658590391*^9}, {
  3.61184912305735*^9, 3.6118491417929583`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fundamental region", "Subsection",
 CellChangeTimes->{{3.5994652254733667`*^9, 3.5994652334605927`*^9}, 
   3.612630909881662*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gdA", ",", " ", "gdB"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gdA", "=", 
      RowBox[{"New", "[", 
       RowBox[{"Halfplane", ",", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gdB", " ", "=", 
      RowBox[{"New", "[", 
       RowBox[{"Halfplane", ",", " ", 
        RowBox[{"1", "/", "2"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"GDisk", "[", "gdA", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Green", ",", " ", 
             RowBox[{"GDisk", "[", "gdB", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Blue", ",", 
             RowBox[{"GDisk", "[", "gdUnitDisk", "]"}]}], "}"}]}], "}"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"GCircle", "[", "gdA", "]"}], ",", 
           RowBox[{"GCircle", "[", "gdB", "]"}], ",", 
           RowBox[{"GCircle", "[", "gdUnitDisk", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Dashed", ",", "Black", ",", " ", 
           RowBox[{"GCircle", "[", "gdIncircle0", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"White", ",", 
           RowBox[{"GDisk", "[", "gdLowerHalfplane", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"phi", ",", "psi", ",", "label"}], "}"}], ",", 
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"coords", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Cos", "@", "phi"}], ",", 
                    RowBox[{"Sin", "@", "phi"}]}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Point", "[", "coords", "]"}], ",", 
                  RowBox[{"Text", "[", 
                   RowBox[{"label", ",", "coords", ",", 
                    RowBox[{
                    RowBox[{"-", "2"}], 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "@", "psi"}], ",", 
                    RowBox[{"Sin", "@", "psi"}]}], "}"}]}]}], "]"}]}], 
                 "}"}]}], "]"}]}], "]"}], "@@@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Pi", "/", "3"}], ",", 
                RowBox[{"Pi", "/", "4"}], ",", "T\[Rho]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Pi", "/", "2"}], ",", "0", ",", "\"\<\>\""}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"Pi", "/", "3"}]}], ",", 
                RowBox[{"3", 
                 RowBox[{"Pi", "/", "4"}]}], ",", "\[Rho]"}], "}"}]}], 
             "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Magnify", "[", "a", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.5"}], ",", "1.75"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "0"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Magnify", "[", "b", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5", ",", "1.75"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Magnify", "[", "c", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.25"}], ",", "0.85"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Magnify", "[", "d", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.25", ",", "0.85"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"-", 
            RowBox[{"{", 
             RowBox[{"4", ",", "1"}], "}"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Magnify", "[", 
            RowBox[{"\[DoubleStruckCapitalA]", ",", "2"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1.25"}], ",", "1.5"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Magnify", "[", 
            RowBox[{"\[DoubleStruckCapitalB]", ",", "2"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"1.25", ",", "1.5"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Magnify", "[", 
            RowBox[{"\[DoubleStruckCapitalD]", ",", "2"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.25"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Magnify", "[", 
            RowBox[{"\[ScriptCapitalF]", ",", "2"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "2.25"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Magnify", "[", 
            RowBox[{"\[ScriptCapitalI]", ",", "2"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1.5"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "#"}], ",", "#"}], "}"}], "&"}], "@", "1.25"}], 
           "GoldenRatio"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "2.5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "300"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5994652381718082`*^9, 3.5994657361852303`*^9}, {
   3.5994657672469316`*^9, 3.599465770632142*^9}, {3.599465844453583*^9, 
   3.599465847807594*^9}, {3.5994658805219*^9, 3.5994659657011776`*^9}, {
   3.5994660745155325`*^9, 3.5994661574474025`*^9}, {3.599466189210106*^9, 
   3.5994661928761177`*^9}, 3.5994662923928423`*^9, {3.599466327727957*^9, 
   3.5994666434351854`*^9}, {3.599466678082898*^9, 3.5994667138080144`*^9}, {
   3.599466747753725*^9, 3.5994667645403795`*^9}, {3.599466794757678*^9, 
   3.5994668959572077`*^9}, {3.5994669435539627`*^9, 3.599466987811307*^9}, {
   3.599467018294806*^9, 3.5994670523653173`*^9}, 3.5994670859220266`*^9, {
   3.5994671353907876`*^9, 3.59946713612399*^9}, {3.5994671719729066`*^9, 
   3.5994672195696616`*^9}, {3.5994672588827896`*^9, 3.599467414917498*^9}, {
   3.599467459286042*^9, 3.599467699425625*^9}, {3.599468073388443*^9, 
   3.5994680742464457`*^9}, {3.599468147273283*^9, 3.599468148755288*^9}, {
   3.6118491506849623`*^9, 3.6118491841625776`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Modified Cayley Transform and Modular Tiling", "Subsection",
 CellChangeTimes->{{3.5898634289779954`*^9, 3.589863453641676*^9}, {
   3.595506837003912*^9, 3.595506838227945*^9}, 3.6126309171048656`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"figure1", ",", "criteria", ",", "gds", ",", 
     RowBox[{"minSize", "=", 
      SuperscriptBox["2", 
       RowBox[{"-", "9"}]]}], ",", 
     RowBox[{"maxDistance", "=", "3"}], ",", "mtList", ",", "phi", ",", 
     "viewCenter", ",", "plotRange"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"criteria", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "mt", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gds", "=", 
         RowBox[{"GDiskMatMap", "[", 
          RowBox[{
           RowBox[{"Mat", "@", "gdIncircle0"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Mat", "@", "mt"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"I", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ".", 
              RowBox[{"Mat", "@", "mt"}]}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"GDiskMatRadius", "@", 
             RowBox[{"gds", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "\[GreaterEqual]", 
            "minSize"}], "&&", 
           RowBox[{
            RowBox[{"Abs", "@", 
             RowBox[{"GDiskMatCenter", "@", 
              RowBox[{"gds", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "<", "maxDistance"}]}], 
          ")"}], "||", 
         RowBox[{
          RowBox[{"GDiskMatRadius", "@", 
           RowBox[{"gds", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "\[GreaterEqual]", 
          "minSize"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mtList", "=", 
     RowBox[{"ModularGroupList", "[", "criteria", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"SetOptions", "[", 
     RowBox[{"TUExponents", ",", 
      RowBox[{"QuotientFunction", "\[Rule]", "CQuotient"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"plots1", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "=", 
         RowBox[{"MatrixPower", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"I", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", "t"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"viewCenter", "=", 
         RowBox[{"Inhom", "[", 
          RowBox[{"phi", ".", 
           RowBox[{"{", 
            RowBox[{"I", ",", "1"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"plotRange", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "GoldenRatio"}], ",", "GoldenRatio"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "2"}], "}"}]}], "}"}], ",", "1"}], "}"}], 
          "[", 
          RowBox[{"[", 
           RowBox[{"t", "+", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"ModularTiling", "[", 
           RowBox[{"mtList", ",", "phi", ",", "\[IndentingNewLine]", 
            RowBox[{"IncircleMode", "\[Rule]", "GDisk"}], ",", " ", 
            RowBox[{"IncircleStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"EdgeForm", "[", "Gray", "]"}], ",", "LightGray"}], 
              "]"}]}], ",", 
            RowBox[{"IncircleThreshold", "\[Rule]", 
             SuperscriptBox["2", 
              RowBox[{"-", "6"}]]}], ",", "\[IndentingNewLine]", 
            RowBox[{"TilingThreshold", "\[Rule]", 
             SuperscriptBox["2", 
              RowBox[{"-", "6"}]]}], ",", "\[IndentingNewLine]", 
            RowBox[{"LabelMode", "\[Rule]", "TUWord"}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"LabelThreshold", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "/", "12"}], ",", 
                 RowBox[{"1", "/", "16"}]}], "}"}], "[", 
               RowBox[{"[", 
                RowBox[{"t", "+", "1"}], "]"}], "]"}], ")"}]}], ",", 
            RowBox[{"Magnification", "\[Rule]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"5", ",", "8"}], "}"}], "[", 
              RowBox[{"[", 
               RowBox[{"t", "+", "1"}], "]"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"AxesStyle", "\[Rule]", "Gray"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"400", ",", "Automatic"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"plots2", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "=", 
         RowBox[{"MatrixPower", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"I", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", "t"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"viewCenter", "=", 
         RowBox[{"Inhom", "[", 
          RowBox[{"phi", ".", 
           RowBox[{"{", 
            RowBox[{"I", ",", "1"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"plotRange", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Re", "@", "viewCenter"}], "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "GoldenRatio"}], ",", 
              RowBox[{"+", "GoldenRatio"}]}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"Im", "@", "viewCenter"}], "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"+", "1"}]}], "}"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"ModularTiling", "[", 
           RowBox[{"mtList", ",", "phi", ",", "\[IndentingNewLine]", 
            RowBox[{"IncircleMode", "\[Rule]", "GDisk"}], ",", " ", 
            RowBox[{"IncircleStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"EdgeForm", "[", "Gray", "]"}], ",", "LightGray"}], 
              "]"}]}], ",", 
            RowBox[{"IncircleThreshold", "\[Rule]", 
             SuperscriptBox["2", 
              RowBox[{"-", "4"}]]}], ",", "\[IndentingNewLine]", 
            RowBox[{"TilingThreshold", "\[Rule]", 
             SuperscriptBox["2", 
              RowBox[{"-", "4"}]]}], ",", "\[IndentingNewLine]", 
            RowBox[{"LabelMode", "\[Rule]", "TUWord"}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"LabelThreshold", "\[Rule]", 
             RowBox[{"1", "/", "7"}]}], ",", 
            RowBox[{"Magnification", "\[Rule]", "3"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
          RowBox[{"Axes", "\[Rule]", "True"}], ",", 
          RowBox[{"AxesStyle", "\[Rule]", "Gray"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"200", ",", "Automatic"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "1", ",", 
         RowBox[{"1", "/", "3."}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"figure1", "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"h", ",", " ", "w", ",", "w2", ",", "h2", ",", " ", 
         RowBox[{"m", "=", "0.2"}], ",", "u", ",", "l"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"h", "=", 
         RowBox[{"m", "+", "GoldenRatio"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"h2", "=", 
         RowBox[{"GoldenRatio", "/", "4"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"w2", "=", 
         RowBox[{"GoldenRatio", " ", "h2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"w", "=", 
         RowBox[{"1", "+", "m", "+", "w2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"u", "=", 
         RowBox[{
          RowBox[{"3", "h2"}], "+", "m"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"l", "=", 
         RowBox[{"h2", "/", "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Inset", "[", 
             RowBox[{
              RowBox[{"plots1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", 
                RowBox[{"1", "+", "m"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Inset", "[", 
             RowBox[{
              RowBox[{"plots1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", 
                RowBox[{"1", "/", "2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Inset", "[", 
               RowBox[{
                RowBox[{"plots2", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1", "+", "m", "+", 
                   RowBox[{"w2", "/", "2"}]}], ",", 
                  RowBox[{
                   RowBox[{"u", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"4", "-", "#"}], ")"}], "/", "3"}]}], "+", 
                   RowBox[{"l", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", "1"}], ")"}], "/", "3"}]}]}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"1", "/", "GoldenRatio"}]}], "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", "4", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Line", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "+", 
                  RowBox[{"m", "/", "2"}]}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "+", 
                  RowBox[{"m", "/", "2"}]}], ",", "h"}], "}"}]}], "}"}]}]}], 
           "\[IndentingNewLine]", "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "w"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "h"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]",
   "]"}]}], "Input",
 CellChangeTimes->{{3.587736980242491*^9, 3.5877370307710977`*^9}, {
   3.58773706796165*^9, 3.587737070098859*^9}, {3.58773712409068*^9, 
   3.587737147771577*^9}, {3.587737730309163*^9, 3.587737746845231*^9}, {
   3.5877397756805954`*^9, 3.5877397763357983`*^9}, {3.5879963561677327`*^9, 
   3.587996556284216*^9}, {3.5879971684019876`*^9, 3.587997256132391*^9}, {
   3.5879973196901326`*^9, 3.5879973412197227`*^9}, {3.587997371570554*^9, 
   3.587997417948825*^9}, {3.5879974556428576`*^9, 3.587997541586212*^9}, {
   3.5882587902330704`*^9, 3.588258857450912*^9}, {3.588258944315292*^9, 
   3.5882589445022974`*^9}, {3.5882595203120737`*^9, 3.588259654442749*^9}, {
   3.5882597547104964`*^9, 3.588259775135056*^9}, {3.588259808410968*^9, 
   3.5882598179542294`*^9}, {3.5882599330003815`*^9, 3.5882599345024223`*^9}, 
   3.5882600895426702`*^9, {3.588261191672868*^9, 3.58826119174387*^9}, {
   3.588261293243651*^9, 3.5882612936996636`*^9}, 3.588261333464753*^9, {
   3.588261525040002*^9, 3.5882615791504846`*^9}, {3.588261611504371*^9, 
   3.588261626292776*^9}, {3.588430380282135*^9, 3.588430420714243*^9}, {
   3.5884305124137554`*^9, 3.588430516903878*^9}, 3.5884308444718533`*^9, {
   3.588430885698983*^9, 3.5884310426902847`*^9}, {3.5884310855784597`*^9, 
   3.5884313369733477`*^9}, {3.588431369688244*^9, 3.5884314202506294`*^9}, {
   3.5884314618867702`*^9, 3.5884314924146066`*^9}, {3.588431573141818*^9, 
   3.5884316169700193`*^9}, {3.5884316890189934`*^9, 3.588431762693012*^9}, 
   3.5884318001430383`*^9, {3.588431833884963*^9, 3.588431833981965*^9}, {
   3.588431877835167*^9, 3.58843188378533*^9}, {3.588431970874716*^9, 
   3.5884321237359047`*^9}, {3.588432168681136*^9, 3.5884322473982925`*^9}, {
   3.5884322807462063`*^9, 3.588432311869059*^9}, {3.588432366462555*^9, 
   3.588432393738302*^9}, {3.58843244549172*^9, 3.588432473325483*^9}, {
   3.588432512443555*^9, 3.588432530759056*^9}, {3.5884326778020854`*^9, 
   3.5884327622854*^9}, {3.588432891808949*^9, 3.5884330273566628`*^9}, {
   3.5884330615766*^9, 3.5884330694968176`*^9}, {3.588433173104656*^9, 
   3.5884331966933026`*^9}, {3.588433237697426*^9, 3.588433304118246*^9}, {
   3.5884333620858345`*^9, 3.588433362593848*^9}, {3.588433415106287*^9, 
   3.5884335095078735`*^9}, {3.5884335454468584`*^9, 
   3.5884336682712235`*^9}, {3.5884337363770895`*^9, 
   3.5884337813083205`*^9}, {3.58843393658296*^9, 3.5884339731651096`*^9}, {
   3.5884340597766647`*^9, 3.588434073972723*^9}, {3.5884343102668905`*^9, 
   3.588434362402304*^9}, {3.588434401355664*^9, 3.5884344016520653`*^9}, {
   3.588434481999199*^9, 3.5884344964136577`*^9}, {3.588697842461097*^9, 
   3.5886978938965063`*^9}, {3.5886985928976583`*^9, 3.58869859333267*^9}, {
   3.58870048754957*^9, 3.588700560963582*^9}, 3.588700591872429*^9, 
   3.5887008011731634`*^9, 3.5887008426743*^9, {3.588700905533023*^9, 
   3.5887009626025867`*^9}, {3.588701004458733*^9, 3.5887010585592155`*^9}, {
   3.5887014671684113`*^9, 3.5887014895990257`*^9}, {3.5887015223649235`*^9, 
   3.588701548406637*^9}, {3.5887016297668667`*^9, 3.588701635333019*^9}, 
   3.5887016742210846`*^9, {3.588701775130849*^9, 3.588701789360239*^9}, {
   3.5887018469038153`*^9, 3.58870189450712*^9}, {3.5887019319831467`*^9, 
   3.5887019333951855`*^9}, {3.588702445885227*^9, 3.5887024624056797`*^9}, {
   3.5887026054625998`*^9, 3.5887026153088694`*^9}, {3.58870274234035*^9, 
   3.5887027640709457`*^9}, {3.588751789744584*^9, 3.588751790082593*^9}, {
   3.588751877115899*^9, 3.588751904618628*^9}, {3.588752034461069*^9, 
   3.5887520361411133`*^9}, {3.5887521970173764`*^9, 3.588752203835557*^9}, 
   3.588752240241522*^9, {3.588752312062425*^9, 3.588752339132142*^9}, {
   3.5887523845953474`*^9, 3.5887524168642025`*^9}, {3.5887524523971443`*^9, 
   3.5887524864690466`*^9}, {3.588778991112209*^9, 3.5887789925002456`*^9}, {
   3.5888621396109967`*^9, 3.588862140296015*^9}, {3.5888634186608906`*^9, 
   3.5888634597119784`*^9}, {3.588863502605115*^9, 3.588863512797385*^9}, {
   3.588863593881534*^9, 3.58886365070704*^9}, {3.588863939247686*^9, 
   3.5888639989622684`*^9}, {3.588864058626849*^9, 3.588864129893738*^9}, {
   3.588864160352545*^9, 3.5888641715378413`*^9}, {3.588864222125182*^9, 
   3.588864260844208*^9}, {3.5888643112435436`*^9, 3.5888643789753385`*^9}, {
   3.5888644988735156`*^9, 3.588864507692749*^9}, {3.5888646524885864`*^9, 
   3.5888646578137274`*^9}, {3.5888646888375497`*^9, 
   3.5888646985868077`*^9}, {3.5888647796729565`*^9, 
   3.5888649075553455`*^9}, {3.5888649420662603`*^9, 
   3.5888650447849817`*^9}, {3.588865079556903*^9, 3.5888650837480145`*^9}, {
   3.588865148835739*^9, 3.5888652040062013`*^9}, {3.5888652888804502`*^9, 
   3.5888653438329067`*^9}, {3.5888653753157406`*^9, 
   3.5888654156348095`*^9}, {3.5888654488116884`*^9, 3.588865483894618*^9}, {
   3.5888655555815177`*^9, 3.588865573849002*^9}, {3.588865613140043*^9, 
   3.5888656892740602`*^9}, {3.5888658847562404`*^9, 
   3.5888658849232445`*^9}, {3.58886597455062*^9, 3.5888659781857166`*^9}, {
   3.588866728178591*^9, 3.5888667671436234`*^9}, {3.588866801691539*^9, 
   3.5888669390861797`*^9}, {3.588866975552146*^9, 3.588867006312961*^9}, {
   3.588867126126136*^9, 3.588867137003424*^9}, {3.5888672464573245`*^9, 
   3.588867249575407*^9}, {3.5888673580952826`*^9, 3.588867451122748*^9}, {
   3.5888674916438217`*^9, 3.5888675341599483`*^9}, {3.588867564213745*^9, 
   3.5888675779241085`*^9}, {3.5888676298304834`*^9, 3.588867633692586*^9}, {
   3.5888676664254537`*^9, 3.588867691237111*^9}, {3.588867736044298*^9, 
   3.5888677376993423`*^9}, {3.588867776195362*^9, 3.588867832459853*^9}, {
   3.5888678964115477`*^9, 3.5888679391896815`*^9}, {3.588867973515591*^9, 
   3.588867996220193*^9}, {3.588868166336701*^9, 3.5888683031933274`*^9}, 
   3.5888683435633974`*^9, {3.5888684439120564`*^9, 3.588868445291093*^9}, 
   3.588868522376136*^9, {3.5888714573229094`*^9, 3.5888714686142087`*^9}, {
   3.588952360756848*^9, 3.588952403793988*^9}, 3.5889524356018314`*^9, {
   3.5889549074516373`*^9, 3.588954907844648*^9}, {3.588955789795019*^9, 
   3.5889558206848373`*^9}, {3.5889561018632884`*^9, 
   3.5889561146206264`*^9}, {3.588956223590514*^9, 3.588956235278824*^9}, {
   3.589034735329452*^9, 3.5890347581080556`*^9}, {3.589034806915349*^9, 
   3.5890348208477182`*^9}, {3.5890350136398273`*^9, 
   3.5890350360994225`*^9}, {3.5930156913425517`*^9, 
   3.5930156942909517`*^9}, {3.593015829234975*^9, 3.5930158292817745`*^9}, {
   3.611849204458187*^9, 3.611849227140597*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The action of Modular Transformations", "Subsection",
 CellChangeTimes->{{3.601373455999736*^9, 3.601373469259779*^9}, 
   3.6126309270841465`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "mtList", ",", "mtSublist", ",", "zs", ",", "modCayley", ",", "gx", ",", 
     "labelpt", ",", "mytiling", ",", "myttiling", ",", "mytfigure"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mtList", "=", 
     RowBox[{"ModularGroupList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PSL2ZGrading", "@", 
         RowBox[{"Mat", "@", "#"}]}], "<", "200"}], "&"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"modCayley", "=", 
     RowBox[{"New", "[", 
      RowBox[{"MoebiusTransformation", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"I", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mtSublist", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"mtList", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"GDiskMatRadius", "[", 
            RowBox[{"GDiskMatMap", "[", 
             RowBox[{
              RowBox[{"Mat", "@", "gdFord0"}], ",", 
              RowBox[{
               RowBox[{"Mat", "@", "modCayley"}], " ", ".", " ", 
               RowBox[{"Mat", "@", "#"}]}]}], "]"}], "]"}], ">", 
           RowBox[{"1", "/", "10"}]}], "&&", 
          RowBox[{"ModularGroup`Private`fordCriteria", "@", 
           RowBox[{"Mat", "@", "#"}]}]}], ")"}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"zs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", "ComplexInfinity", "]"}], "&"}], "/@", 
      "mtSublist"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gx", "[", 
      RowBox[{"phi_", ",", "psi_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"ModularTiling", "[", 
      RowBox[{"mtList", ",", 
       RowBox[{"phi", ".", 
        RowBox[{"MatrixPower", "[", 
         RowBox[{"psi", ",", 
          RowBox[{"N", "@", "t"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"IncircleMode", "\[Rule]", "GDisk"}], ",", " ", 
       RowBox[{"IncircleStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "Gray", "]"}], ",", "LightGray"}], "]"}]}],
        ",", 
       RowBox[{"IncircleThreshold", "\[Rule]", 
        SuperscriptBox["2", 
         RowBox[{"-", "6"}]]}], ",", "\[IndentingNewLine]", 
       RowBox[{"TilingThreshold", "\[Rule]", 
        SuperscriptBox["2", 
         RowBox[{"-", "6"}]]}], ",", "\[IndentingNewLine]", 
       RowBox[{"LabelMode", "\[Rule]", "TUWord"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", "Black"}], ",", 
       RowBox[{"LabelThreshold", "\[Rule]", 
        RowBox[{"1", "/", "12"}]}], ",", 
       RowBox[{"Magnification", "\[Rule]", "3"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"mytiling", "[", 
        RowBox[{"psi_", ",", "t_"}], "]"}], ":=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"gx", "[", 
          RowBox[{
           RowBox[{"IdentityMatrix", "@", "2"}], ",", 
           RowBox[{"Mat", "@", "psi"}], ",", "t"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Axes", "\[Rule]", "True"}], ",", 
         RowBox[{"AxesStyle", "\[Rule]", "Gray"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"2", "GoldenRatio"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Superscript", "[", 
             RowBox[{"psi", ",", "t"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"mtT", "\[Rule]", "T"}], ",", 
              RowBox[{"mtU", "\[Rule]", "U"}], ",", 
              RowBox[{"mtR", "\[Rule]", "R"}]}], "}"}]}], ")"}]}]}], "]"}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"labelpt", "[", 
      RowBox[{"m_", ",", "z_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", "pt"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"z", "===", "ComplexInfinity"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "1"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pt", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Re", "@", "#"}], ",", 
             RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", 
          RowBox[{"Inhom", "[", 
           RowBox[{"m", ".", "v"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Point", "[", "pt", "]"}], ",", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"z", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ComplexInfinity", "\[Rule]", "\[Infinity]"}], ",", 
               RowBox[{
                RowBox[{"1", "/", "2"}], "\[Rule]", "0.5"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], "\[Rule]", 
                RowBox[{"-", "0.5"}]}]}], "}"}]}], ",", "pt", ",", 
            RowBox[{
             RowBox[{"-", "2"}], "*", "pt"}]}], "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mytiling", "[", 
      RowBox[{"psi_", ",", "t_", ",", "fix_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "m", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m", "=", 
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"Mat", "[", "modCayley", "]"}]}], ".", 
          RowBox[{"MatrixPower", "[", 
           RowBox[{
            RowBox[{"Mat", "@", "psi"}], ",", "t"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"gx", "[", 
             RowBox[{
              RowBox[{"Mat", "@", "modCayley"}], ",", 
              RowBox[{"Mat", "@", "psi"}], ",", "t"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"labelpt", "[", 
                 RowBox[{"m", ",", "#"}], "]"}], "&"}], "/@", "zs"}]}], "}"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"Red", ",", 
              RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Re", "@", "#"}], ",", 
                   RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", 
                RowBox[{"Inhom", "[", 
                 RowBox[{"m", ".", "fix"}], "]"}]}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Axes", "\[Rule]", "True"}], ",", 
            RowBox[{"AxesStyle", "\[Rule]", "Gray"}], ","}], "*)"}], 
          RowBox[{"PlotRange", "\[Rule]", "1.25"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Superscript", "[", 
              RowBox[{"psi", ",", "t"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"mtT", "\[Rule]", "T"}], ",", 
               RowBox[{"mtU", "\[Rule]", "U"}], ",", 
               RowBox[{"mtR", "\[Rule]", "R"}]}], "}"}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mytfigure", "[", 
      RowBox[{"psi_", ",", "fix_"}], "]"}], ":=", 
     RowBox[{"GraphicsGrid", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myttiling", "[", 
             RowBox[{"psi", ",", "0"}], "]"}], ",", 
            RowBox[{"myttiling", "[", 
             RowBox[{"psi", ",", 
              RowBox[{"1", "/", "6"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myttiling", "[", 
             RowBox[{"psi", ",", 
              RowBox[{"1", "/", "3"}]}], "]"}], ",", 
            RowBox[{"myttiling", "[", 
             RowBox[{"psi", ",", 
              RowBox[{"2", "/", "3"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myttiling", "[", 
             RowBox[{"psi", ",", 
              RowBox[{"5", "/", "6"}]}], "]"}], ",", 
            RowBox[{"myttiling", "[", 
             RowBox[{"psi", ",", "1"}], "]"}]}], "}"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mytiling", "[", 
            RowBox[{"psi", ",", "0", ",", "fix"}], "]"}], ",", 
           RowBox[{"mytiling", "[", 
            RowBox[{"psi", ",", "1", ",", "fix"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mytiling", "[", 
            RowBox[{"psi", ",", 
             RowBox[{"1", "/", "5"}], ",", "fix"}], "]"}], ",", 
           RowBox[{"mytiling", "[", 
            RowBox[{"psi", ",", 
             RowBox[{"4", "/", "5"}], ",", "fix"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mytiling", "[", 
            RowBox[{"psi", ",", 
             RowBox[{"2", "/", "5"}], ",", "fix"}], "]"}], ",", 
           RowBox[{"mytiling", "[", 
            RowBox[{"psi", ",", 
             RowBox[{"3", "/", "5"}], ",", "fix"}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Column", "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mytfigure", "[", 
        RowBox[{"mtU", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"mytfigure", "[", 
        RowBox[{"mtT", ",", 
         RowBox[{"{", 
          RowBox[{"I", ",", "1"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"mytfigure", "[", 
        RowBox[{"mtR", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "Pi", " ", 
             RowBox[{"I", "/", "3"}]}], "]"}], ",", "1"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6013734917394524`*^9, 3.6013734923010545`*^9}, {
   3.6013735374944015`*^9, 3.6013735994422035`*^9}, {3.601373709812563*^9, 
   3.6013742696359854`*^9}, {3.6013743118185225`*^9, 3.601374347137038*^9}, {
   3.6013743924395857`*^9, 3.6013743965267987`*^9}, {3.601374432796917*^9, 
   3.6013744347469234`*^9}, {3.6013744689890347`*^9, 3.601374532606042*^9}, {
   3.601374562948141*^9, 3.601374568392558*^9}, {3.601374599249459*^9, 
   3.6013746452852087`*^9}, {3.6013747071238103`*^9, 3.601374751287554*^9}, {
   3.60137488201598*^9, 3.6013748856039915`*^9}, {3.6013751464524407`*^9, 
   3.6013751740021305`*^9}, {3.601375273031253*^9, 3.6013752756520615`*^9}, {
   3.6013754137437115`*^9, 3.60137543784579*^9}, {3.6013780433350744`*^9, 
   3.6013781182621183`*^9}, {3.6014402269543*^9, 3.6014403683844004`*^9}, {
   3.6014404325474277`*^9, 3.6014404534671016`*^9}, 3.601440531264577*^9, {
   3.601440790412694*^9, 3.6014408539205184`*^9}, {3.601440888037839*^9, 
   3.601441098186183*^9}, {3.6014411702272377`*^9, 3.601441170617239*^9}, {
   3.6014412851060443`*^9, 3.6014413344646187`*^9}, {3.6014415262672977`*^9, 
   3.6014415408377495`*^9}, {3.6014416783054357`*^9, 3.601441703015923*^9}, {
   3.601441768255354*^9, 3.6014418046346827`*^9}, {3.601441930729929*^9, 
   3.6014420425979247`*^9}, {3.6014420815824623`*^9, 3.601442303945649*^9}, {
   3.601442462738611*^9, 3.6014425023939514`*^9}, {3.6014426953666344`*^9, 
   3.601442696146637*^9}, {3.6014427496236267`*^9, 3.6014428343631263`*^9}, {
   3.6014449097008696`*^9, 3.6014449184057007`*^9}, {3.601444997919182*^9, 
   3.601445005578809*^9}, {3.6014457761863394`*^9, 3.601445778963149*^9}, {
   3.601445914012827*^9, 3.6014459155572324`*^9}, {3.6014466444698114`*^9, 
   3.6014466471998215`*^9}, {3.6014470285387735`*^9, 3.601447029474777*^9}, {
   3.601447108286256*^9, 3.6014471231531086`*^9}, {3.601447528658347*^9, 
   3.6014476486227717`*^9}, {3.6014476900565186`*^9, 
   3.6014476903373194`*^9}, {3.6014478712979593`*^9, 3.601447871719161*^9}, {
   3.601447979624743*^9, 3.6014480100448503`*^9}, {3.6015616675480733`*^9, 
   3.6015616818694572`*^9}, {3.6015618013006573`*^9, 3.601561826205325*^9}, {
   3.601725508489148*^9, 3.6017255155091724`*^9}, {3.601725566536953*^9, 
   3.6017255747893825`*^9}, {3.6118492992126293`*^9, 3.6118493414262486`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Modular Tiling and Exponential Transformation", "Subsection",
 CellChangeTimes->{{3.589863462986106*^9, 3.5898634771821527`*^9}, 
   3.6126309346953616`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"circ", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "r", ",", "t"}], "}"}], ",", 
     RowBox[{"m", "+", 
      RowBox[{"r", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", " ", "I", " ", "Pi", " ", "t"}], "]"}]}]}], ",", 
     "Listable"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"halfCirc", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "r", ",", "t"}], "}"}], ",", 
     RowBox[{"m", "+", 
      RowBox[{"r", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"I", " ", "Pi", " ", "t"}], "]"}]}]}], ",", "Listable"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"arc", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "r", ",", "\[Alpha]", ",", "\[Beta]", ",", "t"}], 
       "}"}], ",", 
      RowBox[{"m", "+", 
       RowBox[{"r", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"I", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Beta]", "-", "\[Alpha]"}], ")"}], "t"}]}], ")"}]}], 
         "]"}]}]}], ",", "Listable"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expHomotopy", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "z"}], "}"}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"I", "/", 
         RowBox[{"(", 
          RowBox[{"z", "+", "I"}], ")"}]}], ")"}], 
       RowBox[{"1", "-", "p"}]], 
      RowBox[{"Exp", "[", 
       RowBox[{"2", " ", "Pi", " ", "I", " ", "p", " ", "z"}], "]"}]}], ",", 
     "Listable"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expCoords", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "_Complex"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Evaluate", "@", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Re", "@", "#"}], ",", 
            RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", 
         RowBox[{"expHomotopy", "[", 
          RowBox[{"p", ",", "z"}], "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", "Listable"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expTilingPlot", "[", 
    RowBox[{"mtList_", ",", "p_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ms", ",", "disks", ",", "arcs"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ms", "=", 
       RowBox[{"Mat", "/@", "mtList"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"disks", "=", 
       RowBox[{"GDiskMatMap", "[", 
        RowBox[{
         RowBox[{"Mat", "@", "gdUnitDisk"}], ",", "ms"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"arcs", "=", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", "2"}], "-", "I", "+", 
              RowBox[{"I", "/", "#"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], "-", "I", "+", 
              RowBox[{"I", "/", "#"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"arc", "[", 
              RowBox[{"0", ",", "1", ",", 
               RowBox[{"Pi", "/", "3"}], ",", 
               RowBox[{"2", 
                RowBox[{"Pi", "/", "3"}]}], ",", "#"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"arc", "[", 
              RowBox[{"1", ",", "1", ",", 
               RowBox[{"2", 
                RowBox[{"Pi", "/", "3"}]}], ",", "Pi", ",", "#"}], "]"}], ",", 
             RowBox[{"arc", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1", ",", "0", ",", 
               RowBox[{"Pi", "/", "3"}], ",", "#"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"arc", "[", 
              RowBox[{
               RowBox[{"1", "/", "3"}], ",", 
               RowBox[{"1", "/", "3"}], ",", 
               RowBox[{"Pi", "/", "3"}], ",", "Pi", ",", "#"}], "]"}], ",", 
             " ", 
             RowBox[{"arc", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "/", "3"}], ",", 
               RowBox[{"1", "/", "3"}], ",", "0", ",", 
               RowBox[{"2", 
                RowBox[{"Pi", "/", "3"}]}], ",", "#"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"arc", "[", 
              RowBox[{
               RowBox[{"2", "/", "3"}], ",", 
               RowBox[{"1", "/", "3"}], ",", 
               RowBox[{"2", 
                RowBox[{"Pi", "/", "3"}]}], ",", "Pi", ",", "#"}], "]"}], ",", 
             RowBox[{"arc", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], ",", 
               RowBox[{"1", "/", "3"}], ",", "0", ",", 
               RowBox[{"Pi", "/", "3"}], ",", "#"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"halfCirc", "[", 
            RowBox[{
             RowBox[{"GDiskMatCenter", "@", "disks"}], ",", 
             RowBox[{"GDiskMatRadius", "@", "disks"}], ",", "#"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], "]"}], "&"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"expCoords", "[", 
           RowBox[{"p", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"arcs", "[", "t", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "opts", "}"}], ",", " ", 
           RowBox[{"Options", "[", "ParametricPlot", "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expIncirclePlot", "[", 
    RowBox[{"mtList_", ",", "p_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ms", ",", "disks", ",", "circs"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ms", "=", 
       RowBox[{"Mat", "/@", "mtList"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"disks", "=", 
       RowBox[{"GDiskMatMap", "[", 
        RowBox[{
         RowBox[{"Mat", "@", "gdIncircle0"}], ",", "ms"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"circs", "=", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"circ", "[", 
          RowBox[{
           RowBox[{"GDiskMatCenter", "@", "disks"}], ",", 
           RowBox[{"GDiskMatRadius", "@", "disks"}], ",", "#"}], "]"}], "]"}],
         "&"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"expCoords", "[", 
           RowBox[{"p", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"circs", "[", "t", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "opts", "}"}], ",", 
           RowBox[{"Options", "[", "ParametricPlot", "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expIncircleLabels", "[", 
    RowBox[{"mtList_", ",", "p_", ",", "labelFu_", ",", "displayFu_"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ms", ",", "disks", ",", "centers", ",", "radii", ",", "north", ",", 
       "south", ",", "labelSizes", ",", "labels"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ms", "=", 
       RowBox[{"Mat", "/@", "mtList"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"disks", "=", 
       RowBox[{"GDiskMatMap", "[", 
        RowBox[{
         RowBox[{"Mat", "@", "gdIncircle0"}], ",", "ms"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"centers", "=", 
       RowBox[{"GDiskMatCenter", "@", "disks"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"radii", "=", 
       RowBox[{"GDiskMatRadius", "@", "disks"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"north", "=", 
       RowBox[{"centers", "+", 
        RowBox[{"I", " ", "radii"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"south", "=", 
       RowBox[{"centers", "-", 
        RowBox[{"I", " ", "radii"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"labelSizes", "=", 
       RowBox[{"N", "@", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"expHomotopy", "[", 
           RowBox[{"p", ",", "north"}], "]"}], "-", 
          RowBox[{"expHomotopy", "[", 
           RowBox[{"p", ",", "south"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"labels", "=", 
       RowBox[{"labelFu", "/@", "mtList"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"\"\<f\>\"", "[", 
         RowBox[{"labels", ",", 
          RowBox[{"N", "@", 
           RowBox[{"expHomotopy", "[", 
            RowBox[{"p", ",", "centers"}], "]"}]}], ",", "labelSizes"}], 
         "]"}], "]"}], "/.", 
       RowBox[{"\"\<f\>\"", "\[Rule]", "displayFu"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.589812295533785*^9, 3.589812328874668*^9}, {
   3.5898125128465433`*^9, 3.589812712836843*^9}, {3.589812767309286*^9, 
   3.589812770607374*^9}, {3.589812832466013*^9, 3.589812963519486*^9}, {
   3.5898130154278617`*^9, 3.58981315047744*^9}, {3.589813212985097*^9, 
   3.589813448188329*^9}, {3.589813478759139*^9, 3.589813758257546*^9}, {
   3.589813793434478*^9, 3.5898138847468977`*^9}, {3.589813943758462*^9, 
   3.589814002878028*^9}, {3.589814053609372*^9, 3.5898141024196663`*^9}, {
   3.5898142686770716`*^9, 3.5898143749668884`*^9}, {3.589814415058951*^9, 
   3.589814420483094*^9}, 3.5898144788396406`*^9, {3.589814765575239*^9, 
   3.5898148698320017`*^9}, {3.5898150423465734`*^9, 
   3.5898150565489497`*^9}, {3.589815183150305*^9, 3.58981522147132*^9}, {
   3.5898152528841524`*^9, 3.5898155046038227`*^9}, {3.589815669359189*^9, 
   3.5898157696198454`*^9}, {3.589815839520698*^9, 3.589815877783712*^9}, {
   3.589815957366821*^9, 3.589815959409875*^9}, {3.5898160167483945`*^9, 
   3.5898163423100214`*^9}, {3.589816444740736*^9, 3.589816479434655*^9}, {
   3.58981651470359*^9, 3.5898165506535425`*^9}, {3.589816606911033*^9, 
   3.5898166075780506`*^9}, {3.5898166406869287`*^9, 3.589816644647033*^9}, {
   3.5898166865361433`*^9, 3.589816716771944*^9}, {3.5898167679042997`*^9, 
   3.58981676906133*^9}, {3.5898169013038344`*^9, 3.5898169107800856`*^9}, {
   3.5898170834696617`*^9, 3.589817202356812*^9}, {3.5898181402836666`*^9, 
   3.589818267543039*^9}, {3.58981833174174*^9, 3.5898186015338893`*^9}, {
   3.589818777057541*^9, 3.589818812666484*^9}, {3.589819050316782*^9, 
   3.589819141019185*^9}, {3.589819307729603*^9, 3.589819415813467*^9}, {
   3.5898195818288665`*^9, 3.589819591919134*^9}, {3.5898197324448576`*^9, 
   3.589819737658996*^9}, {3.5898581696052933`*^9, 3.5898581699328947`*^9}, {
   3.5898585280944614`*^9, 3.5898585553321495`*^9}, {3.5898586685417185`*^9, 
   3.5898586769501457`*^9}, {3.5898587372755423`*^9, 
   3.5898587527663927`*^9}, {3.589858929719175*^9, 3.5898589312011795`*^9}, {
   3.5898590694351764`*^9, 3.589859083447548*^9}, 3.589859284541877*^9, {
   3.589859613606597*^9, 3.589859649136538*^9}, {3.5898600284565897`*^9, 
   3.5898600525342283`*^9}, {3.589860736999366*^9, 3.5898608161584635`*^9}, {
   3.5898617735418334`*^9, 3.5898617794449897`*^9}, {3.5898635478971825`*^9, 
   3.5898635494259872`*^9}, {3.589864631621716*^9, 3.5898646565519996`*^9}, {
   3.5898646950861254`*^9, 3.589864700827944*^9}, {3.5898655232838516`*^9, 
   3.589865527059064*^9}, {3.5898655913800735`*^9, 3.5898657589336195`*^9}, 
   3.5898658181856117`*^9, {3.5898661841538057`*^9, 3.58986618552661*^9}, {
   3.6018949231029043`*^9, 3.601894966424221*^9}, {3.6018952990327187`*^9, 
   3.6018952998439207`*^9}, {3.6018954164698353`*^9, 3.601895417483838*^9}, {
   3.6018957941624546`*^9, 3.601895807625291*^9}, 3.6018973391270432`*^9, {
   3.601897814226325*^9, 3.601897814522726*^9}, {3.6018978653944635`*^9, 
   3.6018978657064643`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "mtList", ",", "tilingList", ",", "incircleList", ",", "labelList", ",", 
     "labelPlot", ",", "figure"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mtList", "=", 
     RowBox[{"ModularGroupList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PSL2ZGrading", "@", 
         RowBox[{"Mat", "@", "#"}]}], "<", "400"}], "&"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tilingList", "=", 
     RowBox[{"Rest", "@", 
      RowBox[{"Select", "[", 
       RowBox[{"mtList", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"TRRight", "@", "#"}], "===", "mtT"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "@", 
            RowBox[{"Re", "@", 
             RowBox[{"#", "[", "I", "]"}]}]}], "\[LessEqual]", 
           RowBox[{"1", "/", "2"}]}], "&&", 
          RowBox[{
           RowBox[{"Im", "@", 
            RowBox[{"#", "[", "I", "]"}]}], "\[LessEqual]", 
           RowBox[{"1", "/", "6"}]}]}], "&"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"incircleList", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"mtList", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "@", 
          RowBox[{"Re", "@", 
           RowBox[{"#", "[", 
            RowBox[{"2", "I"}], "]"}]}]}], "\[LessEqual]", 
         RowBox[{"1", "/", "2"}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"labelList", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"incircleList", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"GDiskMatRadius", "[", 
          RowBox[{"GDiskMatMap", "[", 
           RowBox[{
            RowBox[{"Mat", "@", "gdIncircle0"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "I"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ".", 
             RowBox[{"Mat", "@", "#"}]}]}], "]"}], "]"}], "\[GreaterEqual]", 
         RowBox[{"1", "/", "50"}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"SetOptions", "[", 
     RowBox[{"TUExponents", ",", 
      RowBox[{"QuotientFunction", "\[Rule]", "CQuotient"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"labelPlot", "[", 
      RowBox[{"size_", ",", "p_"}], "]"}], ":=", 
     RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
      RowBox[{"expIncircleLabels", "[", 
       RowBox[{"labelList", ",", "p", ",", "TUWord", ",", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Magnify", "[", 
            RowBox[{"#1", ",", 
             RowBox[{"Clip", "[", 
              RowBox[{
               RowBox[{"size", " ", "#3"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "3."}], "}"}]}], "]"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Re", "@", "#"}], ",", 
               RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", "#2"}]}], "]"}],
          "&"}]}], "]"}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"expTilingPlot", "[", 
         RowBox[{"tilingList", ",", "1", ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"expIncirclePlot", "[", 
         RowBox[{"incircleList", ",", "1", ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"labelPlot", "[", 
         RowBox[{"4", ",", "1"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"ImageSize", "->", "500"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "1"}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"AxesStyle", "\[Rule]", "Gray"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6018958281393466`*^9, 3.6018959207723966`*^9}, {
   3.601896064355184*^9, 3.601896072186405*^9}, {3.601896117629328*^9, 
   3.601896117722928*^9}, {3.6018961482522106`*^9, 3.6018961582986374`*^9}, {
   3.60189619257193*^9, 3.6018962797605653`*^9}, {3.6018963261706905`*^9, 
   3.601896326264291*^9}, {3.601896406308107*^9, 3.6018964231405525`*^9}, {
   3.601896474979492*^9, 3.601896508893984*^9}, {3.601896605302244*^9, 
   3.601896648919962*^9}, 3.60189669653129*^9, {3.6018967547350473`*^9, 
   3.601896780568717*^9}, {3.6018975757172813`*^9, 3.601897577667287*^9}, {
   3.6018982758027716`*^9, 3.601898276473573*^9}, {3.601898417831555*^9, 
   3.601898460780471*^9}, 3.60189856057594*^9, {3.6018985999670467`*^9, 
   3.6018986070026655`*^9}, {3.601898720527172*^9, 3.6018987329916058`*^9}, 
   3.601898780572734*^9, 3.6018988118362184`*^9, {3.6018988462655115`*^9, 
   3.601898859058546*^9}, {3.60189890512547*^9, 3.6018989059834723`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nPlots", "=", "6"}], ",", "pStep", ",", "criteria", ",", 
     "mtList", ",", "\[IndentingNewLine]", "tilingList", ",", "tilingPlots", 
     ",", "\[IndentingNewLine]", "incircleList", ",", "incirclePlots", ",", 
     "\[IndentingNewLine]", "labelList", ",", "labelPlot", ",", 
     "zoomRectangles", ",", "\[IndentingNewLine]", "fanPlot", ",", "zoomPlot",
      ",", "zoomList", ",", "\[IndentingNewLine]", "figure1", ",", 
     "figure2"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pStep", "=", 
     RowBox[{"1.", "/", 
      RowBox[{"(", 
       RowBox[{"nPlots", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"criteria", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"GDiskMatRadius", "[", 
        RowBox[{"GDiskMatMap", "[", 
         RowBox[{
          RowBox[{"Mat", "@", "gdIncircle0"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"I", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ".", 
           RowBox[{"Mat", "@", "#"}]}]}], "]"}], "]"}], "\[GreaterEqual]", 
       SuperscriptBox["2", 
        RowBox[{"-", "7"}]]}], "&"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"mtList", "=", 
     RowBox[{"ModularGroupList", "[", "criteria", "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"tilingList", "=", 
     RowBox[{"Rest", "@", 
      RowBox[{"Select", "[", 
       RowBox[{"mtList", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"TRRight", "@", "#"}], "===", "mtT"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "@", 
            RowBox[{"Re", "@", 
             RowBox[{"#", "[", "I", "]"}]}]}], "\[LessEqual]", 
           RowBox[{"1", "/", "2"}]}], "&&", 
          RowBox[{
           RowBox[{"Im", "@", 
            RowBox[{"#", "[", "I", "]"}]}], "\[LessEqual]", 
           RowBox[{"1", "/", "6"}]}]}], "&"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tilingPlots", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"expTilingPlot", "[", 
        RowBox[{"tilingList", ",", "p", ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "0", ",", "1", ",", "pStep"}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"incircleList", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"mtList", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "@", 
          RowBox[{"Re", "@", 
           RowBox[{"#", "[", 
            RowBox[{"2", "I"}], "]"}]}]}], "\[LessEqual]", 
         RowBox[{"1", "/", "2"}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"incirclePlots", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"expIncirclePlot", "[", 
        RowBox[{"incircleList", ",", "p", ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "0", ",", "1", ",", "pStep"}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"labelList", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"incircleList", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"GDiskMatRadius", "[", 
          RowBox[{"GDiskMatMap", "[", 
           RowBox[{
            RowBox[{"Mat", "@", "gdIncircle0"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "I"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ".", 
             RowBox[{"Mat", "@", "#"}]}]}], "]"}], "]"}], "\[GreaterEqual]", 
         SuperscriptBox["2", 
          RowBox[{"-", "4"}]]}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SetOptions", "[", 
     RowBox[{"TUExponents", ",", 
      RowBox[{"QuotientFunction", "\[Rule]", "CQuotient"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"labelPlot", "[", 
      RowBox[{"size_", ",", "p_"}], "]"}], ":=", 
     RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
      RowBox[{"expIncircleLabels", "[", 
       RowBox[{"labelList", ",", "p", ",", "TUWord", ",", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Magnify", "[", 
            RowBox[{"#1", ",", 
             RowBox[{"Clip", "[", 
              RowBox[{
               RowBox[{"size", " ", "#3"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "2."}], "}"}]}], "]"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Re", "@", "#"}], ",", 
               RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", "#2"}]}], "]"}],
          "&"}]}], "]"}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"zoomRectangles", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"EdgeForm", "[", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", "Dashed"}], "]"}], "]"}], ",", 
            "Transparent", ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "#"}], ",", 
                RowBox[{"-", "#"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "#"}], "}"}]}], "]"}]}], "}"}], "]"}], "&"}],
         "@", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "Pi", " ", "p"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "0", ",", "1", ",", "pStep"}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fanPlot", "[", "i_", "]"}], ":=", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"incirclePlots", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"tilingPlots", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"labelPlot", "[", 
        RowBox[{"3", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"nPlots", "-", "1"}], ")"}]}]}], "]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "1"}], ",", 
       RowBox[{"AxesOrigin", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"AxesStyle", "\[Rule]", "Gray"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"t", "\[Equal]", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"nPlots", "-", "1"}], ")"}]}]}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", "\[Element]", "Integers"}], ",", "n", ",", 
              RowBox[{"N", "@", "n"}]}], "]"}]}], "]"}]}], ")"}]}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"zoomPlot", "[", 
      RowBox[{"z_", ",", "nextZ_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"incirclePlots", "[", 
        RowBox[{"[", "6", "]"}], "]"}], ",", 
       RowBox[{"tilingPlots", "[", 
        RowBox[{"[", "6", "]"}], "]"}], ",", 
       RowBox[{"labelPlot", "[", 
        RowBox[{
         RowBox[{"3", "/", "z"}], ",", "1"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", 
           RowBox[{"Directive", "[", 
            RowBox[{"Red", ",", "Dashed"}], "]"}], "]"}], ",", "Transparent", 
          ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "#"}], ",", 
                RowBox[{"-", "#"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "#"}], "}"}]}], "]"}], "&"}], "@", 
           "nextZ"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", "z"}], ",", 
       RowBox[{"AxesOrigin", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"AxesStyle", "\[Rule]", "Gray"}], ",", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", 
         RowBox[{"Options", "@", "Graphics"}]}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"figure1", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fanPlot", "[", "1", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "3.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fanPlot", "[", "2", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.4", ",", "2.4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fanPlot", "[", "3", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1.8"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fanPlot", "[", "4", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.4", ",", "1.2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fanPlot", "[", "5", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.6"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"fanPlot", "[", "6", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.4", ",", "0.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", ".6"}], ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", ".6"}], ",", "3.6"}], "}"}]}], "}"}]}]}], "]"}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"figure1", "=", 
     RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"fanPlot", "[", "i", "]"}], ",", 
           RowBox[{"fanPlot", "[", 
            RowBox[{"i", "+", "1"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "5", ",", "2"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Scaled", "[", ".5", "]"}], ",", 
          RowBox[{"Scaled", "[", ".25", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"zoomList", "=", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Pi"}], "/", "2"}], 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "5"}], "]"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"figure2", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"zoomPlot", "[", 
              RowBox[{
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "3.0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"zoomPlot", "[", 
              RowBox[{
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.1", ",", "2.4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"zoomPlot", "[", 
              RowBox[{
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1.8"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"zoomPlot", "[", 
              RowBox[{
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", 
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "5", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.1", ",", "1.2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"zoomPlot", "[", 
              RowBox[{
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "5", "]"}], "]"}], ",", 
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "6", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", ".6"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"zoomPlot", "[", 
              RowBox[{
               RowBox[{"zoomList", "[", 
                RowBox[{"[", "6", "]"}], "]"}], ",", "1"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1.1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "1"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", ".6"}], ",", "1.7"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", ".6"}], ",", "3.6"}], "}"}]}], "}"}]}]}], "]"}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"figure2", "=", 
     RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"zoomPlot", "[", 
            RowBox[{
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"zoomPlot", "[", 
            RowBox[{
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"zoomPlot", "[", 
            RowBox[{
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"zoomPlot", "[", 
            RowBox[{
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", 
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"zoomPlot", "[", 
            RowBox[{
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "6", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Ticks", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "#"}], ",", "#"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "#"}], ",", "#"}], "}"}]}], "}"}]}], "&"}], 
              "@", "0.001"}]}], "]"}], ",", 
           RowBox[{"zoomPlot", "[", 
            RowBox[{
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "6", "]"}], "]"}], ",", 
             RowBox[{"zoomList", "[", 
              RowBox[{"[", "7", "]"}], "]"}]}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Scaled", "[", ".5", "]"}], ",", 
          RowBox[{"Scaled", "[", ".25", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Column", "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"figure1", ",", "\[IndentingNewLine]", "figure2"}], 
      "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.6022633174708633`*^9, 3.6022634116980906`*^9}, {
  3.6022637318062625`*^9, 3.602263734536269*^9}, {3.6022642250662518`*^9, 
  3.6022642288414607`*^9}, {3.6022642988086295`*^9, 3.6022643764988165`*^9}, {
  3.6118494227490845`*^9, 3.6118494582079005`*^9}, {3.6118501389376116`*^9, 
  3.611850142026413*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hyperbolic geometry, Canonical fundamental domains", "Subsection",
 CellChangeTimes->{{3.6031087067200108`*^9, 3.6031087207963963`*^9}, 
   3.612630945915678*^9}],

Cell[BoxData[
 RowBox[{"?", "InvAssociatedMap"}]], "Input",
 CellChangeTimes->{{3.603114224849203*^9, 3.603114239021591*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FindHypMotion", "[", 
    RowBox[{"z_", ",", "w_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mat", ",", "\[Gamma]", ",", "\[Lambda]", ",", "\[Mu]", ",", "sol"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mat", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z", ",", "w"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Lambda]", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "\[Mu]"}], "}"}]}], "}"}], ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "\[Gamma]"}], "}"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{
        RowBox[{"FindInstance", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "@", "mat"}], "\[Element]", "Reals"}], ",", 
            RowBox[{
             RowBox[{"Abs", "@", "\[Gamma]"}], "\[Equal]", "1"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", "\[Lambda]", ",", "\[Mu]"}], "}"}]}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mat", "/.", "sol"}]}]}], "\n", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "GetHypMotion", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetHypMotion", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"GetHypMotion", "[", 
     RowBox[{"a", ",", "b"}], "]"}], "=", 
    RowBox[{"FindHypMotion", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetHypMotions", "[", 
    RowBox[{"z_", ",", "grpList_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"GetHypMotion", "[", 
      RowBox[{"z", ",", 
       RowBox[{"t", "[", "z", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "grpList"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CanonicalFunDom", "[", 
    RowBox[{"z_", ",", "grpList_", ",", "phi_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ts", ",", "a", ",", "ainv", ",", "phim"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ainv", "=", 
       RowBox[{"InvAssociatedMap", "[", "z", "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
       "maps", " ", "z", " ", "to", " ", "the", " ", "fundamental", " ", 
        "domain"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"PSL2ZInv", "[", "ainv", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phim", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatrixQ", "[", "phi", "]"}], ",", "phi", ",", 
         RowBox[{"Mat", "@", "phi"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ts", "=", 
       RowBox[{"GetHypMotions", "[", 
        RowBox[{
         RowBox[{"Inhom", "[", 
          RowBox[{"ainv", ".", 
           RowBox[{"{", 
            RowBox[{"z", ",", "1"}], "}"}]}], "]"}], ",", "grpList"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ts", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"phim", ".", "a", ".", "#"}], "&"}], "/@", "ts"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"LightGray", ",", 
            RowBox[{"GDisk", "[", 
             RowBox[{"gdRightHalfplane", ",", "ts"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"GCircle", "[", 
             RowBox[{"gdRightHalfplane", ",", "ts"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Gray", ",", "Dashed", ",", 
            RowBox[{"GCircle", "[", 
             RowBox[{"gdUnitDisk", ",", "ts"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Re", "@", "#"}], ",", 
                 RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", 
              RowBox[{"phi", "[", "z", "]"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Re", "@", "#"}], ",", 
                 RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "/@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Inhom", "[", 
                 RowBox[{"phim", ".", "a", ".", 
                  RowBox[{"Mat", "[", "t", "]"}], ".", "ainv", ".", 
                  RowBox[{"{", 
                   RowBox[{"z", ",", "1"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "grpList"}], "}"}]}], "]"}]}], "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"White", ",", 
            RowBox[{"GDisk", "[", 
             RowBox[{"gdLowerHalfplane", ",", 
              RowBox[{"{", "phi", "}"}]}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "opts"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdxU0oQwEAB/DnbbWLdpKDoVnZRpOllBYt81JmYsthpFZbw4Z5+crkrUxR
age2pKQkBwdr2kwv+Zj5OuyCyFcZtaiV2khLFPu/w69fiXnQYCUJghBlYV+i
lzbfJeuN7BN38MI2g/1ivQdfFTnm8dlOhxd/BfxLWPOes461gToW3zR2HeFO
hjnFQ1JVHBfznJ9YJW/7xi/7GzxL9ofncgE2nOQLcV7PKrd0u1+JJ+z8apx6
5GuwUFNK4b1jRocPC3JbsMM2NoAVdIybdo0OY59TMYIzJvk4rvqoYLBE3zSN
m3m3szjpfvXgQknZAqYUm4uYiFxzR1r7gnhNpw7jKGEQWbMrK10yHArHajEr
kKjxyk+sAR8skxQm0g4t9qTuTbjGG7XgxOVuNzaSb3ZMt/9x23/Fk3guLmOw
7TwzhbfSITf+Bzq56eM=
  "]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "modGrpList", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"modGrpList", "=", 
     RowBox[{"ModularGroupList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PSL2ZGrading", "@", 
         RowBox[{"Mat", "@", "#"}]}], "\[LessEqual]", "3"}], "&"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"CanonicalFunDom", "[", 
     RowBox[{
      RowBox[{"GoldenRatio", " ", "I"}], ",", 
      RowBox[{"Rest", "@", "modGrpList"}], ",", "mtId", ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"4", "/", "GoldenRatio"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.603109634618434*^9, 3.603109794837824*^9}, {
  3.6031099524231415`*^9, 3.603109968148573*^9}, {3.603110221015501*^9, 
  3.6031102212165065`*^9}, {3.603110358680273*^9, 3.6031103610073366`*^9}, {
  3.603110439412485*^9, 3.6031104749794593`*^9}, {3.603110721496214*^9, 
  3.6031107238542786`*^9}, {3.6031108236770134`*^9, 3.603110829099162*^9}, {
  3.6031109948247027`*^9, 3.603111003156931*^9}, {3.603111358823676*^9, 
  3.603111379263236*^9}, {3.6031114111291094`*^9, 3.6031114486591377`*^9}, {
  3.6031120891556864`*^9, 3.6031121307228255`*^9}, {3.603112198801691*^9, 
  3.6031122708606653`*^9}, {3.603112819151688*^9, 3.603112820722731*^9}, {
  3.603120601707924*^9, 3.6031206050460157`*^9}, {3.60312083585034*^9, 
  3.603120839049427*^9}, {3.603125337136671*^9, 3.603125357803238*^9}, {
  3.611849818451068*^9, 3.6118498377326765`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "modGrpList", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"modGrpList", "=", 
     RowBox[{"ModularGroupList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PSL2ZGrading", "@", 
         RowBox[{"Mat", "@", "#"}]}], "\[LessEqual]", "3"}], "&"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"CanonicalFunDom", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"2", "I"}]}], ")"}], "/", "3"}], ",", 
      RowBox[{"Rest", "@", "modGrpList"}], ",", "mtId", ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"3", "/", "GoldenRatio"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.603112276265813*^9, 3.6031123089557085`*^9}, {
   3.6031124416783457`*^9, 3.603112446323473*^9}, {3.6031126112809925`*^9, 
   3.6031126726316733`*^9}, {3.603113129170182*^9, 3.6031131463266525`*^9}, 
   3.6031135257430477`*^9, 3.603113569999261*^9, {3.60311360136012*^9, 
   3.6031137013528595`*^9}, {3.603113771783789*^9, 3.6031138381706085`*^9}, {
   3.6031145668485737`*^9, 3.6031145669475765`*^9}, {3.6031150687643256`*^9, 
   3.603115101185214*^9}, {3.6031205961107707`*^9, 3.6031205981368265`*^9}, {
   3.603120883510645*^9, 3.603120886577729*^9}, {3.603121072514824*^9, 
   3.6031210726548276`*^9}, {3.603121112300914*^9, 3.603121133484494*^9}, {
   3.6118498570298853`*^9, 3.6118498693694906`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"modGrpList", ",", "gammat2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"modGrpList", "=", 
     RowBox[{"ModularGroupList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PSL2ZGrading", "@", 
         RowBox[{"Mat", "@", "#"}]}], "\[LessEqual]", "18"}], "&"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"gammat2", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"modGrpList", ",", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"Mat", "[", "#", "]"}], ",", "2"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"_", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "_"}], "}"}]}], "}"}]}], "]"}], "&"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MatrixForm", "@", 
        RowBox[{"Mat", "@", "#"}]}], "&"}], "/@", "gammat2"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"CanonicalFunDom", "[", 
     RowBox[{"I", ",", 
      RowBox[{"Rest", "@", "gammat2"}], ",", "mtId", ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"4", "/", "GoldenRatio"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.6031217688819036`*^9, 3.6031220387832985`*^9}, {
   3.6031220720142097`*^9, 3.603122132550868*^9}, {3.603122179560156*^9, 
   3.60312222716446*^9}, {3.6031222787098727`*^9, 3.6031223040875683`*^9}, 
   3.603122355872987*^9, {3.603124813414322*^9, 3.6031248166594105`*^9}, {
   3.6031254705173264`*^9, 3.603125471292347*^9}, {3.611849888760299*^9, 
   3.611849898385504*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ModularGroup`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"modGrpList", ",", "gammat2"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"modGrpList", "=", 
     RowBox[{"ModularGroupList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PSL2ZGrading", "@", 
         RowBox[{"Mat", "@", "#"}]}], "\[LessEqual]", "18"}], "&"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"gammat2", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"modGrpList", ",", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"Mat", "[", "#", "]"}], ",", "2"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"_", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "_"}], "}"}]}], "}"}]}], "]"}], "&"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MatrixForm", "@", 
        RowBox[{"Mat", "@", "#"}]}], "&"}], "/@", "gammat2"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"CanonicalFunDom", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], "+", "I"}], ",", 
      RowBox[{"Rest", "@", "gammat2"}], ",", "mtId", ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"5", "/", "GoldenRatio"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.6031224142125854`*^9, 3.6031224924747295`*^9}, {
  3.603122574454976*^9, 3.6031225763940287`*^9}, {3.603122757530992*^9, 
  3.6031227635241566`*^9}, {3.6031228132125177`*^9, 3.603122840522266*^9}, {
  3.603123345656106*^9, 3.6031234137399716`*^9}, {3.6031248720959296`*^9, 
  3.6031248736269712`*^9}, {3.611849907823508*^9, 3.611849919492313*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Modular Group and Continued Fractions", "Subsection",
 CellChangeTimes->{{3.5918806407576427`*^9, 3.5918806557336454`*^9}, {
   3.60310873480078*^9, 3.603108735977812*^9}, 3.6126309559749613`*^9}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "modCayley", ",", "mtList", ",", "mtSublist", ",", "pt", ",", "zs"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"modCayley", "=", 
     RowBox[{"New", "[", 
      RowBox[{"MoebiusTransformation", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"I", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mtList", "=", 
     RowBox[{"ModularGroupList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PSL2ZGrading", "@", 
         RowBox[{"Mat", "@", "#"}]}], "<", "150"}], "&"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mtSublist", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"mtList", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"GDiskMatRadius", "[", 
            RowBox[{"GDiskMatMap", "[", 
             RowBox[{
              RowBox[{"Mat", "@", "gdFord0"}], ",", 
              RowBox[{
               RowBox[{"Mat", "@", "modCayley"}], " ", ".", " ", 
               RowBox[{"Mat", "@", "#"}]}]}], "]"}], "]"}], ">", 
           RowBox[{"1", "/", "30"}]}], "&&", 
          RowBox[{"ModularGroup`Private`fordCriteria", "@", 
           RowBox[{"Mat", "@", "#"}]}]}], ")"}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"zs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", "ComplexInfinity", "]"}], "&"}], "/@", 
      "mtSublist"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"figure", "=", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ModularTiling", "[", 
          RowBox[{"mtList", ",", "modCayley", ",", "\[IndentingNewLine]", 
           RowBox[{"InteriorMode", "\[Rule]", "GDisk"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TilingMode", "\[Rule]", "GCircle"}], ",", 
           RowBox[{"TilingStyle", "\[Rule]", "White"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FordDiskMode", "\[Rule]", "GDisk"}], ",", 
           RowBox[{"FordDiskStyle", "\[Rule]", "LightGray"}], ",", 
           RowBox[{"FordLabelMode", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Inhom", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Mat", "@", "#"}], ")"}], ".", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "/.", 
               RowBox[{"ComplexInfinity", "\[Rule]", "\[Infinity]"}]}], "&"}],
              ")"}]}], ",", 
           RowBox[{"FordLabelThreshold", "\[Rule]", 
            RowBox[{"1", "/", "20"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"IncircleMode", "\[Rule]", "GDisk"}], ",", 
           RowBox[{"IncircleStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"EdgeForm", "[", "Gray", "]"}], ",", "White"}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"LabelMode", "\[Rule]", "TUWord"}], ",", 
           RowBox[{"LabelThreshold", "\[Rule]", 
            RowBox[{"1", "/", "12"}]}], ",", 
           RowBox[{"Magnification", "\[Rule]", "8"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", "z", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"pt", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Re", "@", "#"}], ",", 
                    RowBox[{"Im", "@", "#"}]}], "}"}], "&"}], "@", 
                 RowBox[{"modCayley", "[", "z", "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Point", "[", "pt", "]"}], ",", 
                 RowBox[{"Text", "[", 
                  RowBox[{
                   RowBox[{"z", "/.", 
                    RowBox[{"ComplexInfinity", "\[Rule]", "\[Infinity]"}]}], 
                   ",", "pt", ",", 
                   RowBox[{
                    RowBox[{"-", "2"}], "*", "pt"}]}], "]"}]}], "}"}]}]}], 
             "\[IndentingNewLine]", "]"}], "/@", "zs"}]}], 
          "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "1.15"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6006897155665793`*^9, 3.6006899802060633`*^9}, {
   3.600690010376587*^9, 3.6006901133994093`*^9}, {3.6006902039109793`*^9, 
   3.600690357524809*^9}, {3.6006903969149704`*^9, 3.6006904132326374`*^9}, {
   3.6006905992789993`*^9, 3.600690599778201*^9}, {3.6006906553924294`*^9, 
   3.6006906681220813`*^9}, {3.600690715655476*^9, 3.6006907304911366`*^9}, {
   3.6006907825953503`*^9, 3.60069087777134*^9}, {3.6006910109334855`*^9, 
   3.6006910112610865`*^9}, {3.6006910506980486`*^9, 
   3.6006910764381533`*^9}, {3.6006911203835335`*^9, 3.600691372761368*^9}, {
   3.6006914418072505`*^9, 3.6006914726173763`*^9}, {3.600691513770345*^9, 
   3.600691590505062*^9}, {3.600691687116258*^9, 3.6006916874438596`*^9}, {
   3.600691830808447*^9, 3.600691843366498*^9}, {3.600692001051944*^9, 
   3.600692396716365*^9}, {3.600692457868615*^9, 3.60069274462899*^9}, {
   3.600692853221035*^9, 3.600692919490106*^9}, {3.6006929773039427`*^9, 
   3.600693046084625*^9}, {3.6006931537406654`*^9, 3.6006932247521563`*^9}, {
   3.600693564027565*^9, 3.6006935744640083`*^9}, {3.60069364812751*^9, 
   3.6006938363578806`*^9}, 3.600693902751753*^9, {3.6006987900120344`*^9, 
   3.6006988186537523`*^9}, {3.6118499341251197`*^9, 3.611849946246325*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MyTicks", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"min_", ",", "max_"}], "}"}], ",", "special_List", ",", 
     "n_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ticks", ",", "spInRange"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"spInRange", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"special", ",", 
         RowBox[{
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{
            RowBox[{"Interval", "[", 
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}], "]"}], ",", "#"}], "]"}], 
          "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"N", "@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"FindDivisions", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}], ",", "n"}], "]"}], ",", 
           RowBox[{
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"#", "-", "spInRange"}], "]"}], "\[GreaterEqual]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"max", "-", "min"}], ")"}], "/", "n"}]}], "]"}], 
              ")"}]}], "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        "spInRange"}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MyContinuedFraction", "[", 
    RowBox[{"x_", ",", "n_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "c", ",", 
       RowBox[{"t", "=", "x"}], ",", 
       RowBox[{"cs", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"i", "=", "0"}], ";", 
         RowBox[{"c", "=", 
          RowBox[{"Quotient", "[", 
           RowBox[{"t", ",", "1", ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"i", "<", "n"}], "&&", 
         RowBox[{
          RowBox[{"t", "-", "c"}], "\[NotEqual]", "0"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t", "=", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"t", "-", "c"}], ")"}]}]}], ";", 
         RowBox[{"c", "=", 
          RowBox[{"Quotient", "[", 
           RowBox[{"t", ",", "1", ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]}], "]"}]}], ";", 
         RowBox[{"i", "++"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"cs", "=", 
         RowBox[{"{", 
          RowBox[{"cs", ",", "c"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "<", "n"}], ",", 
        RowBox[{"cs", "=", 
         RowBox[{"{", 
          RowBox[{"cs", ",", "c"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "@", "cs"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ModularConvergents", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"quotients", ",", "_Integer", ",", "1"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sgn", ",", "i", ",", "m"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sgn", "=", 
         RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sgn", "*=", 
            RowBox[{"-", "1"}]}], ";", 
           RowBox[{"m", "=", 
            RowBox[{"m", ".", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"sgn", " ", 
                  RowBox[{"quotients", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "}"}]}]}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "quotients", "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "mtList", ",", "number", ",", "quotients", ",", "convergents", ",", 
     "Frame", ",", "plotRange", ",", "figure"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"number", "=", "Pi"}], ";", "\[IndentingNewLine]", 
    RowBox[{"mtList", "=", 
     RowBox[{"ModularGroupList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PSL2ZGrading", "@", 
         RowBox[{"Mat", "@", "#"}]}], "<", "100"}], "&"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"quotients", " ", "=", 
     RowBox[{"MyContinuedFraction", "[", 
      RowBox[{"number", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"convergents", "=", 
     RowBox[{"ModularConvergents", "[", "quotients", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Frame", "[", 
      RowBox[{"m_", ",", "viewCenter_", ",", "zf_"}], "]"}], ":=", 
     RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"plotRange", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"viewCenter", "+", 
            RowBox[{
             SuperscriptBox["GoldenRatio", "2"], 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "zf"}], ",", "zf"}], "}"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"2", "zf"}]}], "}"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ModularTiling", "[", 
           RowBox[{"mtList", ",", "m", ",", "\[IndentingNewLine]", 
            RowBox[{"FordDiskMode", "\[Rule]", "GDisk"}], ",", 
            RowBox[{"FordDiskStyle", "\[Rule]", "LightGray"}], ",", 
            RowBox[{"FordDiskThreshold", "\[Rule]", 
             RowBox[{"zf", "/", "25"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"IncircleMode", "\[Rule]", "GDisk"}], ",", 
            RowBox[{"IncircleStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"White", ",", 
               RowBox[{"EdgeForm", "[", "Gray", "]"}]}], "]"}]}], ",", 
            RowBox[{"IncircleThreshold", "\[Rule]", 
             RowBox[{"zf", "/", "50"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"TilingStyle", "\[Rule]", "Gray"}], ",", " ", 
            RowBox[{"TilingThreshold", "\[Rule]", 
             RowBox[{"zf", "/", "50"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"ExteriorMode", "\[Rule]", "Off"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"LabelMode", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                   RowBox[{
                    RowBox[{"Length", "@", "#"}], "+", "1"}]], 
                  RowBox[{"Last", "@", "#"}]}], "&"}], "@", 
                RowBox[{"TUExponents", "[", 
                 RowBox[{
                  RowBox[{"m", ".", 
                   RowBox[{"Mat", "@", "#"}]}], ",", 
                  RowBox[{
                  "QuotientFunction", "\[Rule]", "CentralQuotient"}]}], 
                 "]"}]}], "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Magnification", "\[Rule]", 
             RowBox[{"2", "/", "zf"}]}], ",", 
            RowBox[{"LabelThreshold", "\[Rule]", 
             RowBox[{
              SuperscriptBox["2", 
               RowBox[{"-", "3"}]], "zf"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"FordLabelMode", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Inhom", "[", 
                RowBox[{"m", ".", 
                 RowBox[{"(", 
                  RowBox[{"Mat", "@", "#"}], ")"}], ".", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "&"}], ")"}]}], 
            ",", 
            RowBox[{"FordLabelThreshold", "\[Rule]", 
             RowBox[{
              SuperscriptBox["2", 
               RowBox[{"-", "3"}]], "zf"}]}]}], "\[IndentingNewLine]", "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Red", ",", "Thick", ",", 
            RowBox[{"GCircle", "[", 
             RowBox[{"gdIncircle0", ",", "convergents"}], "]"}]}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"White", ",", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"Scaled", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], ",", 
              RowBox[{"Scaled", "@", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}]}]}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", 
       RowBox[{"AxesOrigin", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"viewCenter", "-", 
           RowBox[{"zf", " ", "GoldenRatio"}]}], ",", "0"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Ticks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"MyTicks", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#1", ",", "#2"}], "}"}], ",", 
             RowBox[{"{", "number", "}"}], ",", "6"}], "]"}], "&"}], ",", 
          "Automatic"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"figure", "=", 
     RowBox[{"GraphicsColumn", "[", 
      RowBox[{
       RowBox[{"Frame", "@@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"convergents", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "2", ",", "1"}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"convergents", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "Pi", ",", 
            RowBox[{"1", "/", "50"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"convergents", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "Pi", ",", 
            RowBox[{"1", "/", "10000"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"convergents", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "Pi", ",", 
            RowBox[{"1", "/", "25000"}]}], "}"}]}], "\[IndentingNewLine]", 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
      "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.5918810290729074`*^9, 3.5918811630925303`*^9}, {
  3.5918812150249386`*^9, 3.591881412786172*^9}, {3.5918814430969768`*^9, 
  3.5918814524413786`*^9}, {3.59188152339019*^9, 3.591881613433405*^9}, {
  3.591881660498613*^9, 3.5918818268726406`*^9}, {3.591882011597473*^9, 
  3.5918820116910725`*^9}, {3.5918820910680876`*^9, 3.5918821011144896`*^9}, {
  3.5918897082636147`*^9, 3.591889733551219*^9}, {3.591978222701461*^9, 
  3.5919782270850616`*^9}, {3.6006904942281685`*^9, 3.6006905492651944`*^9}, {
  3.600691851806133*^9, 3.600691864863386*^9}, {3.6006919026311407`*^9, 
  3.600691903161543*^9}, {3.611849959381531*^9, 3.6118499801919403`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Klein J Invariant Function under modified Cayley Transform", \
"Subsection",
 CellChangeTimes->{{3.5919656126816535`*^9, 3.59196565243046*^9}, {
   3.592158430745759*^9, 3.592158431744159*^9}, 3.612630963408171*^9}],

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Raster", "[", 
       RowBox[{
        RowBox[{"Transpose", "@", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"List", "@@", 
             RowBox[{"ColorConvert", "[", 
              RowBox[{
               RowBox[{"Hue", "[", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Arg", "[", 
                    RowBox[{"#1", "+", 
                    RowBox[{"I", " ", "#2"}]}], "]"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"2", "Pi"}], ")"}]}], ",", "1"}], "]"}], "]"}], 
               ",", "\"\<RGB\>\""}], "]"}]}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"207", ",", "207"}], "}"}], ",", 
           RowBox[{"N", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"White", ",", 
       RowBox[{"GDisk", "[", "gdUnitCodisk", "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Axes", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.60759409828609*^9, 3.6075942840780134`*^9}, {
  3.6075943954859653`*^9, 3.6075944325539474`*^9}, {3.607594472911017*^9, 
  3.607594503742834*^9}, {3.607594542534862*^9, 3.6075945426598654`*^9}, {
  3.6075945814608936`*^9, 3.607594595222258*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"phi", "=", "mtModCayley"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"New", "[", 
     RowBox[{"MoebiusTransformation", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"I", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"y_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "=", 
       RowBox[{"Complex", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"z", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Inv", "@", "phi"}], ")"}], "@", "c"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "@", "c"}], "\[GreaterEqual]", "1."}], ",", "0.", ",", 
        RowBox[{"N", "@", 
         RowBox[{"KleinInvariantJ", "@", "z"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"color", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"c", ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lc", ",", "t", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"List", "@@", 
        RowBox[{"ColorConvert", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"c", "===", "ComplexInfinity"}], ",", "White", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"c", "\[Equal]", "0."}], ",", "Black", ",", 
            "\[IndentingNewLine]", "True", ",", 
            RowBox[{
             RowBox[{"lc", "=", 
              RowBox[{"Log", "@", 
               RowBox[{"N", "@", "c"}]}]}], ";", 
             RowBox[{"t", "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Im", "@", "lc"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"2", " ", "Pi"}], ")"}]}], ",", "1"}], "]"}]}], ";", 
             RowBox[{"b", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"ArcTan", "@", 
                 RowBox[{"Re", "@", "lc"}]}], "/", "Pi"}], "+", ".5"}]}], ";", 
             RowBox[{"Hue", "[", 
              RowBox[{"t", ",", 
               RowBox[{"1", "-", 
                SuperscriptBox["b", "2"]}], ",", 
               RowBox[{"1", "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "-", "b"}], ")"}], "2"]}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\"\<RGB\>\""}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
     "Listable"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzG8o43EAx/E1OpTfTx54gKTNhXRPJHVPqOVPHMl+fthtdcR+V4fIn8zm
T2nLn+g6kf9JF647coruSKSxbhtlaA9wzkaKyb+JY3Ld9/N98O717C0pquAE
sUgkiiTBu7GCj5JVlyz/0UJ1L/p0Q9bxqx+aPamfoaZq8iu8Xuz/CY0zhm0Y
73xxANOivB1QqFWdwBp76Ckc2xZfwLwkXzdUp+5FS4mK5ENqyfGaCr7aPaCG
cBo1/GbTUd807LbDMq2Dyo2bPkHzubwLBoriruFgWswtHDF4piOJtqeA7/Bh
hJNFEYcD6qhWe4eWIx7pc3TQ28KwPDG69V8QvP/TlQ5vOvhc6P+sUMKWgQwV
VNU2F8LG6jbq8LpFgOU1TaWw19NshdIr+zpcuWMEDTExX0FdS5d8gFNzPHVo
RzqlJV7wmdQZ25ZXI7FTzvvBWEHJwIb5EBY6O+/DmvBjU8Lh4E5lLrRWBL+F
e26mCPb5yIvhtHKjFDrNs2XQLe6phOqFSapOU6ynPy7LAOf0A0sw+aX/MlS6
TrZg+e96O3z313YG2YnRS/iD2XwdYXLJ9uPeJ8Dq+fEJ9swlyzaavsD/rKhJ
dQ==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"jdata", "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", "=", "513"}], "}"}], ",", 
       RowBox[{"Array", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"Power", "::", "infy"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.59197751081791*^9, {3.591978681013937*^9, 3.5919786811231375`*^9}, {
   3.5919788694463687`*^9, 3.5919788695399685`*^9}, {3.5920668005151825`*^9, 
   3.5920668014043827`*^9}, {3.5920681363434052`*^9, 
   3.5920681494474072`*^9}, {3.5920683115002346`*^9, 
   3.5920683912630477`*^9}, {3.59206948257683*^9, 3.59206948694483*^9}, {
   3.5920698685676937`*^9, 3.592069870923294*^9}, {3.592070017750519*^9, 
   3.592070021322919*^9}, {3.5920709355610714`*^9, 3.5920709456386733`*^9}, {
   3.592141620713451*^9, 3.592141622335851*^9}, {3.5921416578726573`*^9, 
   3.5921416782774606`*^9}, {3.592144575964159*^9, 3.592144576416559*^9}, {
   3.592145560327445*^9, 3.592145560353446*^9}, {3.5921456146429605`*^9, 
   3.592145617166031*^9}, {3.5921456863889627`*^9, 3.592145687162984*^9}, {
   3.5921457795895624`*^9, 3.592145788173802*^9}, {3.592152283095416*^9, 
   3.592152296968803*^9}, {3.592154139694214*^9, 3.5921541412342567`*^9}, {
   3.5921544318943653`*^9, 3.5921544363274894`*^9}, {3.5921567290234537`*^9, 
   3.592156729104456*^9}, {3.5921569475015492`*^9, 3.592156948749584*^9}, {
   3.593016254999075*^9, 3.5930162556074753`*^9}, {3.593018262111311*^9, 
   3.593018263499711*^9}, {3.602343531092221*^9, 3.602343537458047*^9}, {
   3.6023441618480167`*^9, 3.6023441639852257`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mtList", "=", 
   RowBox[{"ModularGroupList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PSL2ZGrading", "@", 
       RowBox[{"Mat", "@", "#"}]}], "<", "160"}], "&"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ModularPlot", "[", 
    RowBox[{"data_", ",", "mts_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Raster", "[", 
        RowBox[{
         RowBox[{"color", "@", "data"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ModularTiling", "[", 
        RowBox[{"mts", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"I", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", 
         RowBox[{"TilingStyle", "\[Rule]", "Gray"}], ",", 
         RowBox[{"BorderStyle", "\[Rule]", "Gray"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "1"}], ",", "opts"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.5919665470906096`*^9, 3.5919665634550123`*^9}, {
   3.5919667684702463`*^9, 3.5919667717306466`*^9}, {3.591967007275086*^9, 
   3.5919670354642906`*^9}, {3.591967248544726*^9, 3.591967248950326*^9}, {
   3.591967284487132*^9, 3.591967297372734*^9}, {3.591967366761546*^9, 
   3.5919673794443483`*^9}, {3.5919674189747543`*^9, 3.591967440362358*^9}, {
   3.5919674734967637`*^9, 3.5919674760551643`*^9}, {3.591967805932819*^9, 
   3.5919678089748197`*^9}, {3.5919685847317486`*^9, 3.591968596150951*^9}, {
   3.5919686502361593`*^9, 3.5919686581765614`*^9}, {3.59197554031496*^9, 
   3.5919755745413656`*^9}, {3.591976271705482*^9, 3.5919762768846827`*^9}, {
   3.5919767870901814`*^9, 3.5919768039381847`*^9}, 3.5919775131111107`*^9, {
   3.591978689266339*^9, 3.59197881759196*^9}, {3.5920660856330624`*^9, 
   3.592066574381144*^9}, {3.5920666391955557`*^9, 3.592066793604381*^9}, {
   3.5920668394059887`*^9, 3.59206684447599*^9}, {3.592066915861602*^9, 
   3.5920669278424034`*^9}, {3.59206696436201*^9, 3.5920669807108126`*^9}, {
   3.592067098381632*^9, 3.5920671078820333`*^9}, {3.592067331835671*^9, 
   3.592067403595683*^9}, {3.5920675058225*^9, 3.5920676050853167`*^9}, {
   3.592067829896954*^9, 3.592067876260162*^9}, {3.592067997752982*^9, 
   3.5920679999213824`*^9}, {3.5920680377669888`*^9, 3.592068081103796*^9}, {
   3.59206846539426*^9, 3.592068531335471*^9}, {3.592069324954403*^9, 
   3.5920693445168066`*^9}, {3.5920693837352133`*^9, 
   3.5920693872920136`*^9}, {3.592069472109228*^9, 3.592069472156028*^9}, 
   3.592070427094587*^9, {3.59214446138214*^9, 3.59214446250534*^9}, {
   3.5921450997495956`*^9, 3.5921451014676437`*^9}, {3.592145647376874*^9, 
   3.5921456516489935`*^9}, {3.5921468756181407`*^9, 3.592146884085377*^9}, {
   3.5921525823837657`*^9, 3.592152623290907*^9}, {3.5921527937006617`*^9, 
   3.5921528228364744`*^9}, {3.592152931863516*^9, 3.592152934407587*^9}, {
   3.5921532258177176`*^9, 3.592153264875807*^9}, {3.5921534119819107`*^9, 
   3.592153742378129*^9}, {3.5921540959369926`*^9, 3.592154117668599*^9}, {
   3.5921544606001663`*^9, 3.5921545570188565`*^9}, {3.5921545959399424`*^9, 
   3.592154596381955*^9}, {3.592155568367072*^9, 3.592155572106177*^9}, {
   3.5921556410601006`*^9, 3.5921557072499475`*^9}, 3.5921558668674*^9, {
   3.5921560841914635`*^9, 3.592156118421418*^9}, {3.592156212443042*^9, 
   3.592156212839053*^9}, {3.5921565065712476`*^9, 3.592156517333548*^9}, {
   3.592156871294423*^9, 3.5921569146386323`*^9}, {3.592157887127063*^9, 
   3.5921578914326634`*^9}, 3.5930165671299267`*^9, {3.593016724210353*^9, 
   3.593016725161954*^9}, {3.5930178979380407`*^9, 3.5930179019160414`*^9}, {
   3.602345650953336*^9, 3.6023456525601425`*^9}, {3.6023457066059375`*^9, 
   3.602345789890534*^9}, {3.6023459723316813`*^9, 3.6023459768401003`*^9}}],

Cell[BoxData[
 RowBox[{"ModularPlot", "[", 
  RowBox[{"jdata", ",", "mtList", ",", 
   RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.5921567364456606`*^9, {3.592156919120757*^9, 3.592156935843224*^9}, {
   3.5921571004848175`*^9, 3.5921571158722467`*^9}, {3.5921573110221643`*^9, 
   3.592157311583764*^9}, {3.5930178580322337`*^9, 3.5930179052544413`*^9}, {
   3.611850859969935*^9, 3.6118508843995457`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mtList2", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"mtList", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"PSL2ZGrading", "@", 
        RowBox[{"Mat", "@", "#"}]}], "<", "100"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jdata2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"jdata", "[", 
      RowBox[{"[", 
       RowBox[{"x", ",", "y"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", 
       RowBox[{"Length", "@", "jdata"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "1", ",", 
       RowBox[{"Length", "@", "jdata"}], ",", "2"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.593017966282652*^9, 3.5930179763602533`*^9}}],

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{
   RowBox[{"ModularPlot", "[", 
    RowBox[{
     RowBox[{"1", "/", "jdata2"}], ",", "mtList2", ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Superscript", "[", 
       RowBox[{"J", ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}], ",", 
   RowBox[{"Power", "::", "infy"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.593017929637246*^9, 3.593017961056651*^9}, {
   3.593018621516171*^9, 3.5930186299411726`*^9}, 3.5930186979591837`*^9, {
   3.6023457948981543`*^9, 3.6023458151646376`*^9}, {3.6023458585670156`*^9, 
   3.6023458617962284`*^9}, {3.6023460554392223`*^9, 
   3.6023460632704544`*^9}, {3.6023479318587255`*^9, 
   3.6023479326817484`*^9}, {3.611850062637977*^9, 3.6118500805779853`*^9}}],

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{
   RowBox[{"ModularPlot", "[", 
    RowBox[{
     RowBox[{"jdata2", "-", "1"}], ",", "mtList2", ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"J", "-", "1"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}], ",", 
   RowBox[{"Power", "::", "infy"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5930179471882486`*^9, 3.5930179526326494`*^9}, {
   3.5930179871398554`*^9, 3.5930180062508583`*^9}, {3.5930186339347734`*^9, 
   3.5930186447299747`*^9}, 3.5930186923899827`*^9, {3.6023458192986546`*^9, 
   3.6023458265692844`*^9}, 3.6023479352538185`*^9, {3.6118500855855875`*^9, 
   3.6118500982527933`*^9}}],

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{
   RowBox[{"ModularPlot", "[", 
    RowBox[{
     SuperscriptBox["jdata2", "2"], ",", "mtList2", ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      SuperscriptBox["J", "2"]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}], ",", 
   RowBox[{"Power", "::", "infy"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.593018009433259*^9, 3.5930180362964635`*^9}, {
   3.5930186484739757`*^9, 3.5930186547295766`*^9}, 3.5930186890037823`*^9, {
   3.602345832528509*^9, 3.602345839861539*^9}, {3.6023479411859818`*^9, 
   3.6023479414689894`*^9}, {3.6118501032291956`*^9, 3.611850103541196*^9}, {
   3.61185018051163*^9, 3.611850187422433*^9}}],

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{
   RowBox[{"ModularPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"z", ",", 
        RowBox[{"phi", "[", "z", "]"}], ",", "Listable"}], "]"}], "[", 
      "jdata2", "]"}], ",", "mtList2", ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"\[CapitalPhi]", "[", "J", "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}], ",", 
   RowBox[{"Power", "::", "infy"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6023436246352043`*^9, 3.6023436438388824`*^9}, {
   3.6023437456468997`*^9, 3.6023438127769747`*^9}, {3.6023438892338877`*^9, 
   3.6023439244588327`*^9}, {3.602343971930827*^9, 3.6023439734908333`*^9}, {
   3.6023449127410555`*^9, 3.6023449154554663`*^9}, {3.6023458463667655`*^9, 
   3.6023458767430897`*^9}, {3.6023462251132364`*^9, 3.6023462272504454`*^9}, 
   3.602347944007059*^9, {3.611850190994835*^9, 3.6118502020396395`*^9}}],

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{
   RowBox[{"ModularPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"z", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"z", "===", "ComplexInfinity"}], ",", "0.", ",", 
          RowBox[{"2", 
           RowBox[{"z", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "z", "-", 
              SuperscriptBox["z", "2"]}], ")"}]}]}]}], "]"}], ",", 
        "Listable"}], "]"}], "@", "jdata2"}], ",", "mtList2", ",", 
     RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}], ",", 
   RowBox[{"Power", "::", "infy"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.593018037419664*^9, 3.593018058699067*^9}, {
   3.593018656554777*^9, 3.593018664371378*^9}, 3.5930187031851845`*^9, {
   3.6118502054872413`*^9, 3.6118502059864416`*^9}, {3.611850251039262*^9, 
   3.61185026940047*^9}}],

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{
   RowBox[{"ModularPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"z", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"z", "===", "ComplexInfinity"}], ",", "0.", ",", 
          RowBox[{"2", 
           RowBox[{"z", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "z", "-", 
              SuperscriptBox["z", "2"]}], ")"}]}]}]}], "]"}], ",", 
        "Listable"}], "]"}], "@", "jdata"}], ",", "mtList", ",", 
     RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], ",", 
   RowBox[{"Power", "::", "infy"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5921593954051943`*^9, 3.592159399024395*^9}, {
   3.593018089134672*^9, 3.5930181280576787`*^9}, {3.5930186661965785`*^9, 
   3.5930186733101797`*^9}, 3.5930187049479847`*^9, {3.593019144753888*^9, 
   3.5930191461609273`*^9}, {3.6118502729884715`*^9, 3.611850295639682*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ModularPlot2", "[", 
    RowBox[{"data_", ",", "mts_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Raster", "[", 
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"color", "@", "data"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ModularTiling", "[", 
        RowBox[{"mts", ",", 
         RowBox[{"IdentityMatrix", "@", "2"}], ",", 
         RowBox[{"TilingStyle", "\[Rule]", "Gray"}], ",", 
         RowBox[{"BorderStyle", "\[Rule]", "Gray"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "3"}], "}"}]}], "}"}]}], ",", "opts"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6075156379275355`*^9, 3.607515676303661*^9}, {
   3.6075157172225943`*^9, 3.6075157201866035`*^9}, {3.6075160821857824`*^9, 
   3.6075160846973906`*^9}, {3.6075161282059326`*^9, 3.607516179124498*^9}, {
   3.607516234223878*^9, 3.6075162357994823`*^9}, 3.6075163266853786`*^9, {
   3.6075163913475895`*^9, 3.6075164054188347`*^9}, {3.607516445105364*^9, 
   3.6075164799714775`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"jdataH", "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", "=", "513"}], "}"}], ",", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"N", "@", 
           RowBox[{"KleinInvariantJ", "[", 
            RowBox[{"#1", "+", 
             RowBox[{"#2", "\[ImaginaryI]"}]}], "]"}]}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "n"}], ",", "3"}], "}"}]}], "}"}]}]}], 
        "]"}]}], "]"}], ",", 
     RowBox[{"Power", "::", "infy"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.607515727971029*^9, 3.6075159473233433`*^9}, {
   3.60751598608947*^9, 3.6075160486456733`*^9}, {3.6075161120442796`*^9, 
   3.607516112855482*^9}, {3.6075161487199993`*^9, 3.6075162274846554`*^9}, {
   3.6075163432994328`*^9, 3.60751637626234*^9}, 3.607516514119989*^9}],

Cell[BoxData[
 RowBox[{"ModularPlot2", "[", 
  RowBox[{"jdataH", ",", "mtList", ",", 
   RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.607515727971029*^9, 3.6075159473233433`*^9}, {
  3.60751598608947*^9, 3.607516064900926*^9}, {3.6075164268221045`*^9, 
  3.607516429442913*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Nice Generalized Disks under the Modular Group", "Subsection",
 CellChangeTimes->{{3.59196559247965*^9, 3.5919656035556517`*^9}, {
   3.5921461250922017`*^9, 3.5921461272512617`*^9}, 3.612630975670517*^9}],

Cell[BoxData[
 RowBox[{"?", "TRIndicateRight"}]], "Input",
 CellChangeTimes->{{3.602854419490948*^9, 3.6028544236380615`*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mtList", ",", "gdT", ",", "gdR", ",", "phi", ",", "ts"}], "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gdT", "=", 
     RowBox[{"New", "[", 
      RowBox[{"CompactDisk", ",", " ", 
       RowBox[{
        RowBox[{"Sqrt", "[", "5", "]"}], 
        RowBox[{"I", "/", "2"}]}], ",", 
       RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"gdR", "=", 
     RowBox[{"New", "[", 
      RowBox[{"CompactDisk", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}], "+", "I"}], ",", 
       RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"phi", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"I", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"mtList", "=", 
     RowBox[{"ModularGroupList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"GDiskMatRadius", "[", 
         RowBox[{"GDiskMatMap", "[", 
          RowBox[{
           RowBox[{"Mat", "@", "gdT"}], ",", 
           RowBox[{"phi", ".", 
            RowBox[{"Mat", "@", "#"}]}]}], "]"}], "]"}], "\[GreaterEqual]", 
        SuperscriptBox["2", 
         RowBox[{"-", "8"}]]}], "&"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ts", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"phi", ".", 
        RowBox[{"Mat", "@", "#"}]}], "&"}], "/@", "mtList"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{"GCircle", "[", 
           RowBox[{"gdT", ",", 
            RowBox[{"Rest", "@", 
             RowBox[{"Pick", "[", 
              RowBox[{"ts", ",", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"TRIndicateRight", "[", 
                  RowBox[{"Mat", "/@", "mtList"}], "]"}], "\[Equal]", "0"}], 
                "]"}]}], "]"}]}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"GCircle", "[", 
           RowBox[{"gdR", ",", 
            RowBox[{"Rest", "@", 
             RowBox[{"Pick", "[", 
              RowBox[{"ts", ",", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"TRIndicateRight", "[", 
                  RowBox[{"Mat", "/@", "mtList"}], "]"}], "\[Equal]", "1"}], 
                "]"}]}], "]"}]}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ModularTiling", "[", 
         RowBox[{"mtList", ",", "phi", ",", 
          RowBox[{"TilingMode", "\[Rule]", "GCircle"}], ",", 
          RowBox[{"IncircleMode", "\[Rule]", "GCircle"}], ",", 
          RowBox[{"FordDiskMode", "\[Rule]", "GCircle"}], ",", 
          RowBox[{"FordDiskStyle", "\[Rule]", "Brown"}], ",", 
          RowBox[{"IncircleStyle", "\[Rule]", "Gray"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "1"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.58915818222956*^9, 3.589158549501556*^9}, {
   3.58915858450807*^9, 3.589158644755466*^9}, 3.5891587106188803`*^9, {
   3.5891587584642363`*^9, 3.58915876880707*^9}, {3.5891589201275625`*^9, 
   3.589158955196477*^9}, {3.5891590974845405`*^9, 3.5891591006981506`*^9}, {
   3.589205999672281*^9, 3.589206151226774*^9}, {3.589206197371725*^9, 
   3.589206236465452*^9}, {3.589206454429362*^9, 3.5892064558489666`*^9}, {
   3.5892064926650867`*^9, 3.589206530370409*^9}, {3.591880590822035*^9, 
   3.591880591789235*^9}, {3.6028543818719177`*^9, 3.602854633394809*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Self tests", "Section",
 CellChangeTimes->{{3.581611200583548*^9, 3.5816112029079556`*^9}, {
   3.5833176000924797`*^9, 3.5833176005294914`*^9}, 3.599827291091258*^9, 
   3.612624185793048*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"On", "[", "Assert", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5833213103998003`*^9, 3.583321315881945*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"phi", ",", "result", ",", "inf"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"MoebiusTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"I", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"InstanceQ", "[", "MoebiusTransformation", "]"}], "[", "phi", 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"I", ",", 
         RowBox[{"-", "I"}], ",", "ComplexInfinity"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"result", "/.", 
       RowBox[{"ComplexInfinity", "\[Rule]", "inf"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"result", "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "inf", ",", "I"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"I", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "I"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Inhom", "[", "#", "]"}], "&"}], "/@", "result"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"result", "/.", 
       RowBox[{"ComplexInfinity", " ", "\[Rule]", "inf"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"result", "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "inf", ",", "I"}], "}"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5815838074719305`*^9, 3.581583846475058*^9}, {
  3.581583887880593*^9, 3.5815840769004097`*^9}, {3.5815841663425016`*^9, 
  3.581584209276841*^9}, {3.581584253756586*^9, 3.581584257392398*^9}, {
  3.5815843188459983`*^9, 3.5815843206712046`*^9}, {3.581584368848161*^9, 
  3.5815843759773846`*^9}, {3.5815844093800936`*^9, 3.5815844168691177`*^9}, {
  3.581584461738864*^9, 3.5815846665533314`*^9}, {3.581584717039096*^9, 
  3.581584763515647*^9}, {3.5815848331914744`*^9, 3.5815848383862915`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"phi", ",", "psi"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"MoebiusTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"I", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"psi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"MoebiusTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"phi", "@", "psi"}], ")"}], "@", "\"\<z\>\""}], "\[Equal]", 
        RowBox[{"phi", "@", 
         RowBox[{"(", 
          RowBox[{"psi", "@", "\"\<z\>\""}], ")"}]}]}], "//", "Simplify"}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5815853314968987`*^9, 3.581585421485992*^9}, {
  3.581586424733261*^9, 3.581586425654664*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "phi", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"MoebiusTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"I", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"InstanceQ", "[", "MoebiusTransformation", "]"}], "[", "phi", 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{"!", 
       RowBox[{
        RowBox[{"InstanceQ", "[", "ModularTransformation", "]"}], "[", "phi", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Mat", "[", "phi", "]"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"I", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "I"}], "}"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Inv", "@", 
        RowBox[{"Inv", "@", "phi"}]}], "===", "phi"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Inv", "@", 
        RowBox[{"Inv", "@", 
         RowBox[{"Inv", "@", "phi"}]}]}], "===", 
       RowBox[{"Inv", "@", "phi"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "@", 
         RowBox[{
          RowBox[{"Inv", "[", "phi", "]"}], "@", "\"\<z\>\""}]}], "\[Equal]", 
        RowBox[{
         RowBox[{"Inv", "[", "phi", "]"}], "@", 
         RowBox[{"phi", "@", "\"\<z\>\""}]}], "\[Equal]", "\"\<z\>\""}], "//",
        "Simplify"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.580486467070741*^9, 3.5804865873316684`*^9}, {
  3.580486619421009*^9, 3.5804866333674707`*^9}, {3.5804868051398234`*^9, 
  3.580486824125107*^9}, {3.5804868773993406`*^9, 3.580486878896947*^9}, {
  3.5816113088871007`*^9, 3.5816113091835017`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "phi", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"phi", "=", 
      RowBox[{"New", "[", 
       RowBox[{"MoebiusTransformation", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"7", ",", "5"}], "}"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"InstanceQ", "[", "MoebiusTransformation", "]"}], "[", "phi", 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"InstanceQ", "[", "ModularTransformation", "]"}], "[", "phi", 
       "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5804865936964965`*^9, 3.580486736109521*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CentralQuotient", "[", 
       RowBox[{"i", ",", "5"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
      ",", "1", ",", "1", ",", "1"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5816115862156043`*^9, 3.5816116829741197`*^9}, 
   3.5816117411415095`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"CQuotient", "[", 
       RowBox[{"i", ",", "5"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}], "\[Equal]", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5816116868897324`*^9, 3.5816117434201174`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRLeft", "[", "mtId", "]"}], "===", "mtT"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRRight", "[", "mtId", "]"}], "===", "mtT"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRLeft", "[", "mtT", "]"}], "===", "mtT"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRRight", "[", "mtT", "]"}], "===", "mtT"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRLeft", "[", "mtR", "]"}], "===", "mtR"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRRight", "[", "mtR", "]"}], "===", "mtR"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRLeft", "[", 
     RowBox[{"Inv", "@", "mtR"}], "]"}], "===", 
    RowBox[{"Inv", "@", "mtR"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRRight", "[", 
     RowBox[{"Inv", "@", "mtR"}], "]"}], "===", 
    RowBox[{"Inv", "@", "mtR"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRLeft", "[", "mtU", "]"}], "===", "mtT"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRRight", "[", "mtU", "]"}], "===", "mtR"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRLeft", "[", 
     RowBox[{"Inv", "@", "mtU"}], "]"}], "===", 
    RowBox[{"Inv", "@", "mtR"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRRight", "[", 
     RowBox[{"Inv", "@", "mtU"}], "]"}], "===", "mtT"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.583148866842733*^9, 3.583148915265304*^9}, {
  3.5831489526430364`*^9, 3.583149169593004*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRList", "[", 
     RowBox[{"mtU", "@", "mtU"}], "]"}], "===", 
    RowBox[{"{", 
     RowBox[{"mtT", ",", "mtR", ",", "mtT", ",", "mtR"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TRList", "[", 
     RowBox[{"Inv", "@", 
      RowBox[{"mtU", "@", "mtU"}]}], "]"}], "===", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Inv", "@", "mtR"}], ",", "mtT", ",", 
      RowBox[{"Inv", "@", "mtR"}], ",", "mtT"}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.583149920735662*^9, 3.583150016785202*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TUExponents", "[", 
     RowBox[{"mtT", "@", "mtU"}], "]"}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TUExponents", "[", 
     RowBox[{"mtU", "@", 
      RowBox[{"mtT", "@", 
       RowBox[{"Inv", "@", "mtU"}]}]}], "]"}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Assert", "[", 
   RowBox[{
    RowBox[{"TUExponents", "[", 
     RowBox[{
      RowBox[{"Inv", "[", "mtU", "]"}], "@", "mtT"}], "]"}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.583150032120056*^9, 3.583150216013507*^9}, {
  3.583150312765049*^9, 3.583150316009861*^9}, {3.583150366179638*^9, 
  3.5831503690812483`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "disks", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"disks", "=", 
      RowBox[{"{", 
       RowBox[{"gdUnitDisk", ",", " ", 
        RowBox[{"New", "[", 
         RowBox[{"NoncompactDisk", ",", "0", ",", "1"}], "]"}], ",", 
        "gdUpperHalfplane"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"InteriorQ", "[", 
          RowBox[{"#", ",", "0"}], "]"}], "&"}], "/@", "disks"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "False", ",", "True"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"InteriorQ", "[", 
          RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "disks"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"False", ",", "True", ",", "True"}], "}"}]}], "]"}], ";", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"InteriorQ", "[", 
          RowBox[{"#", ",", "I"}], "]"}], "&"}], "/@", "disks"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"InteriorQ", "[", 
          RowBox[{"#", ",", 
           RowBox[{"-", "I"}]}], "]"}], "&"}], "/@", "disks"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "False"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"InteriorQ", "[", 
          RowBox[{"#", ",", "ComplexInfinity"}], "]"}], "&"}], "/@", 
        "disks"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{"False", ",", "True", ",", "True"}], "}"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5817415559440465`*^9, 3.581741979340231*^9}, {
  3.5817421303799224`*^9, 3.581742137025544*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"phi", ",", "disk", ",", "expectedType"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"expectedType", "=", 
      RowBox[{"{", 
       RowBox[{
       "Halfplane", ",", "CompactDisk", ",", "Halfplane", ",", 
        "NoncompactDisk", ",", "Halfplane"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"phi", "=", 
         RowBox[{"New", "[", 
          RowBox[{"MoebiusTransformation", ",", 
           RowBox[{"MatrixPower", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"I", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "I"}], "}"}]}], "}"}], ",", "i"}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"disk", "=", 
         RowBox[{"phi", "[", "gdUpperHalfplane", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Assert", "[", 
         RowBox[{
          RowBox[{"InstanceQ", "[", 
           RowBox[{"expectedType", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}], "[", "disk", "]"}],
          "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.581760502981062*^9, 3.5817607708651342`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Off", "[", "Assert", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5804877427507343`*^9, 3.580487744950344*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1003, 623},
WindowMargins->{{24, Automatic}, {21, Automatic}},
ShowSelection->True,
Magnification->1.100000023841858,
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 104, 1, 99, "Title"],
Cell[CellGroupData[{
Cell[708, 27, 99, 1, 86, "Section"],
Cell[810, 30, 453, 12, 32, "Text"],
Cell[CellGroupData[{
Cell[1288, 46, 97, 1, 47, "Subsection"],
Cell[1388, 49, 1013, 21, 93, "Text"],
Cell[2404, 72, 456, 9, 32, "Text"],
Cell[2863, 83, 563, 9, 53, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3463, 97, 99, 1, 47, "Subsection"],
Cell[3565, 100, 1318, 25, 337, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4920, 130, 157, 2, 47, "Subsection"],
Cell[5080, 134, 592, 13, 32, "Text"],
Cell[5675, 149, 475, 12, 32, "Text"],
Cell[6153, 163, 123, 3, 32, "Input",
 InitializationCell->True],
Cell[6279, 168, 348, 6, 32, "Text"],
Cell[CellGroupData[{
Cell[6652, 178, 242, 7, 31, "Item"],
Cell[CellGroupData[{
Cell[6919, 189, 170, 2, 26, "Subitem"],
Cell[7092, 193, 441, 8, 26, "Subitem"],
Cell[7536, 203, 271, 5, 26, "Subitem"],
Cell[7810, 210, 328, 6, 26, "Subitem"]
}, Open  ]],
Cell[8153, 219, 90, 1, 31, "Item"],
Cell[8246, 222, 315, 4, 26, "Subitem"]
}, Open  ]],
Cell[8576, 229, 193, 3, 32, "Input"],
Cell[8772, 234, 559, 9, 26, "Subitem"],
Cell[9334, 245, 396, 9, 53, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9779, 260, 188, 4, 86, "Section"],
Cell[CellGroupData[{
Cell[9992, 268, 189, 2, 47, "Subsection"],
Cell[10184, 272, 134, 2, 32, "Input"],
Cell[10321, 276, 431, 12, 32, "Input"],
Cell[10755, 290, 221, 4, 32, "Text"],
Cell[10979, 296, 119, 2, 32, "Input"],
Cell[11101, 300, 164, 2, 32, "Text"],
Cell[11268, 304, 539, 11, 32, "Input"],
Cell[11810, 317, 177, 4, 32, "Text"],
Cell[11990, 323, 114, 2, 32, "Input"],
Cell[12107, 327, 647, 19, 53, "Input"],
Cell[12757, 348, 115, 1, 32, "Text"],
Cell[12875, 351, 996, 27, 73, "Input"],
Cell[13874, 380, 278, 7, 32, "Input"],
Cell[14155, 389, 116, 2, 32, "Input"],
Cell[14274, 393, 210, 4, 32, "Input"],
Cell[14487, 399, 116, 2, 32, "Input"],
Cell[14606, 403, 355, 9, 32, "Input"],
Cell[14964, 414, 375, 10, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15376, 429, 189, 2, 47, "Subsection"],
Cell[15568, 433, 129, 2, 32, "Input"],
Cell[15700, 437, 134, 1, 32, "Text"],
Cell[15837, 440, 601, 18, 53, "Input"],
Cell[16441, 460, 245, 3, 32, "Text"],
Cell[16689, 465, 1036, 28, 53, "Input"],
Cell[17728, 495, 418, 11, 53, "Input"],
Cell[18149, 508, 209, 2, 32, "Text"],
Cell[18361, 512, 309, 6, 93, "Input"],
Cell[18673, 520, 258, 5, 32, "Text"],
Cell[18934, 527, 117, 2, 32, "Input"],
Cell[19054, 531, 434, 6, 32, "Input"],
Cell[19491, 539, 276, 6, 32, "Text"],
Cell[19770, 547, 117, 2, 32, "Input"],
Cell[19890, 551, 1044, 26, 113, "Input"],
Cell[20937, 579, 209, 4, 32, "Text"],
Cell[21149, 585, 271, 5, 53, "Input"],
Cell[21423, 592, 497, 10, 53, "Input"],
Cell[21923, 604, 292, 5, 53, "Text"],
Cell[22218, 611, 218, 4, 32, "Input"],
Cell[22439, 617, 370, 8, 32, "Input"],
Cell[22812, 627, 129, 2, 32, "Input"],
Cell[22944, 631, 234, 4, 53, "Input"],
Cell[23181, 637, 633, 17, 53, "Input"],
Cell[23817, 656, 167, 3, 32, "Text"],
Cell[23987, 661, 122, 2, 32, "Input"],
Cell[24112, 665, 683, 18, 53, "Input"],
Cell[24798, 685, 279, 3, 32, "Text"],
Cell[25080, 690, 117, 2, 32, "Input"],
Cell[25200, 694, 2484, 62, 293, "Input"],
Cell[27687, 758, 244, 4, 32, "Text"],
Cell[27934, 764, 199, 3, 32, "Input"],
Cell[28136, 769, 482, 8, 32, "Text"],
Cell[28621, 779, 1932, 43, 173, "Input"],
Cell[30556, 824, 340, 6, 53, "Text"],
Cell[30899, 832, 130, 2, 32, "Input"],
Cell[31032, 836, 445, 7, 32, "Text"],
Cell[31480, 845, 2377, 59, 293, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33894, 909, 139, 2, 47, "Subsection"],
Cell[34036, 913, 126, 2, 32, "Input"],
Cell[34165, 917, 212, 4, 32, "Text"],
Cell[34380, 923, 284, 5, 73, "Input"],
Cell[34667, 930, 342, 6, 32, "Text"],
Cell[35012, 938, 291, 5, 93, "Input"],
Cell[35306, 945, 146, 2, 32, "Text"],
Cell[35455, 949, 468, 8, 113, "Input"],
Cell[35926, 959, 238, 5, 32, "Input"],
Cell[36167, 966, 210, 2, 32, "Text"],
Cell[36380, 970, 118, 2, 32, "Input"],
Cell[36501, 974, 442, 10, 32, "Input"],
Cell[36946, 986, 480, 15, 32, "Input"],
Cell[37429, 1003, 179, 4, 32, "Text"],
Cell[37611, 1009, 1998, 49, 253, "Input"],
Cell[39612, 1060, 276, 6, 32, "Text"],
Cell[39891, 1068, 273, 5, 73, "Input"],
Cell[40167, 1075, 647, 18, 43, "Text"],
Cell[40817, 1095, 2374, 55, 133, "Input"],
Cell[43194, 1152, 599, 13, 63, "Text"],
Cell[43796, 1167, 790, 22, 73, "Input"],
Cell[44589, 1191, 302, 5, 32, "Text"],
Cell[44894, 1198, 3016, 65, 293, "Input"],
Cell[47913, 1265, 244, 4, 32, "Text"],
Cell[48160, 1271, 10551, 236, 753, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58748, 1512, 329, 6, 47, "Subsection"],
Cell[59080, 1520, 309, 6, 32, "Text"],
Cell[59392, 1528, 198, 3, 32, "Input"],
Cell[59593, 1533, 344, 7, 53, "Text"],
Cell[59940, 1542, 123, 2, 32, "Input"],
Cell[60066, 1546, 338, 6, 32, "Text"],
Cell[60407, 1554, 450, 11, 53, "Input"],
Cell[60860, 1567, 852, 22, 53, "Input"],
Cell[61715, 1591, 236, 4, 32, "Text"],
Cell[61954, 1597, 11941, 275, 953, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73932, 1877, 172, 2, 47, "Subsection"],
Cell[74107, 1881, 703, 11, 93, "Text"],
Cell[74813, 1894, 239, 4, 53, "Input"],
Cell[75055, 1900, 980, 16, 114, "Text"],
Cell[76038, 1918, 13148, 284, 993, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89223, 2207, 164, 2, 47, "Subsection"],
Cell[89390, 2211, 804, 14, 134, "Text"],
Cell[90197, 2227, 1872, 53, 113, "Input"],
Cell[92072, 2282, 188, 4, 32, "Text"],
Cell[92263, 2288, 168, 3, 32, "Input"],
Cell[92434, 2293, 2473, 79, 119, "Input"],
Cell[94910, 2374, 1683, 44, 187, "Text"],
Cell[96596, 2420, 301, 4, 32, "Text"],
Cell[96900, 2426, 10608, 218, 711, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107545, 2649, 159, 2, 47, "Subsection"],
Cell[107707, 2653, 5767, 154, 493, "Input"],
Cell[113477, 2809, 3684, 88, 302, "Input"],
Cell[117164, 2899, 505, 10, 53, "Text"],
Cell[117672, 2911, 9469, 215, 776, "Input",
 CellOpen->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[127190, 3132, 148, 2, 86, "Section"],
Cell[127341, 3136, 391, 10, 53, "Text"],
Cell[CellGroupData[{
Cell[127757, 3150, 132, 2, 47, "Subsection"],
Cell[127892, 3154, 6714, 180, 448, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134643, 3339, 167, 2, 47, "Subsection"],
Cell[134813, 3343, 18946, 436, 1133, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153796, 3784, 128, 2, 47, "Subsection"],
Cell[153927, 3788, 5189, 140, 273, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159153, 3933, 136, 2, 47, "Subsection"],
Cell[159292, 3937, 8139, 199, 593, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167468, 4141, 208, 2, 47, "Subsection"],
Cell[167679, 4145, 18812, 396, 1119, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186528, 4546, 153, 2, 47, "Subsection"],
Cell[186684, 4550, 13815, 332, 948, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[200536, 4887, 163, 2, 47, "Subsection"],
Cell[200702, 4891, 13309, 318, 977, "Input"],
Cell[214014, 5211, 5088, 123, 333, "Input"],
Cell[219105, 5336, 19649, 507, 1483, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[238791, 5848, 168, 2, 47, "Subsection"],
Cell[238962, 5852, 125, 2, 32, "Input"],
Cell[239090, 5856, 6686, 180, 493, "Input"],
Cell[245779, 6038, 1953, 42, 133, "Input"],
Cell[247735, 6082, 1892, 43, 133, "Input"],
Cell[249630, 6127, 2218, 58, 173, "Input"],
Cell[251851, 6187, 2246, 59, 173, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[254134, 6251, 206, 2, 47, "Subsection"],
Cell[254343, 6255, 6091, 136, 493, "Input"],
Cell[260437, 6393, 12676, 320, 1169, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273150, 6718, 221, 3, 47, "Subsection"],
Cell[273374, 6723, 2307, 64, 153, "Input"],
Cell[275684, 6789, 3645, 95, 335, "Input"],
Cell[279332, 6886, 2024, 42, 32, "Input"],
Cell[281359, 6930, 4289, 81, 113, "Input"],
Cell[285651, 7013, 447, 8, 32, "Input"],
Cell[286101, 7023, 784, 24, 53, "Input"],
Cell[286888, 7049, 816, 17, 32, "Input"],
Cell[287707, 7068, 677, 14, 32, "Input"],
Cell[288387, 7084, 692, 14, 35, "Input"],
Cell[289082, 7100, 950, 19, 53, "Input"],
Cell[290035, 7121, 896, 22, 58, "Input"],
Cell[290934, 7145, 949, 22, 58, "Input"],
Cell[291886, 7169, 1678, 43, 93, "Input"],
Cell[293567, 7214, 1199, 32, 53, "Input"],
Cell[294769, 7248, 311, 6, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[295117, 7259, 211, 2, 47, "Subsection"],
Cell[295331, 7263, 126, 2, 32, "Input"],
Cell[295460, 7267, 3836, 93, 303, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[299345, 7366, 199, 3, 86, "Section"],
Cell[299547, 7371, 146, 3, 32, "Input"],
Cell[299696, 7376, 2771, 73, 233, "Input"],
Cell[302470, 7451, 1352, 39, 113, "Input"],
Cell[303825, 7492, 2246, 60, 193, "Input"],
Cell[306074, 7554, 907, 24, 113, "Input"],
Cell[306984, 7580, 643, 18, 32, "Input"],
Cell[307630, 7600, 596, 17, 53, "Input"],
Cell[308229, 7619, 2062, 66, 253, "Input"],
Cell[310294, 7687, 656, 20, 53, "Input"],
Cell[310953, 7709, 994, 29, 73, "Input"],
Cell[311950, 7740, 2140, 59, 173, "Input"],
Cell[314093, 7801, 1592, 42, 193, "Input"],
Cell[315688, 7845, 147, 3, 32, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
